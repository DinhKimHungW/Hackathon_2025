import{r as E}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as j,t as N}from"./vendor-BM98ZQOm.js";import{c as $}from"./vendor-utils-BBFcn-gs.js";import{An as I,dr as O,lt as R,on as w,qt as H,ri as D,vi as L,vn as P,xn as M}from"./vendor-mui-B1q6pdKu.js";import{V as q,nt as p,q as z,t as T}from"./index-Bv4sL6jZ.js";var c=E(L()),U={PLANNED:{color:"#1976d2",bgColor:"#e3f2fd",label:"Planned",icon:(0,c.jsx)(R,{fontSize:"small"}),description:"Ship visit is scheduled and planned"},ARRIVED:{color:"#2e7d32",bgColor:"#e8f5e9",label:"Arrived",icon:(0,c.jsx)(P,{fontSize:"small"}),description:"Ship has arrived at port"},IN_PROGRESS:{color:"#ed6c02",bgColor:"#fff4e5",label:"In Progress",icon:(0,c.jsx)(I,{fontSize:"small"}),description:"Ship visit operations are ongoing"},COMPLETED:{color:"#9c27b0",bgColor:"#f3e5f5",label:"Completed",icon:(0,c.jsx)(w,{fontSize:"small"}),description:"All operations completed, ready to depart"},DEPARTED:{color:"#607d8b",bgColor:"#eceff1",label:"Departed",icon:(0,c.jsx)(H,{fontSize:"small"}),description:"Ship has departed from port"},CANCELLED:{color:"#d32f2f",bgColor:"#ffebee",label:"Cancelled",icon:(0,c.jsx)(M,{fontSize:"small"}),description:"Ship visit has been cancelled"}};function G({status:h,size:r="medium",showIcon:l=!0}){const i=U[h];return i?(0,c.jsx)(O,{title:i.description,arrow:!0,children:(0,c.jsx)(D,{icon:l?i.icon:void 0,label:i.label,size:r,sx:{bgcolor:i.bgColor,color:i.color,fontWeight:600,borderRadius:"16px","& .MuiChip-icon":{color:i.color},"&:hover":{bgcolor:i.color,color:"#fff","& .MuiChip-icon":{color:"#fff"}},transition:"all 0.3s ease"}})}):(0,c.jsx)(D,{label:"Unknown",size:r,sx:{bgcolor:"#f5f5f5",color:"#9e9e9e",fontWeight:500}})}var n=E(j()),_="http://localhost:3000",x="/ws";const J=(h={})=>{const{enabled:r=!0,onConnect:l,onDisconnect:i,onError:S}=h,t=T(),{enqueueSnackbar:o}=$(),a=(0,n.useRef)(null),[A,d]=(0,n.useState)(!1),g=(0,n.useCallback)(e=>{console.log("Ship visit created:",e),t(q(e)),o(`New ship visit: ${e.shipName}`,{variant:"info",autoHideDuration:3e3})},[t,o]),v=(0,n.useCallback)(e=>{console.log("Ship visit updated:",e),t(p(e)),o(`Ship visit updated: ${e.shipName}`,{variant:"success",autoHideDuration:3e3})},[t,o]),C=(0,n.useCallback)(e=>{console.log("Ship visit status changed:",e),t(p(e)),o(`${e.shipName} status: ${e.status}`,{variant:"warning",autoHideDuration:4e3})},[t,o]),m=(0,n.useCallback)(e=>{console.log("Ship visit arrival:",e),t(p(e)),o(`${e.shipName} has arrived!`,{variant:"success",autoHideDuration:5e3})},[t,o]),b=(0,n.useCallback)(e=>{console.log("Ship visit departure:",e),t(p(e)),o(`${e.shipName} has departed`,{variant:"info",autoHideDuration:5e3})},[t,o]),k=(0,n.useCallback)(e=>{console.log("Ship visit deleted:",e),t(z(e.id)),o("Ship visit deleted",{variant:"error",autoHideDuration:3e3})},[t,o]),f=(0,n.useCallback)(()=>{if(!r||a.current?.connected)return;console.log(`Connecting to Socket.IO namespace: ${_}${x}`);const e=N(`${_}${x}`,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:3e3,reconnectionAttempts:5});a.current=e,e.on("connect",()=>{console.log("Socket.IO connected:",e.id),d(!0),l?.(),o("Live updates connected",{variant:"success",autoHideDuration:2e3})}),e.on("disconnect",s=>{console.log("Socket.IO disconnected:",s),d(!1),i?.(),o("Live updates disconnected",{variant:"warning",autoHideDuration:3e3})}),e.on("connect_error",s=>{console.error("Socket.IO connection error:",s),d(!1),S?.(s)}),e.on("ship-visit:created",g),e.on("ship-visit:updated",v),e.on("ship-visit:status-changed",C),e.on("ship-visit:arrival",m),e.on("ship-visit:departure",b),e.on("ship-visit:deleted",k),e.on("connection",s=>{console.log("Connection message:",s)})},[r,l,i,S,g,v,C,m,b,k,o]),u=(0,n.useCallback)(()=>{a.current&&(console.log("Disconnecting Socket.IO..."),a.current.disconnect(),a.current=null,d(!1))},[]),V=(0,n.useCallback)((e,s)=>{a.current?.connected?(a.current.emit(e,s),console.log(`Sent message: ${e}`,s)):console.warn("Socket.IO not connected, cannot send message")},[]);return(0,n.useEffect)(()=>(r?f():u(),()=>{u()}),[r,f,u]),{isConnected:A,sendMessage:V,disconnect:u,reconnect:f}};export{G as n,J as t};
