import{r as De}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as Ge}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import{c as He}from"./vendor-react-BH1SDbH3.js";import{n as ue}from"./vendor-utils-BBFcn-gs.js";import{$ as Ue,$n as Ke,$r as a,Ar as _e,Bn as je,Br as Ye,Cr as Y,Dr as Qe,Fr as se,Gn as G,Gr as Je,Gt as qe,Hr as Ae,Ht as ge,In as ne,Ir as ke,Jr as Xe,K as Ze,Kn as de,Kr as M,Kt as oe,Mt as Ve,Nt as et,Pr as ae,Q as tt,Qn as st,Qt as at,Rr as L,S as le,Sr as $,T as lt,Tr as rt,Tt as nt,U as xe,Ur as Ie,Vr as Ee,Wn as Te,Xt as ot,Yn as fe,Yr as me,Yt as q,Zr as C,ai as r,b as it,br as T,cr as ct,d as dt,di as xt,dr as R,ei as ht,en as ut,er as S,et as jt,f as O,fi as H,ft as gt,gn as X,gr as we,hn as ft,hr as Q,in as he,jr as Z,kr as ie,li as mt,ln as ce,lt as ze,nr as pt,oi as bt,ot as vt,qr as pe,ri as k,si as E,sn as V,st as Re,t as yt,ti as St,tr as Ct,u as be,ui as Dt,ut as _t,v as At,vi as kt,vn as ve,wr as It,x as re,xr as Et,y as Tt,yr as wt,zn as zt,zr as Le}from"./vendor-mui-B1q6pdKu.js";import{$ as J,J as Rt,K as ye,Q as Lt,X as Pt,Y as Nt,Z as Mt,et as Wt,n as B,t as Bt,vt as Ot}from"./index-Bv4sL6jZ.js";import{n as Pe,t as z}from"./colors-l-OMOX4h.js";import{n as Ft,t as $t}from"./useShipVisitSocket-DLfco5aI.js";var v=De(Ge()),e=De(kt());function Gt({shipVisit:t,onView:o,onEdit:j,loading:g=!1,selected:d=!1,onSelect:f,selectionMode:n=!1}){return g?(0,e.jsx)(me,{sx:{height:"100%"},children:(0,e.jsxs)(pe,{children:[(0,e.jsx)(Q,{variant:"text",width:"60%",height:32}),(0,e.jsx)(Q,{variant:"text",width:"40%",height:24,sx:{mt:1}}),(0,e.jsx)(Q,{variant:"rectangular",height:60,sx:{mt:2}}),(0,e.jsx)(Q,{variant:"text",width:"80%",height:20,sx:{mt:2}})]})}):(0,e.jsxs)(me,{sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative",transition:"all 0.3s ease",border:d?2:0,borderColor:d?"primary.main":"transparent","&:hover":{transform:"translateY(-4px)",boxShadow:6},cursor:"pointer"},onClick:()=>o(t.id),children:[n&&f&&(0,e.jsx)(a,{sx:{position:"absolute",top:8,left:8,zIndex:2},onClick:x=>{x.stopPropagation(),f()},children:(0,e.jsx)(M,{checked:d})}),(0,e.jsx)(a,{sx:{position:"absolute",top:16,right:16,opacity:.1,fontSize:80,color:"#1976d2"},children:(0,e.jsx)(V,{sx:{fontSize:80}})}),(0,e.jsxs)(pe,{sx:{flexGrow:1,position:"relative",zIndex:1},children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[(0,e.jsxs)(a,{sx:{flex:1},children:[(0,e.jsx)(r,{variant:"h6",component:"h3",gutterBottom:!0,fontWeight:600,children:t.shipName}),(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",children:["IMO: ",t.imoNumber]})]}),(0,e.jsx)(Ft,{status:t.status,size:"small"})]}),(0,e.jsx)(L,{sx:{my:1.5}}),(0,e.jsxs)(a,{sx:{display:"flex",flexDirection:"column",gap:1,mb:2},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(et,{sx:{fontSize:18,color:"text.secondary"}}),(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",children:[t.vesselType," | ",t.flag]})]}),t.berthName&&(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(Ve,{sx:{fontSize:18,color:"text.secondary"}}),(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",children:["Berth: ",t.berthName]})]}),(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(ze,{sx:{fontSize:18,color:"text.secondary"}}),(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",children:["ETA: ",O(new Date(t.eta),"MMM dd, HH:mm")]})]}),(0,e.jsx)(a,{sx:{display:"flex",alignItems:"center",gap:1,ml:3},children:(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",children:["ETD: ",O(new Date(t.etd),"MMM dd, HH:mm")]})})]}),t.cargoType&&(0,e.jsx)(a,{sx:{bgcolor:"action.hover",p:1,borderRadius:1,mt:2},children:(0,e.jsxs)(r,{variant:"body2",fontWeight:500,children:["Cargo: ",t.cargoType,t.cargoQuantity&&t.cargoUnit&&(0,e.jsxs)(r,{component:"span",variant:"body2",color:"text.secondary",sx:{ml:1},children:["(",t.cargoQuantity," ",t.cargoUnit,")"]})]})}),(0,e.jsxs)(r,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:["Purpose: ",t.visitPurpose]})]}),(0,e.jsxs)(Xe,{sx:{justifyContent:"flex-end",px:2,pb:2,borderTop:"1px solid",borderColor:"divider"},onClick:x=>x.stopPropagation(),children:[(0,e.jsx)(R,{title:"View Details",children:(0,e.jsx)(E,{size:"small",color:"primary",onClick:()=>o(t.id),children:(0,e.jsx)(xe,{fontSize:"small"})})}),(0,e.jsx)(R,{title:"Edit",children:(0,e.jsx)(E,{size:"small",color:"secondary",onClick:()=>j(t.id),children:(0,e.jsx)(he,{fontSize:"small"})})})]})]})}function Ht({shipVisit:t,onView:o,onEdit:j,selected:g=!1,onSelect:d,selectionMode:f=!1}){const n=(0,v.useMemo)(()=>Pe[t.status]||z.gray[500],[t.status]),x=(0,v.useMemo)(()=>{switch(t.status){case"PLANNED":case"SCHEDULED":return 10;case"ARRIVED":return 30;case"BERTHING":case"IN_PROGRESS":return 50;case"LOADING":case"UNLOADING":return 70;case"COMPLETED":case"DEPARTED":return 100;case"CANCELLED":return 0;default:return 0}},[t.status]),c=(0,v.useCallback)(()=>{o(t.id)},[o,t.id]),l=(0,v.useCallback)(()=>{j(t.id)},[j,t.id]),m=(0,v.useCallback)(u=>{u.stopPropagation(),d?.()},[d]);return(0,e.jsx)(H,{elevation:0,sx:{p:2.5,mb:2,border:g?2:1,borderColor:g?"primary.main":"divider",borderRadius:2,transition:"all 0.3s ease","&:hover":{borderColor:n,boxShadow:2,transform:"translateX(4px)"}},children:(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[f&&d&&(0,e.jsx)(M,{checked:g,onChange:d,onClick:m}),(0,e.jsx)(St,{sx:{width:56,height:56,bgcolor:`${n}20`,color:n},children:(0,e.jsx)(V,{fontSize:"large"})}),(0,e.jsxs)(a,{sx:{flex:1,minWidth:0},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1.5,mb:1},children:[(0,e.jsx)(r,{variant:"h6",fontWeight:600,noWrap:!0,children:t.shipName}),(0,e.jsx)(k,{label:t.status,size:"small",sx:{bgcolor:`${n}20`,color:n,fontWeight:600,borderRadius:1}}),(0,e.jsx)(k,{label:t.shipType??t.vesselType,size:"small",variant:"outlined",sx:{borderRadius:1}})]}),(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:3,mb:1.5},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(ne,{fontSize:"small",color:"action"}),(0,e.jsx)(r,{variant:"body2",color:"text.secondary",children:t.berth??t.berthName??"No berth assigned"})]}),(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(ze,{fontSize:"small",color:"action"}),(0,e.jsx)(r,{variant:"body2",color:"text.secondary",children:t.eta?O(new Date(t.eta),"MMM dd, HH:mm"):"No ETA"})]}),t.etd&&(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",children:["→ ",O(new Date(t.etd),"MMM dd, HH:mm")]})]}),(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[(0,e.jsx)(ie,{variant:"determinate",value:x,sx:{flex:1,height:6,borderRadius:3,bgcolor:`${n}20`,"& .MuiLinearProgress-bar":{bgcolor:n,borderRadius:3}}}),(0,e.jsxs)(r,{variant:"caption",color:"text.secondary",fontWeight:600,children:[x,"%"]})]})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:1},children:[(0,e.jsx)(R,{title:"View Details",arrow:!0,children:(0,e.jsx)(E,{size:"small",onClick:c,sx:{bgcolor:`${z.ocean[500]}20`,"&:hover":{bgcolor:z.ocean[500],color:"white"}},children:(0,e.jsx)(xe,{fontSize:"small"})})}),(0,e.jsx)(R,{title:"Edit",arrow:!0,children:(0,e.jsx)(E,{size:"small",onClick:l,sx:{bgcolor:`${z.sunset[500]}20`,"&:hover":{bgcolor:z.sunset[500],color:"white"}},children:(0,e.jsx)(he,{fontSize:"small"})})})]})]})})}var Ut=(0,v.memo)(Ht);function Kt({shipVisits:t,onView:o,onEdit:j,loading:g,selectedIds:d=[],onToggleSelection:f,selectionMode:n=!1}){const x=c=>{switch(c){case"PLANNED":case"SCHEDULED":return 10;case"ARRIVED":return 30;case"BERTHING":case"IN_PROGRESS":return 50;case"LOADING":case"UNLOADING":return 70;case"COMPLETED":case"DEPARTED":return 100;case"CANCELLED":return 0;default:return 0}};return g?(0,e.jsxs)(H,{elevation:0,sx:{borderRadius:2,overflow:"hidden"},children:[(0,e.jsx)(ie,{}),(0,e.jsx)(a,{sx:{p:8,textAlign:"center"},children:(0,e.jsx)(r,{variant:"body1",color:"text.secondary",children:"Loading ship visits..."})})]}):(0,e.jsx)(Ke,{component:H,elevation:0,sx:{borderRadius:2,border:"1px solid",borderColor:"divider"},children:(0,e.jsxs)(pt,{children:[(0,e.jsx)(st,{children:(0,e.jsxs)(fe,{sx:{bgcolor:"grey.50"},children:[n&&f&&(0,e.jsx)(S,{padding:"checkbox"}),(0,e.jsx)(S,{width:50}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"Ship Name"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"Type"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"Status"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"Berth"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"ETA"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"ETD"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"Progress"})}),(0,e.jsx)(S,{align:"right",children:(0,e.jsx)(r,{variant:"subtitle2",fontWeight:700,children:"Actions"})})]})}),(0,e.jsx)(Ct,{children:t.map(c=>{const l=Pe[c.status]||z.gray[500],m=x(c.status),u=d.includes(c.id);return(0,e.jsxs)(fe,{hover:!0,selected:u,sx:{"&:hover":{bgcolor:`${l}08`},cursor:"pointer"},onClick:()=>o(c.id),children:[n&&f&&(0,e.jsx)(S,{padding:"checkbox",onClick:p=>p.stopPropagation(),children:(0,e.jsx)(M,{checked:u,onChange:()=>f(c.id)})}),(0,e.jsx)(S,{children:(0,e.jsx)(a,{sx:{width:36,height:36,borderRadius:1.5,bgcolor:`${l}20`,color:l,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(V,{fontSize:"small"})})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"body2",fontWeight:600,children:c.shipName})}),(0,e.jsx)(S,{children:(0,e.jsx)(k,{label:c.shipType??c.vesselType,size:"small",variant:"outlined",sx:{borderRadius:1}})}),(0,e.jsx)(S,{children:(0,e.jsx)(k,{label:c.status,size:"small",sx:{bgcolor:`${l}20`,color:l,fontWeight:600,borderRadius:1}})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"body2",color:"text.secondary",children:c.berth??c.berthName??"-"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"body2",color:"text.secondary",children:c.eta?O(new Date(c.eta),"MMM dd, HH:mm"):"-"})}),(0,e.jsx)(S,{children:(0,e.jsx)(r,{variant:"body2",color:"text.secondary",children:c.etd?O(new Date(c.etd),"MMM dd, HH:mm"):"-"})}),(0,e.jsx)(S,{children:(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(ie,{variant:"determinate",value:m,sx:{width:80,height:6,borderRadius:3,bgcolor:`${l}20`,"& .MuiLinearProgress-bar":{bgcolor:l,borderRadius:3}}}),(0,e.jsxs)(r,{variant:"caption",color:"text.secondary",fontWeight:600,sx:{minWidth:32},children:[m,"%"]})]})}),(0,e.jsx)(S,{align:"right",onClick:p=>p.stopPropagation(),children:(0,e.jsxs)(a,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[(0,e.jsx)(R,{title:"View Details",arrow:!0,children:(0,e.jsx)(E,{size:"small",onClick:p=>{p.stopPropagation(),o(c.id)},sx:{bgcolor:`${z.ocean[500]}20`,"&:hover":{bgcolor:z.ocean[500],color:"white"}},children:(0,e.jsx)(xe,{fontSize:"small"})})}),(0,e.jsx)(R,{title:"Edit",arrow:!0,children:(0,e.jsx)(E,{size:"small",onClick:p=>{p.stopPropagation(),j(c.id)},sx:{bgcolor:`${z.sunset[500]}20`,"&:hover":{bgcolor:z.sunset[500],color:"white"}},children:(0,e.jsx)(he,{fontSize:"small"})})})]})})]},c.id)})})]})})}var Se=[{value:"ALL",label:"All Status",color:"#757575"},{value:"PLANNED",label:"Planned",color:"#1976d2"},{value:"ARRIVED",label:"Arrived",color:"#2e7d32"},{value:"IN_PROGRESS",label:"In Progress",color:"#ed6c02"},{value:"COMPLETED",label:"Completed",color:"#9c27b0"},{value:"DEPARTED",label:"Departed",color:"#607d8b"},{value:"CANCELLED",label:"Cancelled",color:"#d32f2f"}];function Yt({filters:t,onFilterChange:o}){const[j,g]=(0,v.useState)(t.search);(0,v.useEffect)(()=>{const l=setTimeout(()=>{j!==t.search&&o({search:j})},500);return()=>clearTimeout(l)},[j,t.search,o]);const d=l=>{o({status:l})},f=l=>{g(l.target.value)},n=()=>{g(""),o({search:""})},x=()=>{g(""),o({status:"ALL",search:"",dateRange:{start:null,end:null},portId:"ALL"})},c=t.status!=="ALL"||t.search!==""||t.dateRange.start!==null||t.dateRange.end!==null;return(0,e.jsxs)(a,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2,mb:3,p:2,bgcolor:"background.paper",borderRadius:2,boxShadow:1},children:[(0,e.jsxs)(a,{sx:{display:{xs:"none",md:"flex"},alignItems:"center",gap:1,minWidth:120},children:[(0,e.jsx)(q,{color:"action"}),(0,e.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Filters:"})]}),(0,e.jsxs)(ke,{size:"small",sx:{minWidth:180},children:[(0,e.jsx)(_e,{children:"Status"}),(0,e.jsx)(we,{value:t.status,label:"Status",onChange:l=>d(l.target.value),renderValue:l=>{const m=Se.find(u=>u.value===l);return(0,e.jsx)(k,{label:m?.label,size:"small",sx:{bgcolor:m?.color+"20",color:m?.color,fontWeight:600,height:24}})},children:Se.map(l=>(0,e.jsx)(T,{value:l.value,children:(0,e.jsx)(k,{label:l.label,size:"small",sx:{bgcolor:l.color+"20",color:l.color,fontWeight:600}})},l.value))})]}),(0,e.jsx)(de,{size:"small",placeholder:"Search by ship name, IMO, vessel type...",value:j,onChange:f,sx:{flex:1,minWidth:200},InputProps:{startAdornment:(0,e.jsx)(Z,{position:"start",children:(0,e.jsx)(Re,{fontSize:"small"})}),endAdornment:j&&(0,e.jsx)(Z,{position:"end",children:(0,e.jsx)(E,{size:"small",onClick:n,children:(0,e.jsx)(X,{fontSize:"small"})})})}}),c&&(0,e.jsx)(C,{variant:"outlined",size:"small",onClick:x,startIcon:(0,e.jsx)(X,{}),sx:{minWidth:100},children:"Reset"})]})}function Qt({value:t,onChange:o,label:j="Date Range"}){const[g,d]=(0,v.useState)("custom"),f=c=>{const l=c.target.value;d(l);const m=new Date;let u=null,p=null;switch(l){case"today":u=le(m),p=re(m);break;case"thisWeek":u=lt(m,{weekStartsOn:1}),p=At(m,{weekStartsOn:1});break;case"thisMonth":u=Tt(m),p=it(m);break;case"last7Days":u=le(ue(m,7)),p=re(m);break;case"last30Days":u=le(ue(m,30)),p=re(m);break;case"custom":default:u=null,p=null}o({from:u,to:p})},n=c=>{d("custom"),o({from:c,to:t.to})},x=c=>{d("custom"),o({from:t.from,to:c})};return(0,e.jsx)(dt,{dateAdapter:yt,children:(0,e.jsxs)(a,{children:[(0,e.jsxs)(ke,{fullWidth:!0,size:"small",sx:{mb:2},children:[(0,e.jsx)(_e,{children:j}),(0,e.jsxs)(we,{value:g,onChange:f,label:j,children:[(0,e.jsx)(T,{value:"custom",children:"Custom Range"}),(0,e.jsx)(T,{value:"today",children:"Today"}),(0,e.jsx)(T,{value:"thisWeek",children:"This Week"}),(0,e.jsx)(T,{value:"thisMonth",children:"This Month"}),(0,e.jsx)(T,{value:"last7Days",children:"Last 7 Days"}),(0,e.jsx)(T,{value:"last30Days",children:"Last 30 Days"})]})]}),(0,e.jsxs)(a,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2},children:[(0,e.jsx)(be,{label:"From Date",value:t.from,onChange:n,slotProps:{textField:{size:"small",fullWidth:!0}}}),(0,e.jsx)(be,{label:"To Date",value:t.to,onChange:x,minDate:t.from||void 0,slotProps:{textField:{size:"small",fullWidth:!0}}})]})]})})}var Jt=["PLANNED","ARRIVED","IN_PROGRESS","COMPLETED","DEPARTED","CANCELLED"],qt=["CONTAINER","BULK","TANKER","RORO","GENERAL","PASSENGER"],Xt=["B-01","B-02","B-03","B-04","B-05","B-10","B-12","B-15","B-20"];function Zt({filters:t,onFilterChange:o,onOpenPresets:j}){const[g,d]=(0,v.useState)(!0),[f,n]=(0,v.useState)(t.search),[x,c]=(0,v.useState)([]),[l,m]=(0,v.useState)([]),[u,p]=(0,v.useState)([]),[_,D]=(0,v.useState)({from:t.dateRange.start,to:t.dateRange.end}),A=(t.search?1:0)+(t.status!=="ALL"?1:0)+(x.length>0?1:0)+(l.length>0?1:0)+(u.length>0?1:0)+(t.dateRange.start||t.dateRange.end?1:0),W=i=>{const w=i.target.value;n(w),o({search:w})},s=()=>{n(""),o({search:""})},h=i=>{const w=x.includes(i)?x.filter(N=>N!==i):[...x,i];c(w)},y=i=>{const w=l.includes(i)?l.filter(N=>N!==i):[...l,i];m(w)},U=i=>{const w=u.includes(i)?u.filter(N=>N!==i):[...u,i];p(w)},ee=i=>{D(i)},K=()=>{o({dateRange:{start:_.from,end:_.to}})},F=()=>{n(""),c([]),m([]),p([]),D({from:null,to:null}),o({status:"ALL",search:"",dateRange:{start:null,end:null},portId:"ALL"})},P=A>0;return(0,e.jsxs)(xt,{expanded:g,onChange:()=>d(!g),sx:{mb:3,boxShadow:2,"&:before":{display:"none"},borderRadius:2},children:[(0,e.jsx)(mt,{expandIcon:(0,e.jsx)(at,{}),sx:{bgcolor:"background.paper",borderRadius:g?"8px 8px 0 0":2},children:(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1,flex:1},children:[(0,e.jsx)(ht,{badgeContent:A,color:"primary",children:(0,e.jsx)(q,{})}),(0,e.jsx)(r,{variant:"subtitle1",fontWeight:600,children:"Advanced Filters"}),P&&(0,e.jsx)(k,{label:`${A} active`,size:"small",color:"primary",sx:{ml:1}})]})}),(0,e.jsx)(Dt,{sx:{p:3,bgcolor:"background.default"},children:(0,e.jsxs)(ct,{spacing:3,children:[(0,e.jsx)(de,{fullWidth:!0,size:"small",placeholder:"Search by ship name, IMO number, vessel type...",value:f,onChange:W,InputProps:{startAdornment:(0,e.jsx)(Z,{position:"start",children:(0,e.jsx)(Re,{fontSize:"small"})}),endAdornment:f&&(0,e.jsx)(Z,{position:"end",children:(0,e.jsx)(E,{size:"small",onClick:s,children:(0,e.jsx)(X,{fontSize:"small"})})})}}),(0,e.jsx)(L,{}),(0,e.jsxs)(a,{children:[(0,e.jsx)(r,{variant:"subtitle2",gutterBottom:!0,fontWeight:600,children:"ETA/ETD Date Range"}),(0,e.jsx)(Qt,{value:_,onChange:ee,label:"Select Period"})]}),(0,e.jsx)(L,{}),(0,e.jsxs)(a,{children:[(0,e.jsx)(r,{variant:"subtitle2",gutterBottom:!0,fontWeight:600,children:"Status"}),(0,e.jsx)(ae,{row:!0,sx:{gap:1},children:Jt.map(i=>(0,e.jsx)(se,{control:(0,e.jsx)(M,{checked:x.includes(i),onChange:()=>h(i),size:"small"}),label:(0,e.jsx)(r,{variant:"body2",children:i.replace("_"," ")})},i))})]}),(0,e.jsx)(L,{}),(0,e.jsxs)(a,{children:[(0,e.jsx)(r,{variant:"subtitle2",gutterBottom:!0,fontWeight:600,children:"Ship Type"}),(0,e.jsx)(ae,{row:!0,sx:{gap:1},children:qt.map(i=>(0,e.jsx)(se,{control:(0,e.jsx)(M,{checked:l.includes(i),onChange:()=>y(i),size:"small"}),label:(0,e.jsx)(r,{variant:"body2",children:i})},i))})]}),(0,e.jsx)(L,{}),(0,e.jsxs)(a,{children:[(0,e.jsx)(r,{variant:"subtitle2",gutterBottom:!0,fontWeight:600,children:"Berth"}),(0,e.jsx)(ae,{row:!0,sx:{gap:1},children:Xt.map(i=>(0,e.jsx)(se,{control:(0,e.jsx)(M,{checked:u.includes(i),onChange:()=>U(i),size:"small"}),label:(0,e.jsx)(r,{variant:"body2",children:i})},i))})]}),(0,e.jsx)(L,{}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,justifyContent:"space-between"},children:[(0,e.jsxs)(a,{sx:{display:"flex",gap:1},children:[(0,e.jsx)(C,{variant:"contained",onClick:K,startIcon:(0,e.jsx)(q,{}),children:"Apply Filters"}),(0,e.jsx)(C,{variant:"outlined",onClick:F,startIcon:(0,e.jsx)(X,{}),disabled:!P,children:"Clear All"})]}),(0,e.jsx)(C,{variant:"text",startIcon:(0,e.jsx)(_t,{}),size:"small",sx:{opacity:.7},onClick:j,disabled:!j,children:"Save Preset"})]}),P&&(0,e.jsxs)(a,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[(0,e.jsx)(r,{variant:"caption",color:"text.secondary",sx:{width:"100%",mb:.5},children:"Active Filters:"}),t.search&&(0,e.jsx)(k,{label:`Search: "${t.search}"`,size:"small",onDelete:s}),_.from&&(0,e.jsx)(k,{label:`Date: ${_.from.toLocaleDateString()} - ${_.to?.toLocaleDateString()||"Now"}`,size:"small",onDelete:()=>D({from:null,to:null})}),x.map(i=>(0,e.jsx)(k,{label:`Status: ${i}`,size:"small",onDelete:()=>h(i)},i)),l.map(i=>(0,e.jsx)(k,{label:`Type: ${i}`,size:"small",onDelete:()=>y(i)},i)),u.map(i=>(0,e.jsx)(k,{label:`Berth: ${i}`,size:"small",onDelete:()=>U(i)},i))]})]})})]})}function Vt({selectedCount:t,totalCount:o,onSelectAll:j,onDeselectAll:g,onBulkDelete:d,onBulkExport:f,onBulkStatusChange:n,onBulkAssignBerth:x}){const[c,l]=(0,v.useState)(null),m=!!c,u=A=>{l(A.currentTarget)},p=()=>{l(null)},_=A=>{A(),p()};if(t===0)return null;const D=t===o;return(0,e.jsxs)(H,{elevation:3,sx:{position:"sticky",top:80,zIndex:10,mb:2,p:2,display:"flex",alignItems:"center",gap:2,bgcolor:"primary.main",color:"primary.contrastText",borderRadius:2},children:[(0,e.jsx)(M,{checked:D,indeterminate:t>0&&t<o,onChange:D?g:j,sx:{color:"primary.contrastText","&.Mui-checked":{color:"primary.contrastText"},"&.MuiCheckbox-indeterminate":{color:"primary.contrastText"}}}),(0,e.jsxs)(r,{variant:"subtitle1",fontWeight:600,sx:{flex:1},children:[t," ",t===1?"item":"items"," selected"]}),(0,e.jsxs)(a,{sx:{display:{xs:"none",md:"flex"},gap:1},children:[(0,e.jsx)(C,{variant:"contained",color:"inherit",size:"small",startIcon:(0,e.jsx)(oe,{}),onClick:f,sx:{color:"primary.main"},children:"Export"}),n&&(0,e.jsx)(C,{variant:"contained",color:"inherit",size:"small",startIcon:(0,e.jsx)(ve,{}),onClick:n,sx:{color:"primary.main"},children:"Change Status"}),x&&(0,e.jsx)(C,{variant:"contained",color:"inherit",size:"small",startIcon:(0,e.jsx)(ne,{}),onClick:x,sx:{color:"primary.main"},children:"Assign Berth"}),(0,e.jsx)(C,{variant:"contained",color:"error",size:"small",startIcon:(0,e.jsx)(ce,{}),onClick:d,children:"Delete"})]}),(0,e.jsx)(E,{sx:{display:{xs:"block",md:"none"},color:"inherit"},onClick:u,children:(0,e.jsx)(nt,{})}),(0,e.jsxs)(Et,{anchorEl:c,open:m,onClose:p,children:[(0,e.jsxs)(T,{onClick:()=>_(f),children:[(0,e.jsx)(Y,{children:(0,e.jsx)(oe,{fontSize:"small"})}),(0,e.jsx)($,{children:"Export Selected"})]}),n&&(0,e.jsxs)(T,{onClick:()=>_(n),children:[(0,e.jsx)(Y,{children:(0,e.jsx)(ve,{fontSize:"small"})}),(0,e.jsx)($,{children:"Change Status"})]}),x&&(0,e.jsxs)(T,{onClick:()=>_(x),children:[(0,e.jsx)(Y,{children:(0,e.jsx)(ne,{fontSize:"small"})}),(0,e.jsx)($,{children:"Assign Berth"})]}),(0,e.jsx)(L,{}),(0,e.jsxs)(T,{onClick:()=>_(d),children:[(0,e.jsx)(Y,{children:(0,e.jsx)(ce,{fontSize:"small",color:"error"})}),(0,e.jsx)($,{children:"Delete Selected"})]})]}),(0,e.jsx)(E,{onClick:g,sx:{color:"inherit"},title:"Deselect All",children:(0,e.jsx)(ft,{})})]})}var Ce="shipVisit_filterPresets";function es({open:t,onClose:o,currentFilters:j,onApplyPreset:g}){const[d,f]=(0,v.useState)([]),[n,x]=(0,v.useState)(""),[c,l]=(0,v.useState)(!1);(0,v.useEffect)(()=>{t&&m()},[t]);const m=()=>{try{const s=localStorage.getItem(Ce);if(s){const h=JSON.parse(s).map(y=>({...y,createdAt:new Date(y.createdAt),filters:{...y.filters,dateRange:y.filters.dateRange?{start:y.filters.dateRange.start?new Date(y.filters.dateRange.start):null,end:y.filters.dateRange.end?new Date(y.filters.dateRange.end):null}:void 0}}));f(h)}}catch(s){console.error("Failed to load filter presets:",s)}},u=s=>{try{localStorage.setItem(Ce,JSON.stringify(s)),f(s)}catch(h){console.error("Failed to save filter presets:",h)}},p=()=>{if(!n.trim())return;const s={id:`preset_${Date.now()}`,name:n.trim(),filters:j,createdAt:new Date},h=[...d,s];u(h),x(""),l(!1)},_=s=>{const h=d.filter(y=>y.id!==s);u(h)},D=s=>{const h=d.map(y=>({...y,isDefault:y.id===s}));u(h)},A=s=>{g(s),o()},W=s=>{let h=0;return s.search&&h++,(s.dateRange?.start||s.dateRange?.end)&&h++,s.status&&s.status.length>0&&h++,s.shipType&&s.shipType.length>0&&h++,s.berth&&s.berth.length>0&&h++,h};return(0,e.jsxs)(Ie,{open:t,onClose:o,maxWidth:"sm",fullWidth:!0,children:[(0,e.jsx)(Le,{children:"Filter Presets"}),(0,e.jsxs)(Ee,{children:[c?(0,e.jsxs)(a,{sx:{mb:3,display:"flex",gap:1},children:[(0,e.jsx)(de,{autoFocus:!0,fullWidth:!0,size:"small",label:"Preset Name",value:n,onChange:s=>x(s.target.value),onKeyDown:s=>{s.key==="Enter"&&p(),s.key==="Escape"&&l(!1)}}),(0,e.jsx)(C,{onClick:p,disabled:!n.trim(),children:"Save"}),(0,e.jsx)(C,{onClick:()=>l(!1),children:"Cancel"})]}):(0,e.jsx)(a,{sx:{mb:3},children:(0,e.jsx)(C,{variant:"outlined",fullWidth:!0,onClick:()=>l(!0),children:"Save Current Filters as Preset"})}),(0,e.jsx)(L,{sx:{mb:2}}),d.length===0?(0,e.jsx)(r,{color:"text.secondary",align:"center",sx:{py:4},children:"No saved presets yet"}):(0,e.jsx)(Qe,{children:d.map(s=>{const h=W(s.filters);return(0,e.jsxs)(It,{component:"button",sx:{border:1,borderColor:"divider",borderRadius:1,mb:1,"&:hover":{bgcolor:"action.hover"},cursor:"pointer",display:"flex",width:"100%",textAlign:"left"},onClick:()=>A(s),children:[(0,e.jsx)($,{primary:(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(r,{variant:"subtitle2",children:s.name}),s.isDefault&&(0,e.jsx)(k,{label:"Default",size:"small",color:"primary"})]}),secondary:(0,e.jsx)(a,{sx:{mt:.5},children:(0,e.jsxs)(r,{variant:"caption",color:"text.secondary",children:[h," ",h===1?"filter":"filters"," •"," ",s.createdAt.toLocaleDateString()]})})}),(0,e.jsxs)(rt,{children:[(0,e.jsx)(E,{edge:"end",size:"small",onClick:y=>{y.stopPropagation(),D(s.id)},sx:{mr:1},children:s.isDefault?(0,e.jsx)(jt,{color:"warning",fontSize:"small"}):(0,e.jsx)(Ue,{fontSize:"small"})}),(0,e.jsx)(E,{edge:"end",size:"small",onClick:y=>{y.stopPropagation(),_(s.id)},children:(0,e.jsx)(ce,{fontSize:"small"})})]})]},s.id)})})]}),(0,e.jsx)(Ae,{children:(0,e.jsx)(C,{onClick:o,children:"Close"})})]})}function ts({view:t,onChange:o}){const j=(g,d)=>{d!==null&&o(d)};return(0,e.jsxs)(Te,{value:t,exclusive:!0,onChange:j,"aria-label":"view mode",size:"small",sx:{bgcolor:"background.paper","& .MuiToggleButton-root":{px:2,py:.75,border:"1px solid",borderColor:"divider","&.Mui-selected":{bgcolor:"primary.main",color:"primary.contrastText","&:hover":{bgcolor:"primary.dark"}}}},children:[(0,e.jsx)(G,{value:"grid","aria-label":"grid view",children:(0,e.jsx)(R,{title:"Grid View",arrow:!0,children:(0,e.jsx)(qe,{fontSize:"small"})})}),(0,e.jsx)(G,{value:"list","aria-label":"list view",children:(0,e.jsx)(R,{title:"List View",arrow:!0,children:(0,e.jsx)(Ze,{fontSize:"small"})})}),(0,e.jsx)(G,{value:"table","aria-label":"table view",children:(0,e.jsx)(R,{title:"Table View",arrow:!0,children:(0,e.jsx)(tt,{fontSize:"small"})})})]})}var ss={"no-data":ge,"no-results":vt,error:ut,custom:ge},as=({type:t="no-data",icon:o,title:j,description:g,action:d,secondaryAction:f,paper:n=!0,minHeight:x="400px"})=>{const c=o?null:ss[t],l=(0,e.jsxs)(a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:x,p:4,textAlign:"center"},children:[o?(0,e.jsx)(a,{sx:{fontSize:80,color:"text.secondary",mb:2},children:o}):c?(0,e.jsx)(c,{sx:{fontSize:80,color:"text.secondary",mb:2}}):null,(0,e.jsx)(r,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:500},children:j}),g&&(0,e.jsx)(r,{variant:"body1",color:"text.secondary",sx:{mb:3,maxWidth:500},children:g}),(d||f)&&(0,e.jsxs)(a,{sx:{display:"flex",gap:2,mt:1},children:[d&&(0,e.jsx)(C,{variant:"contained",size:"large",startIcon:d.icon||(0,e.jsx)(zt,{}),onClick:d.onClick,children:d.label}),f&&(0,e.jsx)(C,{variant:"outlined",size:"large",onClick:f.onClick,children:f.label})]})]});return n?(0,e.jsx)(H,{elevation:0,sx:{border:1,borderColor:"divider"},children:l}):l},ls=as;function js(){const t=He(),o=Bt(),[j,g]=(0,v.useState)("grid"),[d,f]=(0,v.useState)(!1),[n,x]=(0,v.useState)([]),[c,l]=(0,v.useState)(!1),[m,u]=(0,v.useState)(!1),p=B(Ot),{isConnected:_}=$t({enabled:p}),D=B(Rt),A=B(Mt),W=B(Nt),s=B(Pt),h=B(Lt);(0,v.useEffect)(()=>{p&&o(ye())},[o,p,s,h.page,h.limit]);const y=b=>{o(J(b))},U=(b,I)=>{o(Wt({page:I})),window.scrollTo({top:0,behavior:"smooth"})},ee=()=>{o(ye())},K=()=>{t("/ship-visits/new")},F=b=>{t(`/ship-visits/${b}`)},P=b=>{t(`/ship-visits/${b}/edit`)},i=()=>{console.log("Export functionality coming soon")},w=()=>{x(D.map(b=>b.id))},N=()=>{x([])},te=b=>{x(I=>I.includes(b)?I.filter($e=>$e!==b):[...I,b])},Ne=()=>{u(!0)},Me=()=>{console.log("Deleting:",n),x([]),u(!1)},We=()=>{const b=D.filter(I=>n.includes(I.id));console.log("Exporting:",b)},Be=()=>{console.log("Change status for:",n)},Oe=()=>{console.log("Assign berth for:",n)},Fe=b=>{const I={search:b.filters.search||"",dateRange:b.filters.dateRange||{start:null,end:null}};o(J(I)),l(!1)};return(0,e.jsxs)(Je,{maxWidth:"xl",sx:{py:3},children:[(0,e.jsx)(a,{sx:{mb:4},children:(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[(0,e.jsxs)(a,{sx:{flex:1},children:[(0,e.jsx)(r,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Ship Visits"}),(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,e.jsx)(r,{variant:"body1",color:"text.secondary",children:"Manage all ship arrivals and departures"}),_&&(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5,px:1.5,py:.5,borderRadius:1,bgcolor:"success.lighter",border:"1px solid",borderColor:"success.light"},children:[(0,e.jsx)(a,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"success.main",animation:"pulse 2s infinite","@keyframes pulse":{"0%, 100%":{opacity:1},"50%":{opacity:.5}}}}),(0,e.jsx)(r,{variant:"caption",color:"success.main",fontWeight:600,children:"Live"})]})]})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,e.jsx)(ts,{view:j,onChange:g}),(0,e.jsxs)(Te,{value:d?"advanced":"basic",exclusive:!0,onChange:(b,I)=>{I!==null&&f(I==="advanced")},size:"small",children:[(0,e.jsxs)(G,{value:"basic",children:[(0,e.jsx)(q,{fontSize:"small",sx:{mr:.5}}),"Basic"]}),(0,e.jsxs)(G,{value:"advanced",children:[(0,e.jsx)(ot,{fontSize:"small",sx:{mr:.5}}),"Advanced"]})]}),(0,e.jsx)(C,{variant:"outlined",startIcon:(0,e.jsx)(oe,{}),onClick:i,children:"Export"}),(0,e.jsx)(C,{variant:"outlined",startIcon:(0,e.jsx)(gt,{}),onClick:ee,children:"Refresh"}),(0,e.jsx)(C,{variant:"contained",startIcon:(0,e.jsx)(je,{}),onClick:K,children:"New Ship Visit"})]})]})}),d?(0,e.jsx)(Zt,{filters:s,onFilterChange:y,onOpenPresets:()=>l(!0)}):(0,e.jsx)(Yt,{filters:s,onFilterChange:y}),(0,e.jsx)(Vt,{selectedCount:n.length,totalCount:D.length,onSelectAll:w,onDeselectAll:N,onBulkDelete:Ne,onBulkExport:We,onBulkStatusChange:Be,onBulkAssignBerth:Oe}),W&&(0,e.jsx)(bt,{severity:"error",sx:{mb:3},onClose:()=>o(J({...s})),children:W}),A&&D.length===0?(0,e.jsx)(a,{sx:{textAlign:"center",py:8},children:(0,e.jsx)(r,{variant:"body1",color:"text.secondary",children:"Loading ship visits..."})}):D.length===0?(0,e.jsx)(ls,{type:s.search||s.status!=="ALL"?"no-results":"no-data",icon:(0,e.jsx)(V,{}),title:s.search||s.status!=="ALL"?"No ship visits found":"No ship visits yet",description:s.search||s.status!=="ALL"?"Try adjusting your filters to see more results":"Create your first ship visit to get started managing port operations",action:s.search||s.status!=="ALL"?void 0:{label:"Create Ship Visit",onClick:K,icon:(0,e.jsx)(je,{})},secondaryAction:s.search||s.status!=="ALL"?{label:"Clear Filters",onClick:()=>o(J({search:"",status:"ALL"}))}:void 0}):(0,e.jsxs)(e.Fragment,{children:[j==="grid"&&(0,e.jsx)(a,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:3},children:D.map(b=>(0,e.jsx)(Gt,{shipVisit:b,onView:F,onEdit:P,loading:A,selected:n.includes(b.id),onSelect:()=>te(b.id),selectionMode:n.length>0},b.id))}),j==="list"&&(0,e.jsx)(a,{children:D.map(b=>(0,e.jsx)(Ut,{shipVisit:b,onView:F,onEdit:P,selected:n.includes(b.id),onSelect:()=>te(b.id),selectionMode:n.length>0},b.id))}),j==="table"&&(0,e.jsx)(Kt,{shipVisits:D,onView:F,onEdit:P,loading:A,selectedIds:n,onToggleSelection:te,selectionMode:n.length>0}),h.totalPages>1&&(0,e.jsx)(a,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,e.jsx)(wt,{count:h.totalPages,page:h.page,onChange:U,color:"primary",size:"large",showFirstButton:!0,showLastButton:!0})}),(0,e.jsxs)(r,{variant:"body2",color:"text.secondary",textAlign:"center",sx:{mt:2},children:["Showing ",(h.page-1)*h.limit+1," -"," ",Math.min(h.page*h.limit,h.total)," of"," ",h.total," ship visits"]})]}),(0,e.jsx)(es,{open:c,onClose:()=>l(!1),currentFilters:s,onApplyPreset:Fe}),(0,e.jsxs)(Ie,{open:m,onClose:()=>u(!1),children:[(0,e.jsx)(Le,{children:"Confirm Bulk Delete"}),(0,e.jsx)(Ee,{children:(0,e.jsxs)(Ye,{children:["Are you sure you want to delete ",n.length," ship visit",n.length===1?"":"s","? This action cannot be undone."]})}),(0,e.jsxs)(Ae,{children:[(0,e.jsx)(C,{onClick:()=>u(!1),children:"Cancel"}),(0,e.jsx)(C,{onClick:Me,color:"error",variant:"contained",children:"Delete"})]})]})]})}export{js as default};
