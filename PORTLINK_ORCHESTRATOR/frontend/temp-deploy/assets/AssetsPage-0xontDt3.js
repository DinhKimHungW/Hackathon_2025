import{r as k}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as J}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import{c as Q}from"./vendor-react-BH1SDbH3.js";import"./vendor-utils-BBFcn-gs.js";import{$n as X,$r as w,En as Z,Jn as G,Kr as z,Qn as ee,U as te,V as ne,Xn as ae,Yn as M,Zn as se,ai as m,an as ie,bt as le,ci as re,dr as h,er as u,f as C,fi as ce,in as oe,kr as de,ln as P,mt as ue,nr as xe,ri as D,si as f,tr as he,vi as fe}from"./vendor-mui-B1q6pdKu.js";import{M as je,j as R,n as T,t as me}from"./index-Bv4sL6jZ.js";var p=k(J()),e=k(fe()),pe=[{id:"assetCode",label:"Asset Code",sortable:!0},{id:"name",label:"Name",sortable:!0},{id:"type",label:"Type",sortable:!0},{id:"status",label:"Status",sortable:!0},{id:"location",label:"Location",sortable:!0},{id:"utilizationRate",label:"Utilization",sortable:!0}],ge=a=>{switch(a){case"AVAILABLE":return"success";case"IN_USE":return"primary";case"MAINTENANCE":return"warning";case"OFFLINE":return"default";default:return"default"}},Ae=a=>{switch(a){case"CRANE":return"ðŸ—ï¸";case"TRUCK":return"ðŸš›";case"REACH_STACKER":return"ðŸ‹ï¸";case"FORKLIFT":return"ðŸ´";case"YARD_TRACTOR":return"ðŸšœ";case"OTHER":return"ðŸ”§";default:return"ðŸ“¦"}},be=a=>{if(!a.nextMaintenanceDate)return!1;const c=new Date(a.nextMaintenanceDate),d=new Date;return Math.ceil((c.getTime()-d.getTime())/(1e3*60*60*24))<=7},ye=({numSelected:a,order:c,orderBy:d,rowCount:j,onSelectAllClick:g,onRequestSort:i})=>(0,e.jsx)(ee,{children:(0,e.jsxs)(M,{children:[(0,e.jsx)(u,{padding:"checkbox",children:(0,e.jsx)(z,{color:"primary",indeterminate:a>0&&a<j,checked:j>0&&a===j,onChange:g})}),pe.map(l=>(0,e.jsx)(u,{sortDirection:d===l.id?c:!1,children:l.sortable?(0,e.jsx)(G,{active:d===l.id,direction:d===l.id?c:"asc",onClick:()=>i(l.id),children:l.label}):l.label},l.id)),(0,e.jsx)(u,{children:"Actions"})]})}),ve=({numSelected:a,onDeleteSelected:c,onExport:d})=>(0,e.jsxs)(se,{sx:{pl:{sm:2},pr:{xs:1,sm:1},...a>0&&{bgcolor:"primary.lighter"}},children:[a>0?(0,e.jsxs)(m,{sx:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1",component:"div",children:[a," selected"]}):(0,e.jsx)(m,{sx:{flex:"1 1 100%"},variant:"h6",component:"div",children:"Assets"}),a>0?(0,e.jsx)(h,{title:"Delete",children:(0,e.jsx)(f,{onClick:c,color:"error",children:(0,e.jsx)(P,{})})}):(0,e.jsx)(h,{title:"Export to CSV",children:(0,e.jsx)(f,{onClick:d,children:(0,e.jsx)(ie,{})})})]});const _e=({onEditAsset:a,onViewAsset:c,onMaintenanceAsset:d,onActivateAsset:j,onDeactivateAsset:g})=>{const i=me(),{assets:l,loading:I}=T(t=>t.assets),{isAuthenticated:S}=T(t=>t.auth),[v,L]=(0,p.useState)("asc"),[A,N]=(0,p.useState)("assetCode"),[o,b]=(0,p.useState)([]),[_,E]=(0,p.useState)(0),[y,O]=(0,p.useState)(10);(0,p.useEffect)(()=>{S&&i(je({}))},[i,S]);const V=t=>{L(A===t&&v==="asc"?"desc":"asc"),N(t)},U=t=>{if(t.target.checked){const s=l.map(n=>n.id);b(s);return}b([])},B=t=>{const s=o.indexOf(t);let n=[];s===-1?n=n.concat(o,t):s===0?n=n.concat(o.slice(1)):s===o.length-1?n=n.concat(o.slice(0,-1)):s>0&&(n=n.concat(o.slice(0,s),o.slice(s+1))),b(n)},$=(t,s)=>{E(s)},F=t=>{O(parseInt(t.target.value,10)),E(0)},H=async t=>{window.confirm("Are you sure you want to delete this asset?")&&await i(R(t))},q=async()=>{if(window.confirm(`Are you sure you want to delete ${o.length} assets?`)){for(const t of o)await i(R(t));b([])}},K=()=>{const t=[["Asset Code","Name","Type","Status","Location","Capacity","Utilization Rate","Last Maintenance","Next Maintenance"].join(","),...l.map(r=>[r.assetCode,r.name,r.type,r.status,r.location||"N/A",r.capacity?`${r.capacity} ${r.capacityUnit||""}`:"N/A",r.utilizationRate?`${r.utilizationRate}%`:"N/A",r.lastMaintenanceDate?C(new Date(r.lastMaintenanceDate),"yyyy-MM-dd"):"N/A",r.nextMaintenanceDate?C(new Date(r.nextMaintenanceDate),"yyyy-MM-dd"):"N/A"].join(","))].join(`
`),s=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(s),x=document.createElement("a");x.href=n,x.download=`assets-${C(new Date,"yyyy-MM-dd")}.csv`,x.click()},W=t=>o.indexOf(t)!==-1,Y=[...l].sort((t,s)=>{let n=t[A],x=s[A];return n==null?1:x==null?-1:v==="asc"?n>x?1:-1:n<x?1:-1}).slice(_*y,_*y+y);return I?(0,e.jsx)(w,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:(0,e.jsx)(re,{})}):(0,e.jsxs)(ce,{sx:{width:"100%"},children:[(0,e.jsx)(ve,{numSelected:o.length,onDeleteSelected:q,onExport:K}),(0,e.jsx)(X,{children:(0,e.jsxs)(xe,{children:[(0,e.jsx)(ye,{numSelected:o.length,order:v,orderBy:A,onSelectAllClick:U,rowCount:l.length,onRequestSort:V}),(0,e.jsx)(he,{children:Y.map(t=>{const s=W(t.id),n=be(t);return(0,e.jsxs)(M,{hover:!0,role:"checkbox","aria-checked":s,tabIndex:-1,selected:s,sx:{cursor:"pointer"},children:[(0,e.jsx)(u,{padding:"checkbox",onClick:()=>B(t.id),children:(0,e.jsx)(z,{color:"primary",checked:s})}),(0,e.jsxs)(u,{onClick:()=>c(t),children:[(0,e.jsx)(m,{variant:"body2",sx:{fontWeight:500},children:t.assetCode}),n&&(0,e.jsx)(D,{icon:(0,e.jsx)(ne,{}),label:"Maintenance Due",size:"small",color:"warning",sx:{mt:.5}})]}),(0,e.jsx)(u,{onClick:()=>c(t),children:(0,e.jsxs)(m,{variant:"body2",children:[Ae(t.type)," ",t.name]})}),(0,e.jsx)(u,{children:(0,e.jsx)(D,{label:t.type.replace("_"," "),size:"small",variant:"outlined"})}),(0,e.jsx)(u,{children:(0,e.jsx)(D,{label:t.status,size:"small",color:ge(t.status)})}),(0,e.jsx)(u,{children:(0,e.jsx)(m,{variant:"body2",children:t.location||"-"})}),(0,e.jsx)(u,{children:t.utilizationRate!==null?(0,e.jsxs)(w,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(de,{variant:"determinate",value:t.utilizationRate,sx:{width:60,height:8,borderRadius:1},color:t.utilizationRate>80?"success":t.utilizationRate>50?"primary":"warning"}),(0,e.jsxs)(m,{variant:"caption",children:[t.utilizationRate,"%"]})]}):(0,e.jsx)(m,{variant:"body2",color:"text.secondary",children:"-"})}),(0,e.jsx)(u,{children:(0,e.jsxs)(w,{sx:{display:"flex",gap:.5},children:[(0,e.jsx)(h,{title:"View Details",children:(0,e.jsx)(f,{size:"small",onClick:()=>c(t),children:(0,e.jsx)(te,{fontSize:"small"})})}),(0,e.jsx)(h,{title:"Edit Asset",children:(0,e.jsx)(f,{size:"small",onClick:()=>a(t),children:(0,e.jsx)(oe,{fontSize:"small"})})}),t.status==="AVAILABLE"&&(0,e.jsx)(h,{title:"Set to Maintenance",children:(0,e.jsx)(f,{size:"small",color:"warning",onClick:()=>d(t),children:(0,e.jsx)(Z,{fontSize:"small"})})}),t.status==="OFFLINE"&&(0,e.jsx)(h,{title:"Activate Asset",children:(0,e.jsx)(f,{size:"small",color:"success",onClick:()=>j(t),children:(0,e.jsx)(ue,{fontSize:"small"})})}),(t.status==="AVAILABLE"||t.status==="IN_USE")&&(0,e.jsx)(h,{title:"Deactivate Asset",children:(0,e.jsx)(f,{size:"small",color:"error",onClick:()=>g(t),children:(0,e.jsx)(le,{fontSize:"small"})})}),(0,e.jsx)(h,{title:"Delete Asset",children:(0,e.jsx)(f,{size:"small",color:"error",onClick:()=>H(t.id),children:(0,e.jsx)(P,{fontSize:"small"})})})]})})]},t.id)})})]})}),(0,e.jsx)(ae,{rowsPerPageOptions:[5,10,25,50],component:"div",count:l.length,rowsPerPage:y,page:_,onPageChange:$,onRowsPerPageChange:F})]})};function ke(){Q();const a=i=>{console.log("Edit asset:",i.id)},c=i=>{console.log("View asset:",i.id)},d=i=>{console.log("Maintenance asset:",i.id)},j=i=>{console.log("Activate asset:",i.id)},g=i=>{console.log("Deactivate asset:",i.id)};return(0,e.jsx)(_e,{onEditAsset:a,onViewAsset:c,onMaintenanceAsset:d,onActivateAsset:j,onDeactivateAsset:g})}export{ke as default};
