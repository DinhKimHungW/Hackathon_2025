import{r as T}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as k}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import{c as O,l as L}from"./vendor-react-BH1SDbH3.js";import"./vendor-utils-BBFcn-gs.js";import{$r as s,An as z,Br as R,Fn as g,Hr as $,In as E,Mt as q,Nt as G,Rr as y,Ur as M,Vr as F,Yr as U,Zr as d,a as H,ai as i,c as Q,ci as Y,f as c,fi as Z,i as J,in as K,l as X,ln as ee,lt as te,o as ie,oi as b,on as se,qn as ae,qr as x,qt as I,r as re,ri as ne,rr as h,s as le,si as oe,sn as de,ti as ce,vi as xe,wn as he,xn as me,yt as ue,zr as pe}from"./vendor-mui-B1q6pdKu.js";import{G as fe,H as je,W as ge,n as S,t as ye,vt as be}from"./index-Bv4sL6jZ.js";import{n as A,t as ve}from"./useShipVisitSocket-DLfco5aI.js";var v=T(k()),e=T(xe()),_e={PLANNED:{color:"#1976d2",bgColor:"#e3f2fd",icon:(0,e.jsx)(te,{}),label:"Planned"},ARRIVED:{color:"#2e7d32",bgColor:"#e8f5e9",icon:(0,e.jsx)(E,{}),label:"Arrived"},IN_PROGRESS:{color:"#ed6c02",bgColor:"#fff4e5",icon:(0,e.jsx)(z,{}),label:"In Progress"},COMPLETED:{color:"#9c27b0",bgColor:"#f3e5f5",icon:(0,e.jsx)(se,{}),label:"Completed"},DEPARTED:{color:"#607d8b",bgColor:"#eceff1",icon:(0,e.jsx)(I,{}),label:"Departed"},CANCELLED:{color:"#d32f2f",bgColor:"#ffebee",icon:(0,e.jsx)(me,{}),label:"Cancelled"}},Ce=({events:l})=>{if(!l||l.length===0)return(0,e.jsx)(s,{sx:{p:3,textAlign:"center"},children:(0,e.jsx)(i,{variant:"body1",color:"text.secondary",children:"No timeline events to display"})});const o=[...l].sort((a,r)=>new Date(r.timestamp).getTime()-new Date(a.timestamp).getTime());return(0,e.jsx)(X,{position:"right",children:o.map((a,r)=>{const n=_e[a.status],u=r===o.length-1;return(0,e.jsxs)(J,{children:[(0,e.jsx)(H,{sx:{flex:.3,py:2,px:2},children:(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:c(new Date(a.timestamp),"PPp")})}),(0,e.jsxs)(re,{children:[(0,e.jsx)(ie,{sx:{bgcolor:a.isSystemEvent?"#9e9e9e":n.color,boxShadow:a.isSystemEvent?"none":`0 0 0 4px ${n.bgColor}`,p:1.5},children:n.icon}),!u&&(0,e.jsx)(Q,{})]}),(0,e.jsx)(le,{sx:{py:2,px:2},children:(0,e.jsxs)(Z,{elevation:1,sx:{p:2,borderLeft:`4px solid ${n.color}`,bgcolor:a.isSystemEvent?"#fafafa":"background.paper"},children:[(0,e.jsx)(s,{sx:{mb:1},children:(0,e.jsx)(ne,{label:n.label,size:"small",sx:{bgcolor:n.bgColor,color:n.color,fontWeight:"medium"}})}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",gutterBottom:!0,children:a.description}),!a.isSystemEvent&&a.user&&(0,e.jsxs)(s,{sx:{display:"flex",alignItems:"center",gap:1,mt:1.5},children:[(0,e.jsx)(ce,{sx:{width:24,height:24,bgcolor:n.color,fontSize:"0.875rem"},children:a.user.avatar?(0,e.jsx)("img",{src:a.user.avatar,alt:a.user.name,style:{width:"100%",height:"100%"}}):(0,e.jsx)(ue,{fontSize:"small"})}),(0,e.jsxs)(i,{variant:"caption",color:"text.secondary",children:["Updated by ",a.user.name]})]}),a.isSystemEvent&&(0,e.jsx)(i,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1,fontStyle:"italic"},children:"Automatic system event"})]})})]},a.id)})})},De=Ce;function m(l){const{children:o,value:a,index:r,...n}=l;return(0,e.jsx)("div",{role:"tabpanel",hidden:a!==r,id:`ship-visit-tabpanel-${r}`,"aria-labelledby":`ship-visit-tab-${r}`,...n,children:a===r&&(0,e.jsx)(s,{sx:{py:3},children:o})})}var Se=()=>{const{id:l}=L(),o=O(),a=ye(),[r,n]=(0,v.useState)(0),[u,p]=(0,v.useState)(!1),f=S(be),{currentShipVisit:t,loading:N,error:_}=S(D=>D.shipVisits);ve({enabled:f}),(0,v.useEffect)(()=>(l&&f&&a(fe(l)),()=>{a(je())}),[a,l,f]);const P=(D,W)=>{n(W)},w=()=>{t&&o(`/ship-visits/${t.id}/edit`)},V=()=>{p(!0)},B=async()=>{t&&(await a(ge(t.id)),p(!1),o("/ship-visits"))},C=()=>{p(!1)},j=()=>{o("/ship-visits")};return N?(0,e.jsx)(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:(0,e.jsx)(Y,{})}):_?(0,e.jsxs)(s,{sx:{p:3},children:[(0,e.jsx)(b,{severity:"error",sx:{mb:2},children:_}),(0,e.jsx)(d,{variant:"contained",startIcon:(0,e.jsx)(g,{}),onClick:j,children:"Back to Ship Visits"})]}):t?(0,e.jsxs)(s,{sx:{p:3},children:[(0,e.jsxs)(s,{sx:{mb:3,display:"flex",alignItems:"center",gap:2},children:[(0,e.jsx)(oe,{onClick:j,sx:{mr:1},children:(0,e.jsx)(g,{})}),(0,e.jsxs)(s,{sx:{flexGrow:1},children:[(0,e.jsx)(i,{variant:"h4",gutterBottom:!0,children:t.shipName}),(0,e.jsxs)(i,{variant:"body2",color:"text.secondary",children:["IMO: ",t.imoNumber]})]}),(0,e.jsx)(A,{status:t.status,size:"medium",showIcon:!0}),(0,e.jsx)(d,{variant:"outlined",startIcon:(0,e.jsx)(K,{}),onClick:w,sx:{mr:1},children:"Edit"}),(0,e.jsx)(d,{variant:"outlined",color:"error",startIcon:(0,e.jsx)(ee,{}),onClick:V,children:"Delete"})]}),(0,e.jsxs)(U,{children:[(0,e.jsx)(s,{sx:{borderBottom:1,borderColor:"divider"},children:(0,e.jsxs)(ae,{value:r,onChange:P,"aria-label":"ship visit tabs",children:[(0,e.jsx)(h,{label:"Overview",id:"ship-visit-tab-0"}),(0,e.jsx)(h,{label:"Timeline",id:"ship-visit-tab-1"}),(0,e.jsx)(h,{label:"Cargo",id:"ship-visit-tab-2"}),(0,e.jsx)(h,{label:"Documents",id:"ship-visit-tab-3"})]})}),(0,e.jsx)(m,{value:r,index:0,children:(0,e.jsxs)(x,{children:[(0,e.jsxs)(i,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(de,{}),"Ship Information"]}),(0,e.jsx)(y,{sx:{mb:2}}),(0,e.jsxs)(s,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},gap:2},children:[(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Ship Name"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.shipName})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"IMO Number"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.imoNumber})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Vessel Type"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.vesselType||"N/A"})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Flag"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.flag||"N/A"})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Gross Tonnage"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.grossTonnage?.toLocaleString()||"N/A"})]})]}),(0,e.jsxs)(i,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mt:4},children:[(0,e.jsx)(he,{}),"Visit Details"]}),(0,e.jsx)(y,{sx:{mb:2}}),(0,e.jsxs)(s,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},gap:2},children:[(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Purpose"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.visitPurpose||"N/A"})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Berth"}),(0,e.jsxs)(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(q,{fontSize:"small",color:"action"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.berthName||"Not Assigned"})]})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Status"}),(0,e.jsx)(s,{sx:{mt:.5},children:(0,e.jsx)(A,{status:t.status,size:"small",showIcon:!0})})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"ETA (Estimated Time of Arrival)"}),(0,e.jsxs)(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(E,{fontSize:"small",color:"action"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.eta?c(new Date(t.eta),"PPp"):"N/A"})]})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"ETD (Estimated Time of Departure)"}),(0,e.jsxs)(s,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(I,{fontSize:"small",color:"action"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.etd?c(new Date(t.etd),"PPp"):"N/A"})]})]}),t.actualArrival&&(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Actual Arrival Time"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",color:"success.main",children:c(new Date(t.actualArrival),"PPp")})]}),t.actualDeparture&&(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Actual Departure Time"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",color:"info.main",children:c(new Date(t.actualDeparture),"PPp")})]})]})]})}),(0,e.jsx)(m,{value:r,index:1,children:(0,e.jsx)(x,{children:(0,e.jsx)(De,{events:[{id:"1",timestamp:t.createdAt,status:"PLANNED",description:"Ship visit created",isSystemEvent:!0},...t.actualArrival?[{id:"2",timestamp:t.actualArrival,status:"ARRIVED",description:"Ship arrived at berth",isSystemEvent:!1,user:{id:t.createdBy||"system",name:"Port Officer"}}]:[],...t.actualDeparture?[{id:"3",timestamp:t.actualDeparture,status:"DEPARTED",description:"Ship departed from berth",isSystemEvent:!1,user:{id:t.createdBy||"system",name:"Port Officer"}}]:[]],shipVisitId:t.id})})}),(0,e.jsx)(m,{value:r,index:2,children:(0,e.jsxs)(x,{children:[(0,e.jsxs)(i,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(G,{}),"Cargo Information"]}),(0,e.jsx)(y,{sx:{mb:2}}),(0,e.jsxs)(s,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)"},gap:2},children:[(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Cargo Type"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.cargoType||"N/A"})]}),(0,e.jsxs)(s,{children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Quantity"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.cargoQuantity?`${t.cargoQuantity.toLocaleString()} ${t.cargoUnit||""}`:"N/A"})]}),t.specialNotes&&(0,e.jsxs)(s,{sx:{gridColumn:{xs:"1",sm:"1 / -1"}},children:[(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Special Notes"}),(0,e.jsx)(i,{variant:"body1",fontWeight:"medium",children:t.specialNotes})]})]})]})}),(0,e.jsx)(m,{value:r,index:3,children:(0,e.jsx)(x,{children:(0,e.jsx)(b,{severity:"info",children:"Document upload feature will be implemented in future phases"})})})]}),(0,e.jsxs)(M,{open:u,onClose:C,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[(0,e.jsx)(pe,{id:"delete-dialog-title",children:"Delete Ship Visit"}),(0,e.jsx)(F,{children:(0,e.jsxs)(R,{id:"delete-dialog-description",children:["Are you sure you want to delete the ship visit for"," ",(0,e.jsx)("strong",{children:t?.shipName}),"? This action cannot be undone."]})}),(0,e.jsxs)($,{children:[(0,e.jsx)(d,{onClick:C,children:"Cancel"}),(0,e.jsx)(d,{onClick:B,color:"error",variant:"contained",children:"Delete"})]})]})]}):(0,e.jsxs)(s,{sx:{p:3},children:[(0,e.jsx)(b,{severity:"warning",sx:{mb:2},children:"Ship visit not found"}),(0,e.jsx)(d,{variant:"contained",startIcon:(0,e.jsx)(g,{}),onClick:j,children:"Back to Ship Visits"})]})},Be=Se;export{Be as default};
