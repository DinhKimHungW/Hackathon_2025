import{r as mt}from"./rolldown-runtime-CjiBMUN4.js";import{C as jt,Cn as Ht,D as Wt,E as pt,O as Ze,S as qe,a as Gt,c as $t,f as ye,i as Bt,l as Ft,m as ft,n as Ut,o as qt,p as gt,s as Kt,u as Qt,w as Yt,x as Zt}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import{a as Xt,i as Jt,o as yt,t as le}from"./vendor-utils-BBFcn-gs.js";import{$n as bt,$r as a,Bn as Xe,Cn as wt,Cr as re,D as es,Dr as Ee,F as vt,Fr as se,G as St,Gn as X,Gr as ts,Hn as ke,Hr as ss,In as be,Ir as ns,J as as,K as Ke,Kn as Ct,Kr as Q,Ln as Je,Lr as rs,Lt as et,Mn as We,Mr as G,Mt as is,N as Dt,Nn as tt,Nt as Tt,Ot as ls,P as Et,Pr as Oe,Qn as Ge,Qt as je,R as os,Rr as ne,Rt as cs,S as ds,Sn as Nt,Sr as Y,T as Pt,Un as Se,Ur as xs,V as Rt,Vn as It,Vr as hs,W as st,Wn as Me,Xr as us,Y as ms,Yn as ce,Yr as H,Yt as Ce,Z as $e,Zr as oe,Zt as js,ai as t,an as ps,br as fs,cr as N,di as pe,dr as L,dt as nt,ei as gs,er as D,f as A,fi as xe,fn as Ve,fr as ys,ft as Ae,gn as bs,gr as ws,hi as Re,hn as kt,ht as vs,in as At,jr as Ss,kr as Ne,li as fe,ln as Qe,lr as Cs,lt as ve,mr as Ds,mt as Pe,nn as Ts,nr as Be,oi as He,pi as Lt,q as at,qn as _t,qr as W,ri as y,rr as we,si as z,sn as ie,st as Mt,ti as Es,tr as Fe,u as rt,ui as ge,un as it,ur as Ns,v as zt,vi as Ps,vn as de,wn as Ot,wr as Z,x as Rs,xn as Ye,yt as lt,zr as Is,zt as Ue}from"./vendor-mui-B1q6pdKu.js";import{B as ks,F as As,I as Ls,L as ot,R as ct,bt as _s,n as dt,t as Ms,z as Le}from"./index-Bv4sL6jZ.js";var T=mt(Ht()),xt={ADMIN:{role:"ADMIN",viewPermissions:{canViewAll:!0,canViewOwn:!0,canFilter:!0,canExport:!0,canEdit:!0,canDelete:!0,canCreate:!0},defaultView:{mode:"timeline",timelineMode:"week",groupBy:"resource",displayMode:"timeline"},availableFilters:{byStatus:!0,byType:!0,byDate:!0,byResource:!0,byLocation:!0},visibleFields:["name","type","status","startTime","endTime","resources","assignedTo","progress","priority","location","notes"],customActions:["export","bulkEdit","analytics","optimize"]},MANAGER:{role:"MANAGER",viewPermissions:{canViewAll:!0,canViewOwn:!0,canFilter:!0,canExport:!0,canEdit:!0,canDelete:!1,canCreate:!0},defaultView:{mode:"timeline",timelineMode:"week",groupBy:"type",displayMode:"workload"},availableFilters:{byStatus:!0,byType:!0,byDate:!0,byResource:!0,byLocation:!0},visibleFields:["name","type","status","startTime","endTime","resources","progress","vesselInfo","cargoOperations"],customActions:["export","assignResources","viewAnalytics"]},OPERATIONS:{role:"OPERATIONS",viewPermissions:{canViewAll:!1,canViewOwn:!0,canFilter:!0,canExport:!1,canEdit:!1,canDelete:!1,canCreate:!1},defaultView:{mode:"list",timelineMode:"day",groupBy:"none",displayMode:"schedule"},availableFilters:{byStatus:!0,byType:!1,byDate:!0,byResource:!1,byLocation:!0},visibleFields:["name","status","startTime","endTime","berthLocation","vesselName","cargoType","instructions"],customActions:["viewDetails","checkIn","updateStatus"]},DRIVER:{role:"DRIVER",viewPermissions:{canViewAll:!1,canViewOwn:!0,canFilter:!1,canExport:!1,canEdit:!1,canDelete:!1,canCreate:!1},defaultView:{mode:"list",timelineMode:"day",groupBy:"none",displayMode:"schedule"},availableFilters:{byStatus:!0,byType:!1,byDate:!0,byResource:!1,byLocation:!1},visibleFields:["startTime","endTime","gateNumber","operationType","containerNumber","pickupLocation","deliveryLocation","route","status"],customActions:["viewRoute","startTask","completeTask","reportIssue"]}};function Vt(o){return(0,T.useMemo)(()=>xt[o]||xt.OPERATIONS,[o])}function zs(o){const s=Vt(o);return(0,T.useMemo)(()=>({canViewAll:s.viewPermissions.canViewAll,canViewOwn:s.viewPermissions.canViewOwn,canFilter:s.viewPermissions.canFilter,canExport:s.viewPermissions.canExport,canEdit:s.viewPermissions.canEdit,canDelete:s.viewPermissions.canDelete,canCreate:s.viewPermissions.canCreate}),[s])}var e=mt(Ps());const Os=({viewMode:o,onViewModeChange:s,groupBy:b,onGroupByChange:j,displayMode:f,onDisplayModeChange:u,zoom:g,onZoomChange:l,onFilterClick:r,dateRange:c})=>{const[w,m]=c;return(0,e.jsx)(a,{sx:{mb:2},children:(0,e.jsxs)(xe,{sx:{p:1},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap"},children:[(0,e.jsxs)(us,{size:"small",variant:"outlined",children:[(0,e.jsx)(oe,{startIcon:(0,e.jsx)(Ot,{}),onClick:()=>s("day"),variant:o==="day"?"contained":"outlined",children:"Day"}),(0,e.jsx)(oe,{startIcon:(0,e.jsx)(Nt,{}),onClick:()=>s("week"),variant:o==="week"?"contained":"outlined",children:"Week"}),(0,e.jsx)(oe,{startIcon:(0,e.jsx)(wt,{}),onClick:()=>s("month"),variant:o==="month"?"contained":"outlined",children:"Month"})]}),(0,e.jsxs)(Me,{size:"small",value:f,exclusive:!0,onChange:(h,v)=>v&&u(v),children:[(0,e.jsx)(X,{value:"timeline",children:(0,e.jsx)(L,{title:"Timeline View",children:(0,e.jsx)(at,{})})}),(0,e.jsx)(X,{value:"schedule",children:(0,e.jsx)(L,{title:"Schedule View",children:(0,e.jsx)(st,{})})}),(0,e.jsx)(X,{value:"workload",children:(0,e.jsx)(L,{title:"Workload View",children:(0,e.jsx)(tt,{})})}),(0,e.jsx)(X,{value:"dependencies",children:(0,e.jsx)(L,{title:"Dependencies View",children:(0,e.jsx)(It,{})})})]}),(0,e.jsxs)(Me,{size:"small",value:b,exclusive:!0,onChange:(h,v)=>v&&j(v),children:[(0,e.jsx)(X,{value:"none",children:(0,e.jsx)(L,{title:"No Grouping",children:(0,e.jsx)(as,{})})}),(0,e.jsx)(X,{value:"resource",children:(0,e.jsx)(L,{title:"Group by Resource",children:(0,e.jsx)(st,{})})}),(0,e.jsx)(X,{value:"type",children:(0,e.jsx)(L,{title:"Group by Type",children:(0,e.jsx)(at,{})})}),(0,e.jsx)(X,{value:"status",children:(0,e.jsx)(L,{title:"Group by Status",children:(0,e.jsx)(tt,{})})})]}),(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(z,{size:"small",onClick:()=>l(g-.2),disabled:g<=.5,children:(0,e.jsx)(Et,{fontSize:"small"})}),(0,e.jsx)(y,{label:`${Math.round(g*100)}%`,size:"small",onClick:()=>l(1)}),(0,e.jsx)(z,{size:"small",onClick:()=>l(g+.2),disabled:g>=3,children:(0,e.jsx)(vt,{fontSize:"small"})}),(0,e.jsx)(z,{size:"small",onClick:()=>l(1),children:(0,e.jsx)(Dt,{fontSize:"small"})})]}),(0,e.jsx)(a,{sx:{flexGrow:1}}),(0,e.jsx)(z,{onClick:r,children:(0,e.jsx)(Ce,{})})]}),(0,e.jsxs)(t,{variant:"caption",sx:{mt:1,display:"block",textAlign:"right",color:"text.secondary"},children:["Showing: ",w.toLocaleDateString()," - ",m.toLocaleDateString()]})]})})},Vs=({viewMode:o,onViewModeChange:s,selectedCount:b,onDeleteSelected:j,onExport:f,onFilterClick:u,onSearchChange:g,activeFilters:l,onClearFilter:r})=>(0,e.jsxs)(xe,{sx:{p:2,mb:2},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,e.jsx)(t,{variant:"h6",sx:{flexGrow:1},children:b>0?`${b} selected`:"Schedules"}),(0,e.jsx)(Ct,{placeholder:"Search schedules...",size:"small",onChange:c=>g(c.target.value),InputProps:{startAdornment:(0,e.jsx)(Ss,{position:"start",children:(0,e.jsx)(Mt,{fontSize:"small"})})},sx:{width:250}}),(0,e.jsxs)(a,{children:[(0,e.jsx)(L,{title:"List View",children:(0,e.jsx)(z,{color:o==="list"?"primary":"default",onClick:()=>s("list"),children:(0,e.jsx)(Ke,{})})}),(0,e.jsx)(L,{title:"Grid View",children:(0,e.jsx)(z,{color:o==="grid"?"primary":"default",onClick:()=>s("grid"),children:(0,e.jsx)(St,{})})})]}),b>0?(0,e.jsx)(oe,{startIcon:(0,e.jsx)(Qe,{}),variant:"contained",color:"error",onClick:j,children:"Delete Selected"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L,{title:"Export",children:(0,e.jsx)(z,{onClick:f,children:(0,e.jsx)(ps,{})})}),(0,e.jsx)(L,{title:"Filter",children:(0,e.jsx)(z,{onClick:u,children:(0,e.jsx)(Ce,{})})})]})]}),(l.status?.length||l.type?.length||l.dateRange?.[0])&&(0,e.jsxs)(a,{sx:{display:"flex",gap:1,mt:2,flexWrap:"wrap"},children:[(0,e.jsx)(t,{variant:"body2",color:"text.secondary",sx:{mr:1},children:"Active Filters:"}),l.status?.map(c=>(0,e.jsx)(y,{label:`Status: ${c}`,size:"small",onDelete:()=>r("status")},c)),l.type?.map(c=>(0,e.jsx)(y,{label:`Type: ${c}`,size:"small",onDelete:()=>r("type")},c)),l.dateRange?.[0]&&(0,e.jsx)(y,{label:`Date Range: ${l.dateRange[0]?.toLocaleDateString()} - ${l.dateRange[1]?.toLocaleDateString()||"Now"}`,size:"small",onDelete:()=>r("dateRange")})]})]}),ht=({value:o,color:s,showLabel:b=!1,height:j=4,tooltip:f})=>{const u=Math.min(Math.max(o,0),100),g=`${Math.round(u)}%`,l=(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(a,{sx:{width:"100%",height:j,bgcolor:"#eee",borderRadius:j/2,overflow:"hidden"},children:(0,e.jsx)(a,{sx:{width:`${u}%`,height:"100%",bgcolor:s,transition:"width 0.3s ease"}})}),b&&(0,e.jsx)(t,{variant:"caption",sx:{minWidth:40},children:g})]});return f?(0,e.jsx)(L,{title:f,children:(0,e.jsx)(a,{children:l})}):l};var Hs=o=>{switch(o){case"PENDING":return"#ff9800";case"IN_PROGRESS":return"#4caf50";case"COMPLETED":return"#9e9e9e";case"CANCELLED":return"#f44336";default:return"#2196f3"}};const ut=({startTime:o,endTime:s,tasks:b,width:j,height:f,showLabels:u=!1})=>{const g=(0,T.useRef)(null);return(0,T.useEffect)(()=>{if(!g.current||!b?.length)return;const l=ye(g.current);l.selectAll("*").remove();const r=new Date(o),c=new Date(s),w=new Date,m=qe().domain([r,c]).range([0,j]),h=b.reduce((x,d)=>{const n=d.assetId||"unassigned";return x[n]||(x[n]=[]),x[n].push(d),x},{}),v=Object.keys(h),R=f/(v.length||1),_=Math.min(R*.8,16);if(v.forEach((x,d)=>{const n=h[x],i=d*R+(R-_)/2;n.forEach(E=>{const S=new Date(E.startTime),P=new Date(E.endTime),k=m(S),V=m(P)-k,$=l.append("g").attr("class","task").attr("transform",`translate(${k},${i})`);$.append("rect").attr("width",Math.max(V,2)).attr("height",_).attr("rx",2).attr("fill",Hs(E.status)).attr("opacity",.8),u&&V>50&&$.append("text").attr("x",4).attr("y",_/2).attr("dy","0.35em").attr("fill","#fff").style("font-size","10px").text(E.taskName||"Task");const B=`${E.taskName||"Task"}
Status: ${E.status}
Start: ${A(S,"PPp")}
End: ${A(P,"PPp")}`;$.append("title").text(B)})}),w>=r&&w<=c){const x=m(w);l.append("line").attr("x1",x).attr("x2",x).attr("y1",0).attr("y2",f).attr("stroke","#f44336").attr("stroke-width",2).attr("stroke-dasharray","2,2")}},[o,s,b,j,f,u]),(0,e.jsx)(a,{sx:{width:j},children:(0,e.jsx)("svg",{ref:g,width:j,height:f})})},Ws=({schedules:o,selectedIds:s,onSelect:b,onSelectAll:j,onEditSchedule:f,onDeleteSchedule:u,onStartSchedule:g,onCompleteSchedule:l,onCancelSchedule:r})=>{const[c,w]=(0,T.useState)(null),m=(0,T.useRef)(null),h=x=>{w(c===x?null:x)},v=x=>{switch(x){case"PENDING":return"#ff9800";case"SCHEDULED":return"#2196f3";case"IN_PROGRESS":return"#4caf50";case"COMPLETED":return"#9e9e9e";case"CANCELLED":return"#f44336";default:return"#757575"}},R=x=>x?.length?x.filter(d=>d.status==="COMPLETED").length/x.length*100:0,_=x=>{if(!x?.length)return 0;const d=x.reduce((n,i)=>{const E=new Date(i.startTime),S=new Date(i.endTime);return n+(S.getTime()-E.getTime())/(1e3*60*60)},0);return Math.min(d/168*100,100)};return(0,e.jsx)(bt,{component:xe,ref:m,children:(0,e.jsxs)(Be,{stickyHeader:!0,children:[(0,e.jsx)(Ge,{children:(0,e.jsxs)(ce,{children:[(0,e.jsx)(D,{padding:"checkbox",children:(0,e.jsx)(Q,{indeterminate:s.length>0&&s.length<o.length,checked:s.length===o.length,onChange:x=>j(x.target.checked)})}),(0,e.jsx)(D,{}),(0,e.jsx)(D,{children:"Schedule Name"}),(0,e.jsx)(D,{children:"Type"}),(0,e.jsx)(D,{children:"Status"}),(0,e.jsx)(D,{children:"Progress"}),(0,e.jsx)(D,{children:"Resource Utilization"}),(0,e.jsx)(D,{children:"Timeline"}),(0,e.jsx)(D,{children:"Actions"})]})}),(0,e.jsx)(Fe,{children:o.map(x=>{const d=c===x.id,n=s.includes(x.id),i=R(x.tasks),E=_(x.tasks);return(0,e.jsxs)(T.Fragment,{children:[(0,e.jsxs)(ce,{hover:!0,selected:n,children:[(0,e.jsx)(D,{padding:"checkbox",children:(0,e.jsx)(Q,{checked:n,onChange:S=>b(x.id,S.target.checked)})}),(0,e.jsx)(D,{children:(0,e.jsx)(z,{size:"small",onClick:()=>h(x.id),children:d?(0,e.jsx)(Ue,{}):(0,e.jsx)(cs,{})})}),(0,e.jsxs)(D,{children:[(0,e.jsx)(t,{variant:"body1",sx:{fontWeight:500},children:x.operation||"Untitled Schedule"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:x.notes||"No description"})]}),(0,e.jsx)(D,{children:(0,e.jsx)(y,{label:x.type?.replace(/_/g," "),size:"small",variant:"outlined"})}),(0,e.jsx)(D,{children:(0,e.jsx)(y,{label:x.status,size:"small",sx:{bgcolor:v(x.status),color:"#fff"}})}),(0,e.jsx)(D,{children:(0,e.jsx)(ht,{value:i,color:v(x.status),showLabel:!0,height:8})}),(0,e.jsx)(D,{children:(0,e.jsx)(ht,{value:E,color:"#1976d2",showLabel:!0,height:8})}),(0,e.jsx)(D,{children:(0,e.jsx)(ut,{startTime:x.startTime,endTime:x.endTime,tasks:x.tasks,width:120,height:24})}),(0,e.jsx)(D,{children:(0,e.jsxs)(a,{sx:{display:"flex",gap:.5},children:[x.status==="SCHEDULED"&&(0,e.jsx)(L,{title:"Start Schedule",children:(0,e.jsx)(z,{size:"small",color:"success",onClick:()=>g(x),children:(0,e.jsx)(Pe,{fontSize:"small"})})}),x.status==="IN_PROGRESS"&&(0,e.jsx)(L,{title:"Complete Schedule",children:(0,e.jsx)(z,{size:"small",color:"primary",onClick:()=>l(x),children:(0,e.jsx)(de,{fontSize:"small"})})}),["SCHEDULED","IN_PROGRESS"].includes(x.status)&&(0,e.jsx)(L,{title:"Cancel Schedule",children:(0,e.jsx)(z,{size:"small",color:"error",onClick:()=>r(x),children:(0,e.jsx)(Ye,{fontSize:"small"})})}),(0,e.jsx)(L,{title:"Edit Schedule",children:(0,e.jsx)(z,{size:"small",onClick:()=>f(x),children:(0,e.jsx)(At,{fontSize:"small"})})}),(0,e.jsx)(L,{title:"Delete Schedule",children:(0,e.jsx)(z,{size:"small",color:"error",onClick:()=>u(x.id),children:(0,e.jsx)(Qe,{fontSize:"small"})})})]})})]}),(0,e.jsx)(ce,{children:(0,e.jsx)(D,{colSpan:9,sx:{py:0,borderBottom:0},children:(0,e.jsx)(Lt,{in:d,timeout:"auto",unmountOnExit:!0,children:(0,e.jsx)(a,{sx:{py:2},children:(0,e.jsxs)(G,{container:!0,spacing:2,children:[(0,e.jsxs)(G,{item:!0,xs:12,md:6,children:[(0,e.jsx)(t,{variant:"subtitle2",gutterBottom:!0,children:"Tasks"}),(0,e.jsxs)(Be,{size:"small",children:[(0,e.jsx)(Ge,{children:(0,e.jsxs)(ce,{children:[(0,e.jsx)(D,{children:"Task Name"}),(0,e.jsx)(D,{children:"Status"}),(0,e.jsx)(D,{children:"Start Time"}),(0,e.jsx)(D,{children:"End Time"})]})}),(0,e.jsx)(Fe,{children:x.tasks?.map(S=>(0,e.jsxs)(ce,{children:[(0,e.jsx)(D,{children:S.taskName}),(0,e.jsx)(D,{children:(0,e.jsx)(y,{label:S.status,size:"small",sx:{bgcolor:v(S.status),color:"#fff"}})}),(0,e.jsx)(D,{children:A(new Date(S.startTime),"MMM d, HH:mm")}),(0,e.jsx)(D,{children:A(new Date(S.endTime),"MMM d, HH:mm")})]},S.id))})]})]}),(0,e.jsxs)(G,{item:!0,xs:12,md:6,children:[(0,e.jsx)(t,{variant:"subtitle2",gutterBottom:!0,children:"Timeline"}),(0,e.jsx)(ut,{startTime:x.startTime,endTime:x.endTime,tasks:x.tasks,width:500,height:100,showLabels:!0})]})]})})})})})]},x.id)})})]})})},Gs=({schedules:o,onScheduleClick:s,onFilterChange:b})=>{const j=Re(),f=Se(j.breakpoints.down("sm")),[u,g]=(0,T.useState)("grouped"),[l,r]=(0,T.useState)("ship"),[c,w]=(0,T.useState)(new Set),m={total:o.length,active:o.filter(d=>d.status==="IN_PROGRESS").length,completed:o.filter(d=>d.status==="COMPLETED").length,pending:o.filter(d=>d.status==="PENDING"||d.status==="SCHEDULED").length,cancelled:o.filter(d=>d.status==="CANCELLED").length},h=(0,T.useMemo)(()=>{const d={};return o.forEach(n=>{let i="Kh√°c";switch(l){case"ship":i=n.shipVisit?.vesselName||"Kh√¥ng c√≥ t√†u";break;case"berth":i=n.berthName||"Ch∆∞a ph√¢n b·∫øn";break;case"status":i=n.status;break;case"date":i=A(new Date(n.startTime),"dd/MM/yyyy",{locale:le});break}d[i]||(d[i]=[]),d[i].push(n)}),d},[o,l]),v=d=>{const n=new Set(c);n.has(d)?n.delete(d):n.add(d),w(n)},R=d=>{switch(d){case"PENDING":case"SCHEDULED":return"warning";case"IN_PROGRESS":return"primary";case"COMPLETED":return"success";case"CANCELLED":return"error";default:return"default"}},_=d=>({PENDING:"Ch·ªù x·ª≠ l√Ω",SCHEDULED:"ƒê√£ l√™n l·ªãch",IN_PROGRESS:"ƒêang th·ª±c hi·ªán",COMPLETED:"Ho√†n th√†nh",CANCELLED:"ƒê√£ h·ªßy"})[d]||d,x=()=>{switch(l){case"ship":return(0,e.jsx)(ie,{});case"berth":return(0,e.jsx)(be,{});case"status":return(0,e.jsx)(ve,{});case"date":return(0,e.jsx)(ke,{});default:return(0,e.jsx)(it,{})}};return(0,e.jsxs)(a,{sx:{p:{xs:1,sm:2}},children:[(0,e.jsxs)(a,{sx:{mb:3},children:[(0,e.jsxs)(N,{direction:"row",spacing:2,alignItems:"center",flexWrap:"wrap",sx:{mb:2},children:[(0,e.jsx)(t,{variant:"h6",sx:{flex:1},children:"Qu·∫£n l√Ω L·ªãch tr√¨nh To√†n c·∫£ng"}),(0,e.jsxs)(_t,{value:u,onChange:(d,n)=>g(n),sx:{minHeight:40},children:[(0,e.jsx)(we,{value:"dashboard",label:f?void 0:"T·ªïng quan",icon:(0,e.jsx)(it,{}),iconPosition:"start",sx:{minHeight:40,py:1}}),(0,e.jsx)(we,{value:"grouped",label:f?void 0:"Theo nh√≥m",icon:(0,e.jsx)(St,{}),iconPosition:"start",sx:{minHeight:40,py:1}}),(0,e.jsx)(we,{value:"table",label:f?void 0:"B·∫£ng",icon:(0,e.jsx)(Ke,{}),iconPosition:"start",sx:{minHeight:40,py:1}})]})]}),(u==="grouped"||u==="table")&&(0,e.jsxs)(a,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[(0,e.jsx)(y,{icon:(0,e.jsx)(ie,{}),label:"Theo t√†u",onClick:()=>r("ship"),color:l==="ship"?"primary":"default",variant:l==="ship"?"filled":"outlined"}),(0,e.jsx)(y,{icon:(0,e.jsx)(be,{}),label:"Theo b·∫øn",onClick:()=>r("berth"),color:l==="berth"?"primary":"default",variant:l==="berth"?"filled":"outlined"}),(0,e.jsx)(y,{icon:(0,e.jsx)(ve,{}),label:"Theo tr·∫°ng th√°i",onClick:()=>r("status"),color:l==="status"?"primary":"default",variant:l==="status"?"filled":"outlined"}),(0,e.jsx)(y,{icon:(0,e.jsx)(ke,{}),label:"Theo ng√†y",onClick:()=>r("date"),color:l==="date"?"primary":"default",variant:l==="date"?"filled":"outlined"})]})]}),u==="dashboard"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(G,{container:!0,spacing:2,sx:{mb:3},children:[(0,e.jsx)(G,{item:!0,xs:6,sm:6,md:2.4,children:(0,e.jsx)(H,{sx:{bgcolor:"primary.lighter",height:"100%"},children:(0,e.jsx)(W,{children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"T·ªïng l·ªãch tr√¨nh"}),(0,e.jsx)(t,{variant:"h4",fontWeight:700,children:m.total}),(0,e.jsx)(y,{icon:(0,e.jsx)(ve,{}),label:"T·ªïng s·ªë",size:"small",color:"primary"})]})})})}),(0,e.jsx)(G,{item:!0,xs:6,sm:6,md:2.4,children:(0,e.jsx)(H,{sx:{bgcolor:"info.lighter",height:"100%"},children:(0,e.jsx)(W,{children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"ƒêang th·ª±c hi·ªán"}),(0,e.jsx)(t,{variant:"h4",fontWeight:700,children:m.active}),(0,e.jsx)(y,{icon:(0,e.jsx)(ms,{}),label:`${m.total>0?(m.active/m.total*100).toFixed(0):0}%`,size:"small",color:"info"})]})})})}),(0,e.jsx)(G,{item:!0,xs:6,sm:6,md:2.4,children:(0,e.jsx)(H,{sx:{bgcolor:"success.lighter",height:"100%"},children:(0,e.jsx)(W,{children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Ho√†n th√†nh"}),(0,e.jsx)(t,{variant:"h4",fontWeight:700,children:m.completed}),(0,e.jsx)(y,{icon:(0,e.jsx)(de,{}),label:`${m.total>0?(m.completed/m.total*100).toFixed(0):0}%`,size:"small",color:"success"})]})})})}),(0,e.jsx)(G,{item:!0,xs:6,sm:6,md:2.4,children:(0,e.jsx)(H,{sx:{bgcolor:"warning.lighter",height:"100%"},children:(0,e.jsx)(W,{children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Ch·ªù x·ª≠ l√Ω"}),(0,e.jsx)(t,{variant:"h4",fontWeight:700,children:m.pending}),(0,e.jsx)(y,{icon:(0,e.jsx)(Rt,{}),label:"Pending",size:"small",color:"warning"})]})})})}),(0,e.jsx)(G,{item:!0,xs:6,sm:6,md:2.4,children:(0,e.jsx)(H,{sx:{bgcolor:"error.lighter",height:"100%"},children:(0,e.jsx)(W,{children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"ƒê√£ h·ªßy"}),(0,e.jsx)(t,{variant:"h4",fontWeight:700,children:m.cancelled}),(0,e.jsx)(y,{icon:(0,e.jsx)(Ye,{}),label:"Cancelled",size:"small",color:"error"})]})})})})]}),(0,e.jsx)(H,{children:(0,e.jsxs)(W,{children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"L·ªãch tr√¨nh g·∫ßn ƒë√¢y"}),(0,e.jsx)(ne,{sx:{mb:2}}),o.length===0?(0,e.jsx)(t,{variant:"body2",color:"text.secondary",align:"center",sx:{py:4},children:"Kh√¥ng c√≥ l·ªãch tr√¨nh"}):(0,e.jsx)(N,{spacing:1.5,children:o.slice(0,10).map(d=>(0,e.jsx)(a,{sx:{p:2,bgcolor:"background.default",borderRadius:1,cursor:"pointer",transition:"all 0.2s",border:"1px solid",borderColor:"divider","&:hover":{bgcolor:"action.hover",borderColor:"primary.main",transform:"translateX(4px)"}},onClick:()=>s?.(d),children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:1},children:[(0,e.jsxs)(a,{sx:{flex:1,minWidth:200},children:[(0,e.jsx)(t,{variant:"subtitle2",fontWeight:600,children:d.operation||d.name}),d.shipVisit&&(0,e.jsxs)(t,{variant:"caption",color:"primary.main",sx:{display:"flex",alignItems:"center",gap:.5,mt:.5},children:[(0,e.jsx)(ie,{fontSize:"small"}),d.shipVisit.vesselName]})]}),(0,e.jsx)(y,{label:_(d.status),size:"small",color:R(d.status)})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:1,flexWrap:"wrap",alignItems:"center"},children:[(0,e.jsx)(y,{icon:(0,e.jsx)(ke,{}),label:A(new Date(d.startTime),"dd/MM HH:mm",{locale:le}),size:"small",variant:"outlined"}),d.berthName&&(0,e.jsx)(y,{icon:(0,e.jsx)(be,{}),label:d.berthName,size:"small",variant:"outlined"}),d.completionPercentage!==void 0&&d.status==="IN_PROGRESS"&&(0,e.jsx)(y,{label:`${d.completionPercentage}%`,size:"small",color:"info",variant:"outlined"})]})]})},d.id))})]})})]}),u==="grouped"&&(0,e.jsx)(N,{spacing:2,children:Object.entries(h).map(([d,n])=>(0,e.jsx)(H,{children:(0,e.jsxs)(W,{sx:{p:0},children:[(0,e.jsxs)(a,{sx:{p:2,bgcolor:"primary.lighter",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer","&:hover":{bgcolor:"primary.light"}},onClick:()=>v(d),children:[(0,e.jsxs)(N,{direction:"row",spacing:2,alignItems:"center",sx:{flex:1},children:[(0,e.jsx)(Es,{sx:{bgcolor:"primary.main"},children:x()}),(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"h6",children:d}),(0,e.jsxs)(t,{variant:"caption",color:"text.secondary",children:[n.length," l·ªãch tr√¨nh"]})]})]}),(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",children:[(0,e.jsx)(gs,{badgeContent:n.filter(i=>i.status==="IN_PROGRESS").length,color:"primary",children:(0,e.jsx)(y,{label:"ƒêang ch·∫°y",size:"small"})}),(0,e.jsx)(z,{size:"small",children:c.has(d)?(0,e.jsx)(et,{}):(0,e.jsx)(Ue,{})})]})]}),(0,e.jsx)(Lt,{in:c.has(d),children:(0,e.jsx)(a,{sx:{p:2},children:(0,e.jsx)(G,{container:!0,spacing:2,children:n.map(i=>(0,e.jsx)(G,{item:!0,xs:12,sm:6,md:4,children:(0,e.jsx)(H,{sx:{cursor:"pointer",transition:"all 0.2s",border:"2px solid",borderColor:"divider","&:hover":{borderColor:"primary.main",transform:"translateY(-4px)",boxShadow:4}},onClick:()=>s?.(i),children:(0,e.jsx)(W,{children:(0,e.jsxs)(N,{spacing:1.5,children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,e.jsx)(y,{label:_(i.status),size:"small",color:R(i.status)}),i.completionPercentage!==void 0&&i.status==="IN_PROGRESS"&&(0,e.jsxs)(t,{variant:"caption",fontWeight:600,color:"primary",children:[i.completionPercentage,"%"]})]}),(0,e.jsx)(t,{variant:"subtitle2",fontWeight:600,noWrap:!0,children:i.operation||i.name}),i.shipVisit&&(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(ie,{fontSize:"small",color:"primary"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",noWrap:!0,children:i.shipVisit.vesselName})]}),(0,e.jsx)(ne,{}),(0,e.jsxs)(N,{spacing:.5,children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(ke,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",children:A(new Date(i.startTime),"dd/MM/yyyy HH:mm",{locale:le})})]}),i.berthName&&(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(be,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",children:i.berthName})]})]}),i.status==="IN_PROGRESS"&&i.completionPercentage!==void 0&&(0,e.jsx)(Ne,{variant:"determinate",value:i.completionPercentage,sx:{height:6,borderRadius:3}})]})})})},i.id))})})})]})},d))}),u==="table"&&(0,e.jsx)(bt,{component:xe,children:(0,e.jsxs)(Be,{children:[(0,e.jsx)(Ge,{children:(0,e.jsxs)(ce,{sx:{bgcolor:"primary.lighter"},children:[(0,e.jsx)(D,{children:(0,e.jsx)("strong",{children:"L·ªãch tr√¨nh"})}),(0,e.jsx)(D,{children:(0,e.jsx)("strong",{children:"T√†u"})}),(0,e.jsx)(D,{children:(0,e.jsx)("strong",{children:"B·∫øn"})}),(0,e.jsx)(D,{children:(0,e.jsx)("strong",{children:"Th·ªùi gian"})}),(0,e.jsx)(D,{children:(0,e.jsx)("strong",{children:"Ti·∫øn ƒë·ªô"})}),(0,e.jsx)(D,{children:(0,e.jsx)("strong",{children:"Tr·∫°ng th√°i"})})]})}),(0,e.jsx)(Fe,{children:Object.entries(h).map(([d,n])=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ce,{sx:{bgcolor:"action.hover",cursor:"pointer","&:hover":{bgcolor:"action.selected"}},onClick:()=>v(d),children:(0,e.jsx)(D,{colSpan:6,children:(0,e.jsxs)(N,{direction:"row",spacing:2,alignItems:"center",children:[(0,e.jsx)(z,{size:"small",children:c.has(d)?(0,e.jsx)(et,{}):(0,e.jsx)(Ue,{})}),x(),(0,e.jsx)(t,{variant:"subtitle1",fontWeight:600,children:d}),(0,e.jsx)(y,{label:`${n.length} l·ªãch tr√¨nh`,size:"small"})]})})},`group-${d}`),c.has(d)&&n.map(i=>(0,e.jsxs)(ce,{hover:!0,sx:{cursor:"pointer","&:hover":{bgcolor:"action.selected"}},onClick:()=>s?.(i),children:[(0,e.jsx)(D,{children:(0,e.jsx)(t,{variant:"body2",fontWeight:500,children:i.operation||i.name})}),(0,e.jsx)(D,{children:i.shipVisit?(0,e.jsxs)(N,{direction:"row",spacing:.5,alignItems:"center",children:[(0,e.jsx)(ie,{fontSize:"small",color:"primary"}),(0,e.jsx)(t,{variant:"body2",children:i.shipVisit.vesselName})]}):(0,e.jsx)(t,{variant:"body2",color:"text.secondary",children:"-"})}),(0,e.jsx)(D,{children:(0,e.jsx)(t,{variant:"body2",children:i.berthName||"-"})}),(0,e.jsxs)(D,{children:[(0,e.jsx)(t,{variant:"caption",children:A(new Date(i.startTime),"dd/MM HH:mm",{locale:le})}),(0,e.jsx)("br",{}),(0,e.jsxs)(t,{variant:"caption",color:"text.secondary",children:[yt(new Date(i.endTime),new Date(i.startTime)),"h"]})]}),(0,e.jsx)(D,{children:i.completionPercentage!==void 0?(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1,minWidth:120},children:[(0,e.jsx)(Ne,{variant:"determinate",value:i.completionPercentage,sx:{flex:1,height:6,borderRadius:3}}),(0,e.jsxs)(t,{variant:"caption",fontWeight:600,children:[i.completionPercentage,"%"]})]}):"-"}),(0,e.jsx)(D,{children:(0,e.jsx)(y,{label:_(i.status),size:"small",color:R(i.status)})})]},i.id))]}))})]})}),o.length===0&&(0,e.jsx)(H,{children:(0,e.jsx)(W,{children:(0,e.jsx)(t,{variant:"body1",color:"text.secondary",align:"center",sx:{py:8},children:"Kh√¥ng c√≥ l·ªãch tr√¨nh n√†o"})})})]})},$s=({schedules:o,onScheduleClick:s})=>{const b=Re(),j=Se(b.breakpoints.down("sm")),f=l=>{switch(l){case"PENDING":return"warning";case"SCHEDULED":return"info";case"IN_PROGRESS":return"primary";case"COMPLETED":return"success";case"CANCELLED":return"error";default:return"default"}},u=l=>{switch(l){case"PENDING":return"Ch·ªù x·ª≠ l√Ω";case"SCHEDULED":return"ƒê√£ l√™n l·ªãch";case"IN_PROGRESS":return"ƒêang th·ª±c hi·ªán";case"COMPLETED":return"Ho√†n th√†nh";case"CANCELLED":return"ƒê√£ h·ªßy";default:return l}},g=l=>({driverId:"DRV001",driverName:"Nguy·ªÖn VƒÉn A",vehicleId:"VEH001",vehicleNumber:"79C-12345",workDetails:{gateNumber:l.berthName||"C·ªïng 1",operationType:"PICKUP",loadingZone:"Khu v·ª±c A",unloadingZone:"Khu v·ª±c B"},containers:[{id:"CNT001",containerNumber:"MSCU1234567",size:"40FT",type:"DRY",weight:2e4,isEmpty:!1,pickupLocation:"B·∫øn A",deliveryLocation:"Kho B"}],route:{origin:"C·∫£ng H·∫£i Ph√≤ng",destination:"Kho H√†ng N·ªôi ƒê·ªãa",waypoints:[],estimatedDistance:15,estimatedDuration:45},workShift:{startTime:l.startTime,endTime:l.endTime}});return(0,e.jsx)(a,{sx:{display:"flex",flexDirection:"column",gap:2,p:{xs:1,sm:2}},children:o.length===0?(0,e.jsx)(H,{children:(0,e.jsx)(W,{children:(0,e.jsx)(t,{variant:"body1",color:"text.secondary",align:"center",children:"Kh√¥ng c√≥ l·ªãch l√†m vi·ªác"})})}):o.map(l=>{const r=g(l);return(0,e.jsx)(H,{sx:{cursor:s?"pointer":"default",transition:"all 0.2s","&:hover":s?{boxShadow:4,transform:"translateY(-2px)"}:{}},onClick:()=>s?.(l),children:(0,e.jsxs)(W,{children:[(0,e.jsx)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,flexWrap:"wrap",gap:1},children:(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:j?"subtitle1":"h6",gutterBottom:!0,children:l.name}),(0,e.jsxs)(N,{direction:"row",spacing:1,flexWrap:"wrap",children:[(0,e.jsx)(y,{label:u(l.status),color:f(l.status),size:"small"}),(0,e.jsx)(y,{icon:(0,e.jsx)(ve,{}),label:A(new Date(l.startTime),"HH:mm",{locale:le}),size:"small",variant:"outlined"})]})]})}),(0,e.jsx)(ne,{sx:{my:2}}),(0,e.jsxs)(N,{spacing:2,children:[(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Th·ªùi gian l√†m vi·ªác"}),(0,e.jsxs)(t,{variant:"body2",children:[A(new Date(l.startTime),"dd/MM/yyyy HH:mm",{locale:le})," - "," ",A(new Date(l.endTime),"HH:mm",{locale:le})]})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"}},children:[(0,e.jsx)(a,{sx:{flex:1},children:(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",children:[(0,e.jsx)(Tt,{fontSize:"small",color:"action"}),(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"S·ªë xe"}),(0,e.jsx)(t,{variant:"body2",fontWeight:600,children:r.vehicleNumber})]})]})}),(0,e.jsx)(a,{sx:{flex:1},children:(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",children:[(0,e.jsx)(is,{fontSize:"small",color:"action"}),(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"C·ªïng/C√¥ng"}),(0,e.jsx)(t,{variant:"body2",fontWeight:600,children:r.workDetails.gateNumber})]})]})})]}),r.containers.length>0&&(0,e.jsxs)(a,{children:[(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,e.jsx)(os,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Container"})]}),r.containers.map(c=>(0,e.jsxs)(a,{sx:{p:1.5,bgcolor:"background.default",borderRadius:1,mb:1},children:[(0,e.jsx)(t,{variant:"body2",fontWeight:600,children:c.containerNumber}),(0,e.jsxs)(N,{direction:"row",spacing:1,mt:.5,flexWrap:"wrap",children:[(0,e.jsx)(y,{label:c.size,size:"small"}),(0,e.jsx)(y,{label:c.type,size:"small"}),(0,e.jsx)(y,{label:`${c.weight.toLocaleString()} kg`,size:"small",variant:"outlined"})]})]},c.id))]}),(0,e.jsxs)(a,{children:[(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,e.jsx)(It,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Tuy·∫øn ƒë∆∞·ªùng"})]}),(0,e.jsx)(a,{sx:{p:1.5,bgcolor:"background.default",borderRadius:1},children:(0,e.jsxs)(N,{spacing:1,children:[(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"ƒêi·ªÉm ƒëi"}),(0,e.jsx)(t,{variant:"body2",children:r.route.origin})]}),(0,e.jsx)(ne,{}),(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"ƒêi·ªÉm ƒë·∫øn"}),(0,e.jsx)(t,{variant:"body2",children:r.route.destination})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,mt:1},children:[(0,e.jsxs)(t,{variant:"caption",children:["üìè ",r.route.estimatedDistance," km"]}),(0,e.jsxs)(t,{variant:"caption",children:["‚è±Ô∏è ~",r.route.estimatedDuration," ph√∫t"]})]})]})})]}),l.notes&&(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Ghi ch√∫"}),(0,e.jsx)(t,{variant:"body2",sx:{p:1.5,bgcolor:"warning.lighter",borderRadius:1,mt:.5},children:l.notes})]})]})]})},l.id)})})},Bs=({schedules:o,onScheduleClick:s})=>{const b=Re(),j=Se(b.breakpoints.down("sm")),f=r=>{switch(r){case"PENDING":return"warning";case"SCHEDULED":return"info";case"IN_PROGRESS":return"primary";case"COMPLETED":return"success";case"CANCELLED":return"error";default:return"default"}},u=r=>{switch(r){case"PENDING":return"Ch·ªù c·∫≠p b·∫øn";case"SCHEDULED":return"ƒê√£ l√™n l·ªãch";case"IN_PROGRESS":return"ƒêang neo ƒë·∫≠u";case"COMPLETED":return"ƒê√£ r·ªùi b·∫øn";case"CANCELLED":return"ƒê√£ h·ªßy";default:return r}},g=r=>{const c=yt(new Date(r.endTime),new Date(r.startTime));return{vesselName:r.shipVisit?.vesselName||"Ch∆∞a x√°c ƒë·ªãnh",vesselIMO:r.shipVisit?.vesselIMO||"N/A",voyageNumber:r.shipVisit?.voyageNumber||"N/A",berthingInfo:{berthLocation:r.berthName||r.shipVisit?.assignedBerth||"B·∫øn ch∆∞a x√°c ƒë·ªãnh",arrivalTime:r.startTime,departureTime:r.endTime,estimatedStayDuration:c*60},cargoOperations:r.tasks?.map((w,m)=>({id:w.id,type:m%3===0?"LOADING":m%3===1?"UNLOADING":"TRANSHIPMENT",containerCount:50+m*10,cargoType:"Container",startTime:w.startTime,endTime:w.endTime,status:w.status}))||[],portServices:{pilotRequired:r.resources?.pilotRequired||!1,pilotName:r.resources?.pilotName,tugboatCount:r.resources?.tugboatCount||0,mooringServices:!0},specialRequirements:r.notes?[r.notes]:[]}},l=r=>{switch(r){case"LOADING":return"B·ªëc h√†ng";case"UNLOADING":return"D·ª° h√†ng";case"TRANSHIPMENT":return"Trung chuy·ªÉn";default:return r}};return(0,e.jsx)(a,{sx:{display:"flex",flexDirection:"column",gap:2,p:{xs:1,sm:2}},children:o.length===0?(0,e.jsx)(H,{children:(0,e.jsx)(W,{children:(0,e.jsx)(t,{variant:"body1",color:"text.secondary",align:"center",children:"Kh√¥ng c√≥ l·ªãch tr√¨nh t√†u"})})}):o.map(r=>{const c=g(r),w=r.completionPercentage||0;return(0,e.jsx)(H,{sx:{cursor:s?"pointer":"default",transition:"all 0.2s","&:hover":s?{boxShadow:4,transform:"translateY(-2px)"}:{}},onClick:()=>s?.(r),children:(0,e.jsxs)(W,{children:[(0,e.jsx)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,flexWrap:"wrap",gap:1},children:(0,e.jsxs)(a,{sx:{flex:1},children:[(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,e.jsx)(ie,{color:"primary"}),(0,e.jsx)(t,{variant:j?"subtitle1":"h6",children:c.vesselName})]}),(0,e.jsxs)(N,{direction:"row",spacing:1,flexWrap:"wrap",children:[(0,e.jsx)(y,{label:u(r.status),color:f(r.status),size:"small"}),(0,e.jsx)(y,{label:`IMO: ${c.vesselIMO}`,size:"small",variant:"outlined"}),(0,e.jsx)(y,{label:`Voyage: ${c.voyageNumber}`,size:"small",variant:"outlined"})]})]})}),r.status==="IN_PROGRESS"&&(0,e.jsxs)(a,{sx:{mb:2},children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Ti·∫øn ƒë·ªô"}),(0,e.jsxs)(t,{variant:"caption",fontWeight:600,children:[w,"%"]})]}),(0,e.jsx)(Ne,{variant:"determinate",value:w,sx:{height:8,borderRadius:4}})]}),(0,e.jsx)(ne,{sx:{my:2}}),(0,e.jsxs)(N,{spacing:2,children:[(0,e.jsxs)(a,{children:[(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,e.jsx)(be,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Th√¥ng tin c·∫≠p b·∫øn"})]}),(0,e.jsx)(a,{sx:{p:1.5,bgcolor:"background.default",borderRadius:1},children:(0,e.jsxs)(N,{spacing:1.5,children:[(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"V·ªã tr√≠ b·∫øn"}),(0,e.jsxs)(N,{direction:"row",spacing:.5,alignItems:"center",children:[(0,e.jsx)(vs,{fontSize:"small"}),(0,e.jsx)(t,{variant:"body2",fontWeight:600,children:c.berthingInfo.berthLocation})]})]}),(0,e.jsx)(ne,{}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[(0,e.jsxs)(a,{sx:{flex:1,minWidth:150},children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Th·ªùi gian c·∫≠p b·∫øn"}),(0,e.jsx)(t,{variant:"body2",children:A(new Date(c.berthingInfo.arrivalTime),"dd/MM/yyyy HH:mm",{locale:le})})]}),(0,e.jsxs)(a,{sx:{flex:1,minWidth:150},children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Th·ªùi gian r·ªùi b·∫øn"}),(0,e.jsx)(t,{variant:"body2",children:A(new Date(c.berthingInfo.departureTime),"dd/MM/yyyy HH:mm",{locale:le})})]})]}),(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Th·ªùi gian neo ƒë·∫≠u d·ª± ki·∫øn"}),(0,e.jsxs)(t,{variant:"body2",fontWeight:600,color:"primary",children:[Math.floor(c.berthingInfo.estimatedStayDuration/60),"h ",c.berthingInfo.estimatedStayDuration%60,"m"]})]})]})})]}),(0,e.jsxs)(a,{children:[(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,e.jsx)(Ts,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"D·ªãch v·ª• c·∫£ng"})]}),(0,e.jsxs)(N,{direction:"row",spacing:1,flexWrap:"wrap",children:[c.portServices.pilotRequired&&(0,e.jsx)(y,{label:`Hoa ti√™u: ${c.portServices.pilotName||"Ch∆∞a ph√¢n c√¥ng"}`,size:"small",color:"info"}),c.portServices.tugboatCount>0&&(0,e.jsx)(y,{label:`${c.portServices.tugboatCount} T√†u lai d·∫Øt`,size:"small",variant:"outlined"}),c.portServices.mooringServices&&(0,e.jsx)(y,{label:"D·ªãch v·ª• neo ƒë·∫≠u",size:"small",variant:"outlined"})]})]}),c.cargoOperations.length>0&&(0,e.jsxs)(a,{children:[(0,e.jsxs)(N,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[(0,e.jsx)(Tt,{fontSize:"small",color:"action"}),(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Ho·∫°t ƒë·ªông h√†ng h√≥a"})]}),(0,e.jsx)(N,{spacing:1,children:c.cargoOperations.map(m=>(0,e.jsxs)(a,{sx:{p:1.5,bgcolor:"background.default",borderRadius:1,borderLeft:4,borderColor:m.status==="COMPLETED"?"success.main":m.status==="IN_PROGRESS"?"primary.main":"grey.300"},children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,e.jsx)(t,{variant:"body2",fontWeight:600,children:l(m.type)}),(0,e.jsx)(y,{label:u(m.status),size:"small",color:f(m.status)})]}),(0,e.jsxs)(N,{direction:"row",spacing:2,flexWrap:"wrap",children:[(0,e.jsxs)(t,{variant:"caption",children:["üì¶ ",m.containerCount," container"]}),(0,e.jsxs)(t,{variant:"caption",children:["üè∑Ô∏è ",m.cargoType]}),(0,e.jsxs)(t,{variant:"caption",children:["‚è∞ ",A(new Date(m.startTime),"HH:mm")," - ",A(new Date(m.endTime),"HH:mm")]})]})]},m.id))})]}),c.specialRequirements&&c.specialRequirements.length>0&&(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",children:"Y√™u c·∫ßu ƒë·∫∑c bi·ªát"}),(0,e.jsx)(a,{sx:{p:1.5,bgcolor:"warning.lighter",borderRadius:1,mt:.5},children:c.specialRequirements.map((m,h)=>(0,e.jsxs)(t,{variant:"body2",children:["‚Ä¢ ",m]},h))})]})]})]})},r.id)})})},Fs=({userRole:o,onAction:s,permissions:b})=>{const j=Re(),f=Se(j.breakpoints.down("md")),[u,g]=(0,T.useState)(!1),r=(()=>{switch(o){case"ADMIN":return[{icon:(0,e.jsx)(Xe,{}),name:"T·∫°o l·ªãch m·ªõi",action:"create",show:b.canCreate},{icon:(0,e.jsx)(Ce,{}),name:"L·ªçc",action:"filter",show:b.canFilter},{icon:(0,e.jsx)(js,{}),name:"Xu·∫•t d·ªØ li·ªáu",action:"export",show:b.canExport},{icon:(0,e.jsx)(Je,{}),name:"Analytics",action:"analytics",show:!0},{icon:(0,e.jsx)(Ae,{}),name:"L√†m m·ªõi",action:"refresh",show:!0}];case"MANAGER":return[{icon:(0,e.jsx)(Xe,{}),name:"T·∫°o l·ªãch m·ªõi",action:"create",show:b.canCreate},{icon:(0,e.jsx)(We,{}),name:"Ph√¢n c√¥ng",action:"assign",show:!0},{icon:(0,e.jsx)(Je,{}),name:"Th·ªëng k√™",action:"analytics",show:!0},{icon:(0,e.jsx)(Ce,{}),name:"L·ªçc",action:"filter",show:b.canFilter},{icon:(0,e.jsx)(Ae,{}),name:"L√†m m·ªõi",action:"refresh",show:!0}];case"OPERATIONS":return[{icon:(0,e.jsx)(Pe,{}),name:"B·∫Øt ƒë·∫ßu",action:"start",show:!0},{icon:(0,e.jsx)(de,{}),name:"Ho√†n th√†nh",action:"complete",show:!0},{icon:(0,e.jsx)(nt,{}),name:"B√°o c√°o",action:"report",show:!0},{icon:(0,e.jsx)(Ae,{}),name:"L√†m m·ªõi",action:"refresh",show:!0}];case"DRIVER":return[{icon:(0,e.jsx)(ls,{}),name:"Xem route",action:"viewRoute",show:!0},{icon:(0,e.jsx)(Pe,{}),name:"B·∫Øt ƒë·∫ßu",action:"start",show:!0},{icon:(0,e.jsx)(de,{}),name:"Ho√†n th√†nh",action:"complete",show:!0},{icon:(0,e.jsx)(nt,{}),name:"B√°o s·ª± c·ªë",action:"report",show:!0}];default:return[{icon:(0,e.jsx)(Ae,{}),name:"L√†m m·ªõi",action:"refresh",show:!0}]}})().filter(w=>w.show),c=w=>{g(!1),s(w)};return!f||r.length===0?null:(0,e.jsx)(ys,{ariaLabel:"Quick actions",sx:{position:"fixed",bottom:16,right:16,zIndex:1e3},icon:(0,e.jsx)(Cs,{}),onClose:()=>g(!1),onOpen:()=>g(!0),open:u,children:r.map(w=>(0,e.jsx)(Ns,{icon:w.icon,tooltipTitle:w.name,tooltipOpen:!0,onClick:()=>c(w.action)},w.action))})},Us=({schedules:o,onScheduleClick:s,height:b=600})=>{const j=(0,T.useRef)(null),f=(0,T.useRef)(null),[u,g]=(0,T.useState)("week"),[l,r]=(0,T.useState)(1),c={total:o.length,inProgress:o.filter(v=>v.status==="IN_PROGRESS").length,scheduled:o.filter(v=>v.status==="SCHEDULED").length,completed:o.filter(v=>v.status==="COMPLETED").length,ships:new Set(o.map(v=>v.shipVisit?.vesselName).filter(Boolean)).size};(0,T.useEffect)(()=>{if(!j.current||!f.current||o.length===0)return;const v=f.current,R=ye(j.current);R.selectAll("*").remove();const _={top:60,right:30,bottom:30,left:250},x=v.clientWidth-_.left-_.right,d=b-_.top-_.bottom,n=new Date;let i,E;switch(u){case"day":i=ds(n),E=Rs(n);break;case"week":i=Pt(n),E=zt(n);break;case"month":i=n,E=es(n,30);break}const S=I=>I<i?i:I>E?E:I,P=o.reduce((I,p)=>{let O="";if(p.shipVisit?.vesselName){const M=p.resources?.berthName||p.resources?.berthId||p.berthName||"";O=`üö¢ ${p.shipVisit.vesselName}${M?` - ${M}`:""}`}else if(p.shipVisitName){const M=p.berthName||"";O=`üö¢ ${p.shipVisitName}${M?` - ${M}`:""}`}else if(p.resources?.berthName||p.resources?.berthId||p.berthName)O=`‚öì B·∫øn ${p.resources?.berthName||p.resources?.berthId||p.berthName}`;else if(p.operation||p.name){const M=p.operation||p.name;M.toLowerCase().includes("container")||M.toLowerCase().includes("h√†ng")?O="üì¶ X·∫øp D·ª° H√†ng":M.toLowerCase().includes("meeting")||M.toLowerCase().includes("h·ªçp")||M.toLowerCase().includes("plan")?O="üë• H·ªçp & L·∫≠p K·∫ø Ho·∫°ch":M.toLowerCase().includes("ki·ªÉm tra")||M.toLowerCase().includes("inspection")||M.toLowerCase().includes("check")?O="üîç Ki·ªÉm Tra":M.toLowerCase().includes("pilot")||M.toLowerCase().includes("hoa ti√™u")?O="üö¶ Hoa Ti√™u & D·∫´n T√†u":M.toLowerCase().includes("berth")||M.toLowerCase().includes("dock")||M.toLowerCase().includes("b·∫øn")?O="‚öì Ho·∫°t ƒê·ªông B·∫øn":O=`üìã ${M.substring(0,30)}...`}else O="üìå C√¥ng Vi·ªác Kh√°c";return I[O]||(I[O]=[]),I[O].push(p),I},{}),k=Object.keys(P).sort(),V=Math.max(d,k.length*60+40),$=qe().domain([i,E]).range([0,x*l]),B=pt().domain(k).range([0,V]).padding(.2),F=R.attr("width",x+_.left+_.right).attr("height",V+_.top+_.bottom).append("g").attr("transform",`translate(${_.left},${_.top})`),q=u==="day"?Jt({start:i,end:E}):Xt({start:i,end:E});F.selectAll(".grid-line").data(q).enter().append("line").attr("class","grid-line").attr("x1",I=>$(I)).attr("x2",I=>$(I)).attr("y1",0).attr("y2",V).attr("stroke","#e0e0e0").attr("stroke-width",1).attr("stroke-dasharray","2,2");const he=ft($).ticks(u==="day"?Yt.every(2):jt.every(1)).tickFormat(I=>u==="day"?A(I,"HH:mm"):A(I,"MMM dd"));F.append("g").attr("class","x-axis").call(he).selectAll("text").style("text-anchor","middle").attr("dx","0").attr("dy","-5");const De=gt(B);F.append("g").attr("class","y-axis").call(De).selectAll("text").style("font-size","12px").style("font-weight","600").style("fill","#1976d2").each(function(I){const p=ye(this),O=I;O.length>40&&(p.text(O.substring(0,37)+"..."),p.append("title").text(O))}),F.selectAll(".group-line").data(k).enter().append("line").attr("class","group-line").attr("x1",0).attr("x2",x*l).attr("y1",I=>B(I)+B.bandwidth()).attr("y2",I=>B(I)+B.bandwidth()).attr("stroke","#e0e0e0").attr("stroke-width",1);const ue=Wt().domain(["PENDING","SCHEDULED","IN_PROGRESS","COMPLETED","CANCELLED"]).range(["#FFA726","#42A5F5","#66BB6A","#BDBDBD","#EF5350"]);if(k.forEach(I=>{P[I].forEach(p=>{const O=new Date(p.startTime),M=new Date(p.endTime);if(M<i||O>E)return;const Te=S(O),Ie=S(M);if(Ie<=Te)return;const J=$(Te),K=Math.max($(Ie)-J,3),ae=B(I),ee=B.bandwidth()*.85,te=F.append("g").attr("class","schedule-bar").style("cursor","pointer").on("click",()=>s?.(p));if(te.append("rect").attr("x",J+2).attr("y",ae+2).attr("width",K).attr("height",ee).attr("fill","#000").attr("opacity",.1).attr("rx",6),te.append("rect").attr("x",J).attr("y",ae).attr("width",K).attr("height",ee).attr("fill",ue(p.status)).attr("rx",6).attr("opacity",.85).attr("stroke","#fff").attr("stroke-width",1.5).on("mouseenter",function(){ye(this).attr("opacity",1).attr("stroke","#1976d2").attr("stroke-width",3)}).on("mouseleave",function(){ye(this).attr("opacity",.85).attr("stroke","#fff").attr("stroke-width",1.5)}),p.completionPercentage&&p.completionPercentage>0&&(te.append("rect").attr("x",J).attr("y",ae).attr("width",Math.max(K*(p.completionPercentage/100),3)).attr("height",ee).attr("fill","#000").attr("rx",6).attr("opacity",.25),K>80&&te.append("text").attr("x",J+K-8).attr("y",ae+ee-6).attr("text-anchor","end").text(`${p.completionPercentage}%`).style("font-size","9px").style("fill","#000").style("font-weight","bold").style("opacity",.9).style("pointer-events","none").style("text-shadow","0 0 2px rgba(255,255,255,0.8)")),p.priority&&p.priority>=8&&te.append("rect").attr("x",J).attr("y",ae).attr("width",4).attr("height",ee).attr("fill",p.priority>=9?"#D32F2F":"#F57C00").attr("rx",6).attr("opacity",1),K>120){const C=p.operation||p.name||"Schedule",U=Math.floor((K-20)/7);te.append("text").attr("x",J+10).attr("y",ae+ee/2-8).text(C.length>U?C.substring(0,U-3)+"...":C).style("font-size","12px").style("fill","#000").style("font-weight","700").style("pointer-events","none").style("text-shadow","0 0 3px rgba(255,255,255,0.8)");const me=`${A(O,"HH:mm")} - ${A(M,"HH:mm")}`;te.append("text").attr("x",J+10).attr("y",ae+ee/2+8).text(me).style("font-size","10px").style("fill","#000").style("font-weight","600").style("opacity",.8).style("pointer-events","none").style("text-shadow","0 0 2px rgba(255,255,255,0.8)")}else if(K>60){const C=p.operation||p.name||"Schedule",U=Math.floor((K-10)/6);te.append("text").attr("x",J+K/2).attr("y",ae+ee/2).attr("dy","0.35em").attr("text-anchor","middle").text(C.length>U?C.substring(0,U-2)+"...":C).style("font-size","11px").style("fill","#000").style("font-weight","700").style("pointer-events","none").style("text-shadow","0 0 3px rgba(255,255,255,0.9)")}else if(K>30){const C=(p.operation||p.name||"??").substring(0,3);te.append("text").attr("x",J+K/2).attr("y",ae+ee/2).attr("dy","0.35em").attr("text-anchor","middle").text(C).style("font-size","10px").style("fill","#000").style("font-weight","bold").style("pointer-events","none").style("text-shadow","0 0 2px rgba(255,255,255,1)")}const ze=[`üö¢ ${p.shipVisit?.vesselName||"N/A"}`,`üìã ${p.operation||"Schedule"}`,`üìä Status: ${p.status}`,p.priority?`‚≠ê Priority: ${p.priority}/10`:"",`üïê Start: ${A(O,"PPpp")}`,`üïê End: ${A(M,"PPpp")}`,p.completionPercentage?`‚úì Progress: ${p.completionPercentage}%`:"",p.resources?.berthName?`‚öì Berth: ${p.resources.berthName}`:"",p.resources?.cranes?.length?`üèóÔ∏è Cranes: ${p.resources.cranes.length}`:"",p.notes?`üìù ${p.notes}`:""].filter(Boolean);te.append("title").text(ze.join(`
`))})}),n>=i&&n<=E){const I=$(S(n));F.append("line").attr("class","current-time").attr("x1",I).attr("x2",I).attr("y1",0).attr("y2",V).attr("stroke","#f44336").attr("stroke-width",2).attr("stroke-dasharray","5,5"),F.append("text").attr("x",I).attr("y",-10).attr("text-anchor","middle").text("Now").style("fill","#f44336").style("font-size","12px").style("font-weight","bold")}},[o,u,l,b,s]);const w=()=>{r(v=>Math.min(v+.2,3))},m=()=>{r(v=>Math.max(v-.2,.5))},h=()=>{r(1)};return(0,e.jsxs)(xe,{sx:{p:2},children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,e.jsxs)(a,{children:[(0,e.jsx)(t,{variant:"h6",sx:{fontWeight:700,color:"#1976d2"},children:"üìä L·ªãch Tr√¨nh T·ªïng Quan (Gantt Chart)"}),(0,e.jsxs)(t,{variant:"caption",color:"text.secondary",children:[c.total," l·ªãch tr√¨nh ‚Ä¢ ",c.ships," t√†u ‚Ä¢ ",c.inProgress," ƒëang th·ª±c hi·ªán"]})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,e.jsxs)(Me,{value:u,exclusive:!0,onChange:(v,R)=>R&&g(R),size:"small",children:[(0,e.jsx)(X,{value:"day",children:(0,e.jsx)(L,{title:"Xem theo ng√†y",children:(0,e.jsx)(Ot,{})})}),(0,e.jsx)(X,{value:"week",children:(0,e.jsx)(L,{title:"Xem theo tu·∫ßn",children:(0,e.jsx)(Nt,{})})}),(0,e.jsx)(X,{value:"month",children:(0,e.jsx)(L,{title:"Xem theo th√°ng",children:(0,e.jsx)(wt,{})})})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:.5},children:[(0,e.jsx)(L,{title:"Ph√≥ng to",children:(0,e.jsx)(z,{size:"small",onClick:w,disabled:l>=3,children:(0,e.jsx)(vt,{})})}),(0,e.jsx)(L,{title:"Thu nh·ªè",children:(0,e.jsx)(z,{size:"small",onClick:m,disabled:l<=.5,children:(0,e.jsx)(Et,{})})}),(0,e.jsx)(L,{title:"V·ª´a m√†n h√¨nh",children:(0,e.jsx)(z,{size:"small",onClick:h,children:(0,e.jsx)(Dt,{})})})]}),(0,e.jsx)(y,{label:`${Math.round(l*100)}%`,size:"small",color:"primary"})]})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:2,mb:2,flexWrap:"wrap"},children:[(0,e.jsx)(y,{label:"‚è≥ Pending",size:"small",sx:{bgcolor:"#FFA726",color:"#fff",fontWeight:600}}),(0,e.jsx)(y,{label:"üìÖ Scheduled",size:"small",sx:{bgcolor:"#42A5F5",color:"#fff",fontWeight:600}}),(0,e.jsx)(y,{label:"‚ñ∂Ô∏è In Progress",size:"small",sx:{bgcolor:"#66BB6A",color:"#fff",fontWeight:600}}),(0,e.jsx)(y,{label:"‚úÖ Completed",size:"small",sx:{bgcolor:"#BDBDBD",color:"#fff",fontWeight:600}}),(0,e.jsx)(y,{label:"‚ùå Cancelled",size:"small",sx:{bgcolor:"#EF5350",color:"#fff",fontWeight:600}})]}),(0,e.jsx)(a,{ref:f,sx:{overflow:"auto",border:"2px solid #e3f2fd",borderRadius:2,bgcolor:"#fafafa",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.05)"},children:(0,e.jsx)("svg",{ref:j,style:{display:"block"}})}),o.length===0&&(0,e.jsxs)(a,{sx:{textAlign:"center",py:8},children:[(0,e.jsx)(t,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"üì≠ Kh√¥ng c√≥ l·ªãch tr√¨nh"}),(0,e.jsx)(t,{variant:"body2",color:"text.secondary",children:"Ch∆∞a c√≥ l·ªãch tr√¨nh n√†o ƒë·ªÉ hi·ªÉn th·ªã trong kho·∫£ng th·ªùi gian n√†y"})]})]})},qs=({schedules:o,startDate:s,endDate:b,height:j=400})=>{const f=(0,T.useRef)(null),u=(0,T.useRef)(null);return(0,T.useEffect)(()=>{if(!f.current||!u.current)return;const g=u.current,l=ye(f.current);l.selectAll("*").remove();const r={top:40,right:30,bottom:30,left:150},c=g.clientWidth-r.left-r.right,w=j-r.top-r.bottom,m=new Map;o.forEach(P=>{P.tasks?.forEach(k=>{k.assetId&&(m.has(k.assetId)||m.set(k.assetId,[]),m.get(k.assetId).push(k))})});const h=jt.range(s,b),v=Array.from(m.entries()).map(([P,k])=>({resourceId:P,resourceName:k[0]?.asset?.name||P,timePoints:h.map(V=>{const $=k.filter(F=>{const q=new Date(F.startTime),he=new Date(F.endTime);return q<=V&&he>=V}),B=$.length;return{time:V,utilization:B,tasks:$}})})),R=qe().domain([s,b]).range([0,c]),_=Ze(v,P=>Ze(P.timePoints,k=>k.utilization)),x=pt().domain(v.map(P=>P.resourceId)).range([0,w]).padding(.1),d=Zt().domain([0,_||1]).interpolator(Bt),n=l.attr("width",c+r.left+r.right).attr("height",j).append("g").attr("transform",`translate(${r.left},${r.top})`),i=ft(R).ticks(c/80).tickFormat(P=>A(P,"MMM d"));n.append("g").attr("class","x-axis").call(i).selectAll("text").style("text-anchor","middle");const E=gt(x).tickFormat(P=>v.find(k=>k.resourceId===P)?.resourceName||P);n.append("g").attr("class","y-axis").call(E).selectAll("text").style("font-size","12px"),v.forEach(P=>{P.timePoints.forEach((k,V)=>{if(V===P.timePoints.length-1)return;const $=R(k.time),B=R(P.timePoints[V+1].time)-$,F=x(P.resourceId),q=n.append("g").attr("class","utilization-cell").attr("transform",`translate(${$},${F})`);q.append("rect").attr("width",B).attr("height",x.bandwidth()).attr("fill",d(k.utilization)).attr("stroke","#fff").attr("stroke-width",1),k.utilization>0&&B>24&&q.append("text").attr("x",B/2).attr("y",x.bandwidth()/2).attr("dy","0.35em").attr("text-anchor","middle").style("fill",k.utilization>2?"#fff":"#000").style("font-size","11px").text(k.utilization);const he=`${P.resourceName}
Date: ${A(k.time,"PPP")}
Tasks: ${k.utilization}
${k.tasks.map(De=>`‚Ä¢ ${De.taskName||"Untitled Task"}`).join(`
`)}`;q.append("title").text(he)})});const S=new Date;if(S>=s&&S<=b){const P=R(S);n.append("line").attr("x1",P).attr("x2",P).attr("y1",0).attr("y2",w).attr("stroke","#f44336").attr("stroke-width",2).attr("stroke-dasharray","4,4")}},[o,s,b,j]),(0,e.jsxs)(xe,{sx:{p:2},children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"Resource Workload"}),(0,e.jsx)(a,{ref:u,children:(0,e.jsx)("svg",{ref:f})})]})},Ks=({schedules:o,height:s=600})=>{const b=(0,T.useRef)(null),j=(0,T.useRef)(null);return(0,T.useEffect)(()=>{if(!b.current||!j.current||!o.length)return;const f=j.current,u=ye(b.current);u.selectAll("*").remove();const g=[],l=[],r=new Map;o.forEach(n=>{g.push({id:n.id,label:n.operation||"Schedule",type:"schedule",status:n.status,data:n}),n.tasks?.forEach(i=>{if(g.push({id:i.id,label:i.taskName||"Task",type:"task",status:i.status,data:i}),l.push({source:n.id,target:i.id,type:"schedule"}),i.assetId&&!r.has(i.assetId)){const E={id:i.assetId,label:i.asset?.name||"Resource",type:"resource",status:"active",data:i.asset};g.push(E),r.set(i.assetId,E)}i.assetId&&l.push({source:i.id,target:i.assetId,type:"resource"}),i.dependencies?.forEach(E=>{l.push({source:E,target:i.id,type:"dependency"})})})});const c=f.clientWidth,w=qt(g).force("link",Kt(l).id(n=>n.id).distance(100)).force("charge",Gt().strength(-200)).force("center",Ft(c/2,s/2)).force("collision",$t().radius(40)),m=u.attr("width",c).attr("height",s).append("g"),h=Ut().scaleExtent([.1,4]).on("zoom",n=>{m.attr("transform",n.transform)});u.call(h),u.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#999");const v=m.append("g").selectAll("line").data(l).join("line").attr("stroke",n=>{switch(n.type){case"dependency":return"#f44336";case"resource":return"#2196f3";default:return"#999"}}).attr("stroke-width",1.5).attr("stroke-opacity",.6).attr("marker-end","url(#arrow)"),R=m.append("g").selectAll("g").data(g).join("g").attr("class","node").call(Qt().on("start",_).on("drag",x).on("end",d));R.append("circle").attr("r",n=>n.type==="schedule"?20:15).attr("fill",n=>{switch(n.type){case"schedule":return"#673ab7";case"task":return"#2196f3";case"resource":return"#4caf50";default:return"#999"}}).attr("stroke","#fff").attr("stroke-width",2),R.append("text").text(n=>n.label).attr("x",0).attr("y",30).attr("text-anchor","middle").style("font-size","10px").style("fill","#666"),R.append("title").text(n=>{switch(n.type){case"schedule":const i=n.data;return`Schedule: ${i.operation}
Status: ${i.status}
Start: ${A(new Date(i.startTime),"PPp")}
End: ${A(new Date(i.endTime),"PPp")}`;case"task":const E=n.data;return`Task: ${E.taskName}
Status: ${E.status}
Start: ${A(new Date(E.startTime),"PPp")}
End: ${A(new Date(E.endTime),"PPp")}`;default:return n.label}}),w.on("tick",()=>{v.attr("x1",n=>n.source.x).attr("y1",n=>n.source.y).attr("x2",n=>n.target.x).attr("y2",n=>n.target.y),R.attr("transform",n=>`translate(${n.x},${n.y})`)});function _(n){n.active||w.alphaTarget(.3).restart(),n.subject.fx=n.subject.x,n.subject.fy=n.subject.y}function x(n){n.subject.fx=n.x,n.subject.fy=n.y}function d(n){n.active||w.alphaTarget(0),n.subject.fx=null,n.subject.fy=null}return()=>{w.stop()}},[o,s]),(0,e.jsxs)(xe,{sx:{p:2},children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"Schedule Dependencies"}),(0,e.jsx)(a,{ref:j,children:(0,e.jsx)("svg",{ref:b})})]})};function _e(o){const{children:s,value:b,index:j,...f}=o;return(0,e.jsx)("div",{role:"tabpanel",hidden:b!==j,id:`schedule-tabpanel-${j}`,"aria-labelledby":`schedule-tab-${j}`,...f,children:b===j&&(0,e.jsx)(a,{sx:{py:3},children:s})})}const Qs=({open:o,schedule:s,onClose:b,onEdit:j,onDelete:f,onStart:u,onComplete:g,onCancel:l})=>{const[r,c]=(0,T.useState)(0);if((0,T.useEffect)(()=>{o&&c(0)},[o]),!s)return null;const w=(S,P)=>{c(P)},m=S=>{switch(S){case"PENDING":return"warning";case"SCHEDULED":return"primary";case"IN_PROGRESS":return"primary";case"COMPLETED":return"success";case"CANCELLED":return"error";default:return"default"}},h=S=>{switch(S){case"SHIP_ARRIVAL":return(0,e.jsx)(ie,{});case"MAINTENANCE":return(0,e.jsx)(Ve,{});case"PORT_OPERATION":return(0,e.jsx)(be,{});default:return(0,e.jsx)(ve,{})}},v=new Date(s.endTime).getTime()-new Date(s.startTime).getTime(),R=Math.floor(v/(1e3*60*60)),_=Math.floor(v%(1e3*60*60)/(1e3*60)),x=s.completionPercentage||0,d=new Date(s.endTime)<new Date,n=s.status==="IN_PROGRESS"||s.status==="SCHEDULED",i=s.resources?.cranes??[],E=s.resources?.personnel??[];return(0,e.jsxs)(xs,{open:o,onClose:b,maxWidth:"lg",fullWidth:!0,children:[(0,e.jsxs)(Is,{children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[h(s.type),(0,e.jsx)(t,{variant:"h6",children:s.operation||"Schedule Details"})]}),(0,e.jsxs)(a,{sx:{display:"flex",gap:1},children:[s.status==="PENDING"&&(0,e.jsx)(L,{title:"Start Schedule",children:(0,e.jsx)(z,{color:"success",onClick:()=>u(s),children:(0,e.jsx)(Pe,{})})}),s.status==="IN_PROGRESS"&&(0,e.jsx)(L,{title:"Complete Schedule",children:(0,e.jsx)(z,{color:"primary",onClick:()=>g(s),children:(0,e.jsx)(de,{})})}),n&&(0,e.jsx)(L,{title:"Cancel Schedule",children:(0,e.jsx)(z,{color:"error",onClick:()=>l(s),children:(0,e.jsx)(Ye,{})})}),(0,e.jsx)(L,{title:"Edit Schedule",children:(0,e.jsx)(z,{onClick:()=>j(s),children:(0,e.jsx)(At,{})})}),(0,e.jsx)(L,{title:"Delete Schedule",children:(0,e.jsx)(z,{color:"error",onClick:()=>f(s),children:(0,e.jsx)(Qe,{})})}),(0,e.jsx)(z,{onClick:b,children:(0,e.jsx)(kt,{})})]})]}),(0,e.jsxs)(a,{sx:{mt:1},children:[(0,e.jsx)(y,{label:s.status,color:m(s.status),size:"small"}),d&&s.status!=="COMPLETED"&&(0,e.jsx)(y,{label:"OVERDUE",color:"error",size:"small",sx:{ml:1}}),(s.priority??0)>5&&(0,e.jsx)(y,{label:"HIGH PRIORITY",color:"warning",size:"small",sx:{ml:1}})]})]}),(0,e.jsxs)(hs,{dividers:!0,children:[(0,e.jsx)(a,{sx:{borderBottom:1,borderColor:"divider"},children:(0,e.jsxs)(_t,{value:r,onChange:w,children:[(0,e.jsx)(we,{label:"Overview",icon:(0,e.jsx)(ve,{}),iconPosition:"start"}),(0,e.jsx)(we,{label:"Resources",icon:(0,e.jsx)(Ve,{}),iconPosition:"start"}),(0,e.jsx)(we,{label:"Tasks",icon:(0,e.jsx)(We,{}),iconPosition:"start"}),(0,e.jsx)(we,{label:"Timeline",icon:(0,e.jsx)($e,{}),iconPosition:"start"})]})}),(0,e.jsx)(_e,{value:r,index:0,children:(0,e.jsxs)(G,{container:!0,spacing:3,children:[(0,e.jsx)(G,{item:!0,xs:12,md:6,children:(0,e.jsx)(H,{variant:"outlined",children:(0,e.jsxs)(W,{children:[(0,e.jsxs)(t,{variant:"h6",gutterBottom:!0,children:[(0,e.jsx)(ve,{sx:{verticalAlign:"middle",mr:1}}),"Time Schedule"]}),(0,e.jsx)(ne,{sx:{my:2}}),(0,e.jsxs)(Ee,{dense:!0,children:[(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(Pe,{color:"success"})}),(0,e.jsx)(Y,{primary:"Start Time",secondary:A(new Date(s.startTime),"PPpp")})]}),(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(de,{color:"primary"})}),(0,e.jsx)(Y,{primary:"End Time",secondary:A(new Date(s.endTime),"PPpp")})]}),(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)($e,{})}),(0,e.jsx)(Y,{primary:"Duration",secondary:`${R}h ${_}m`})]}),s.actualStartTime&&(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(de,{color:"success"})}),(0,e.jsx)(Y,{primary:"Actual Start",secondary:A(new Date(s.actualStartTime),"PPpp")})]}),s.actualEndTime&&(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(de,{color:"success"})}),(0,e.jsx)(Y,{primary:"Actual End",secondary:A(new Date(s.actualEndTime),"PPpp")})]})]}),s.status==="IN_PROGRESS"&&(0,e.jsxs)(a,{sx:{mt:2},children:[(0,e.jsxs)(t,{variant:"body2",gutterBottom:!0,children:["Progress: ",x,"%"]}),(0,e.jsx)(Ne,{variant:"determinate",value:x,sx:{height:8,borderRadius:1}})]})]})})}),(0,e.jsx)(G,{item:!0,xs:12,md:6,children:(0,e.jsx)(H,{variant:"outlined",children:(0,e.jsxs)(W,{children:[(0,e.jsxs)(t,{variant:"h6",gutterBottom:!0,children:[(0,e.jsx)(ie,{sx:{verticalAlign:"middle",mr:1}}),"Allocation Details"]}),(0,e.jsx)(ne,{sx:{my:2}}),(0,e.jsxs)(Ee,{dense:!0,children:[s.shipVisit&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(ie,{color:"primary"})}),(0,e.jsx)(Y,{primary:"Ship Visit",secondary:s.shipVisit.vesselName||"N/A"})]}),(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(ie,{})}),(0,e.jsx)(Y,{primary:"IMO Number",secondary:s.shipVisit.vesselIMO||"N/A"})]}),(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(We,{})}),(0,e.jsx)(Y,{primary:"Voyage",secondary:s.shipVisit.voyageNumber||"N/A"})]})]}),s.resources?.berthId&&(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(be,{color:"primary"})}),(0,e.jsx)(Y,{primary:"Berth",secondary:s.resources?.berthName||s.resources.berthId})]}),s.resources?.pilotRequired&&(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(lt,{})}),(0,e.jsx)(Y,{primary:"Pilot",secondary:s.resources.pilotName||"Required"})]}),s.resources?.tugboatCount&&(0,e.jsxs)(Z,{children:[(0,e.jsx)(re,{children:(0,e.jsx)(ie,{})}),(0,e.jsx)(Y,{primary:"Tugboats",secondary:`${s.resources.tugboatCount} required`})]})]})]})})}),s.notes&&(0,e.jsx)(G,{item:!0,xs:12,children:(0,e.jsx)(H,{variant:"outlined",children:(0,e.jsxs)(W,{children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"Notes"}),(0,e.jsx)(ne,{sx:{my:2}}),(0,e.jsx)(t,{variant:"body2",color:"text.secondary",style:{whiteSpace:"pre-wrap"},children:s.notes})]})})}),s.status!=="COMPLETED"&&s.status!=="CANCELLED"&&(0,e.jsx)(G,{item:!0,xs:12,children:(0,e.jsx)(He,{severity:"info",icon:(0,e.jsx)(Rt,{}),children:(0,e.jsx)(t,{variant:"body2",children:"No conflicts detected for this schedule."})})})]})}),(0,e.jsxs)(_e,{value:r,index:1,children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"Allocated Resources"}),(0,e.jsxs)(G,{container:!0,spacing:2,children:[(0,e.jsx)(G,{item:!0,xs:12,md:6,children:(0,e.jsx)(H,{variant:"outlined",children:(0,e.jsxs)(W,{children:[(0,e.jsxs)(t,{variant:"subtitle1",gutterBottom:!0,children:[(0,e.jsx)(Ve,{sx:{verticalAlign:"middle",mr:1}}),"Cranes"]}),(0,e.jsx)(ne,{sx:{my:1}}),i.length>0?(0,e.jsx)(Ee,{dense:!0,children:i.map((S,P)=>(0,e.jsxs)(Z,{children:[(0,e.jsx)(Y,{primary:S.name||S.id,secondary:`Capacity: ${S.capacity||"N/A"}`}),(0,e.jsx)(y,{label:S.status||"Available",size:"small",color:"success"})]},P))}):(0,e.jsx)(t,{variant:"body2",color:"text.secondary",children:"No cranes allocated"})]})})}),(0,e.jsx)(G,{item:!0,xs:12,md:6,children:(0,e.jsx)(H,{variant:"outlined",children:(0,e.jsxs)(W,{children:[(0,e.jsxs)(t,{variant:"subtitle1",gutterBottom:!0,children:[(0,e.jsx)(lt,{sx:{verticalAlign:"middle",mr:1}}),"Personnel"]}),(0,e.jsx)(ne,{sx:{my:1}}),E.length>0?(0,e.jsx)(Ee,{dense:!0,children:E.map((S,P)=>(0,e.jsx)(Z,{children:(0,e.jsx)(Y,{primary:S.name,secondary:S.role})},P))}):(0,e.jsx)(t,{variant:"body2",color:"text.secondary",children:"No personnel assigned"})]})})})]})]}),(0,e.jsxs)(_e,{value:r,index:2,children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"Related Tasks"}),s.tasks&&s.tasks.length>0?(0,e.jsx)(Ee,{children:s.tasks.map(S=>(0,e.jsx)(H,{variant:"outlined",sx:{mb:2},children:(0,e.jsxs)(W,{children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,e.jsx)(t,{variant:"subtitle1",children:S.taskName}),(0,e.jsx)(y,{label:S.status,size:"small",color:m(S.status)})]}),(0,e.jsx)(t,{variant:"body2",color:"text.secondary",sx:{mt:1},children:S.taskType}),S.completionPercentage!==void 0&&(0,e.jsxs)(a,{sx:{mt:2},children:[(0,e.jsxs)(t,{variant:"caption",children:["Progress: ",S.completionPercentage,"%"]}),(0,e.jsx)(Ne,{variant:"determinate",value:S.completionPercentage,sx:{mt:.5}})]})]})},S.id))}):(0,e.jsx)(He,{severity:"info",children:"No tasks associated with this schedule"})]}),(0,e.jsxs)(_e,{value:r,index:3,children:[(0,e.jsx)(t,{variant:"h6",gutterBottom:!0,children:"Schedule Timeline"}),(0,e.jsx)(a,{sx:{mt:2},children:(0,e.jsx)(He,{severity:"info",children:"Timeline visualization will be implemented with Gantt chart integration"})})]})]}),(0,e.jsx)(ss,{children:(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",width:"100%",px:2},children:[(0,e.jsx)(a,{children:(0,e.jsxs)(t,{variant:"caption",color:"text.secondary",children:["Created: ",A(new Date(s.createdAt),"PPpp")]})}),(0,e.jsx)(oe,{onClick:b,variant:"outlined",children:"Close"})]})})]})};var Ys=[{value:"ALL",label:"All Types"},{value:"SHIP_ARRIVAL",label:"üö¢ Ship Arrival"},{value:"MAINTENANCE",label:"üîß Maintenance"},{value:"PORT_OPERATION",label:"‚öì Port Operation"}],Zs=[{value:"ALL",label:"All Statuses",color:"default"},{value:"PENDING",label:"Pending",color:"warning"},{value:"SCHEDULED",label:"Scheduled",color:"primary"},{value:"IN_PROGRESS",label:"In Progress",color:"info"},{value:"COMPLETED",label:"Completed",color:"success"},{value:"CANCELLED",label:"Cancelled",color:"error"}];const Xs=({open:o,onClose:s,filters:b,onApplyFilters:j,onResetFilters:f})=>{const[u,g]=(0,T.useState)(b),l=(h,v)=>{g(R=>({...R,[h]:v}))},r=(h,v)=>{g(R=>({...R,dateRange:{...R.dateRange,[h]:v}}))},c=()=>{j(u),s()},w=()=>{f(),g({search:"",type:"ALL",status:"ALL",dateRange:{start:null,end:null},berthId:null})},m=Object.values(u).filter(h=>typeof h=="string"?h!==""&&h!=="ALL":h&&typeof h=="object"&&"start"in h?h.start!==null||h.end!==null:h!==null).length;return(0,e.jsx)(rs,{anchor:"right",open:o,onClose:s,children:(0,e.jsxs)(a,{sx:{width:400,p:3},children:[(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(Ce,{color:"primary"}),(0,e.jsx)(t,{variant:"h6",children:"Advanced Filters"}),m>0&&(0,e.jsx)(y,{label:m,size:"small",color:"primary"})]}),(0,e.jsx)(z,{onClick:s,children:(0,e.jsx)(kt,{})})]}),(0,e.jsx)(ne,{sx:{mb:3}}),(0,e.jsx)(a,{sx:{mb:3},children:(0,e.jsx)(Ct,{fullWidth:!0,label:"Search Schedules",placeholder:"Search by name, ship, berth...",value:u.search,onChange:h=>l("search",h.target.value),InputProps:{startAdornment:(0,e.jsx)(Mt,{sx:{mr:1,color:"text.secondary"}})}})}),(0,e.jsxs)(pe,{defaultExpanded:!0,children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Schedule Type"})}),(0,e.jsx)(ge,{children:(0,e.jsx)(ns,{fullWidth:!0,children:(0,e.jsx)(ws,{value:u.type,onChange:h=>l("type",h.target.value),children:Ys.map(h=>(0,e.jsx)(fs,{value:h.value,children:h.label},h.value))})})})]}),(0,e.jsxs)(pe,{defaultExpanded:!0,children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Status"})}),(0,e.jsx)(ge,{children:(0,e.jsx)(N,{spacing:1,children:Zs.map(h=>(0,e.jsx)(y,{label:h.label,color:h.value===u.status?"primary":"default",onClick:()=>l("status",h.value),variant:h.value===u.status?"filled":"outlined",sx:{justifyContent:"flex-start"}},h.value))})})]}),(0,e.jsxs)(pe,{defaultExpanded:!0,children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Date Range"})}),(0,e.jsx)(ge,{children:(0,e.jsxs)(N,{spacing:2,children:[(0,e.jsx)(rt,{label:"Start Date",value:u.dateRange.start,onChange:h=>r("start",h),slotProps:{textField:{fullWidth:!0,size:"small"}}}),(0,e.jsx)(rt,{label:"End Date",value:u.dateRange.end,onChange:h=>r("end",h),slotProps:{textField:{fullWidth:!0,size:"small"}}}),(0,e.jsxs)(N,{direction:"row",spacing:1,children:[(0,e.jsx)(oe,{size:"small",variant:"outlined",fullWidth:!0,onClick:()=>{const h=new Date;r("start",h),r("end",new Date(h.getTime()+10080*60*1e3))},children:"Next 7 Days"}),(0,e.jsx)(oe,{size:"small",variant:"outlined",fullWidth:!0,onClick:()=>{const h=new Date;r("start",h),r("end",new Date(h.getTime()+720*60*60*1e3))},children:"Next 30 Days"})]})]})})]}),(0,e.jsxs)(pe,{children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Time of Day"})}),(0,e.jsx)(ge,{children:(0,e.jsxs)(Oe,{children:[(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Morning (06:00 - 12:00)"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Afternoon (12:00 - 18:00)"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Evening (18:00 - 00:00)"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Night (00:00 - 06:00)"})]})})]}),(0,e.jsxs)(pe,{children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Priority Level"})}),(0,e.jsx)(ge,{children:(0,e.jsxs)(a,{sx:{px:1},children:[(0,e.jsx)(t,{variant:"caption",color:"text.secondary",gutterBottom:!0,children:"Minimum Priority: 0"}),(0,e.jsx)(Ds,{defaultValue:0,min:0,max:10,marks:!0,valueLabelDisplay:"auto"})]})})]}),(0,e.jsxs)(pe,{children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Recurrence"})}),(0,e.jsx)(ge,{children:(0,e.jsxs)(Oe,{children:[(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"One-time only"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Daily recurring"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Weekly recurring"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Monthly recurring"})]})})]}),(0,e.jsxs)(pe,{children:[(0,e.jsx)(fe,{expandIcon:(0,e.jsx)(je,{}),children:(0,e.jsx)(t,{variant:"subtitle2",children:"Resource Requirements"})}),(0,e.jsx)(ge,{children:(0,e.jsxs)(Oe,{children:[(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Requires Pilot"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Requires Tugboat"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Requires Crane"}),(0,e.jsx)(se,{control:(0,e.jsx)(Q,{}),label:"Has Conflicts"})]})})]}),(0,e.jsxs)(a,{sx:{mt:4,display:"flex",gap:2},children:[(0,e.jsx)(oe,{fullWidth:!0,variant:"outlined",startIcon:(0,e.jsx)(bs,{}),onClick:w,children:"Reset All"}),(0,e.jsx)(oe,{fullWidth:!0,variant:"contained",startIcon:(0,e.jsx)(Ce,{}),onClick:c,children:"Apply Filters"})]})]})})};function rn(){const o=Ms(),s=Re(),{schedules:b,filters:j}=dt(C=>C.schedules),f=dt(_s)||"OPERATIONS",u=Array.isArray(b)?b:[],g=Se(s.breakpoints.down("sm")),l=Se(s.breakpoints.down("md")),r=Vt(f),c=zs(f),[w,m]=(0,T.useState)([]),[h,v]=(0,T.useState)(g?"list":r.defaultView.mode),[R,_]=(0,T.useState)("list"),[x,d]=(0,T.useState)(g?"day":r.defaultView.timelineMode||"week"),[n,i]=(0,T.useState)(r.defaultView.displayMode||"timeline"),[E,S]=(0,T.useState)(r.defaultView.groupBy||"resource"),[P,k]=(0,T.useState)(1),[V,$]=(0,T.useState)([new Date,new Date(Date.now()+10080*60*1e3)]),[B,F]=(0,T.useState)(!1),[q,he]=(0,T.useState)(null),[De,ue]=(0,T.useState)(!1),I=C=>{he(C),F(!0)},p=async C=>{await o(ks(C.id))},O=async C=>{await o(Ls(C.id))},M=async C=>{window.confirm("Are you sure you want to cancel this schedule?")&&await o(As(C.id))},Te=async C=>{window.confirm("Are you sure you want to delete this schedule?")&&await o(ot(C))},Ie=async()=>{if(window.confirm(`Are you sure you want to delete ${w.length} schedules?`)){for(const C of w)await o(ot(C));m([])}},J=(C,U)=>{m(U?[...w,C]:w.filter(me=>me!==C))},K=C=>{m(C?u.map(U=>U.id):[])},ae=C=>{if(v(C),C==="timeline"){d("week"),i("timeline"),S("resource"),k(1);const U=Pt(new Date),me=zt(new Date);$([U,me])}},ee=()=>{o(Le({status:"ALL",type:void 0,dateRange:{start:null,end:null}}))},te=C=>{o(Le({...C,dateRange:n==="timeline"?{start:V[0],end:V[1]}:C.dateRange})),ue(!1)},ze=C=>{switch(console.log("Quick action:",C),C){case"create":console.log("Create new schedule");break;case"filter":ue(!0);break;case"export":console.log("Export schedules");break;case"analytics":console.log("Show analytics");break;case"refresh":o(ct());break;case"assign":console.log("Assign resources");break;case"start":console.log("Start task");break;case"complete":console.log("Complete task");break;case"report":console.log("Report issue");break;case"viewRoute":console.log("View route");break;default:console.log("Unknown action:",C)}};return(0,T.useEffect)(()=>{o(ct())},[o,j,f]),(0,T.useEffect)(()=>{g&&h==="timeline"&&(v("list"),d("day"))},[g,h]),(0,e.jsxs)(ts,{maxWidth:!1,sx:{p:{xs:1,sm:2,md:3},height:"100%",display:"flex",flexDirection:"column"},children:[(0,e.jsxs)(a,{sx:{mb:{xs:2,md:3},display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:2},children:[(0,e.jsxs)(t,{variant:g?"h6":"h5",component:"h1",sx:{fontWeight:600},children:[f==="ADMIN"&&"Qu·∫£n l√Ω L·ªãch tr√¨nh To√†n b·ªô C·∫£ng",f==="MANAGER"&&"Qu·∫£n l√Ω L·ªãch tr√¨nh",f==="OPERATIONS"&&"L·ªãch tr√¨nh T√†u c·ªßa T√¥i",f==="DRIVER"&&"L·ªãch tr√¨nh L√†m vi·ªác"]}),!g&&c.canViewAll&&(0,e.jsxs)(Me,{value:h,exclusive:!0,onChange:(C,U)=>{U!==null&&ae(U)},"aria-label":"view mode",size:l?"small":"medium",children:[(0,e.jsxs)(X,{value:"list","aria-label":"list view",children:[(0,e.jsx)(Ke,{sx:{mr:{xs:0,sm:1}}}),!l&&"Danh s√°ch"]}),(0,e.jsxs)(X,{value:"timeline","aria-label":"timeline view",children:[(0,e.jsx)($e,{sx:{mr:{xs:0,sm:1}}}),!l&&"Timeline"]})]})]}),(0,e.jsxs)(xe,{elevation:g?0:1,sx:{mt:2,flex:1,display:"flex",flexDirection:"column",overflow:"hidden",borderRadius:{xs:0,sm:1}},children:[h==="list"&&(0,e.jsxs)(a,{sx:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,e.jsx)(Vs,{viewMode:R,onViewModeChange:_,selectedCount:w.length,onDeleteSelected:Ie,onExport:c.canExport?()=>{}:()=>{},onFilterClick:c.canFilter?()=>ue(!0):()=>{},onSearchChange:C=>{if(C)o(Le({...j,searchTerm:C}));else{const{searchTerm:U,...me}=j;o(Le(me))}},activeFilters:{status:j.status!=="ALL"?[j.status]:void 0,type:j.type?[j.type]:void 0,dateRange:j.dateRange?[j.dateRange.start?new Date(j.dateRange.start):null,j.dateRange.end?new Date(j.dateRange.end):null]:void 0},onClearFilter:ee}),(0,e.jsx)(a,{sx:{mt:2,flex:1,overflow:"auto",px:{xs:0,sm:2}},children:f==="ADMIN"&&h==="list"?(0,e.jsx)(Gs,{schedules:u,onScheduleClick:I,onFilterChange:C=>{console.log("Filter by entity:",C)}}):f==="DRIVER"?(0,e.jsx)($s,{schedules:u,onScheduleClick:I}):f==="OPERATIONS"||f==="MANAGER"?(0,e.jsx)(Bs,{schedules:u,onScheduleClick:I}):(0,e.jsx)(Ws,{schedules:u,selectedIds:w,onSelect:J,onSelectAll:K,onEditSchedule:c.canEdit?()=>{}:()=>{},onDeleteSchedule:c.canDelete?Te:()=>{},onStartSchedule:p,onCompleteSchedule:O,onCancelSchedule:M})})]}),h==="timeline"&&(0,e.jsxs)(a,{sx:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,e.jsx)(Os,{viewMode:x,onViewModeChange:d,groupBy:E,onGroupByChange:S,displayMode:n,onDisplayModeChange:i,zoom:P,onZoomChange:k,onFilterClick:()=>ue(!0),dateRange:V}),(0,e.jsxs)(a,{sx:{mt:2,flex:1,overflow:"auto",position:"relative"},children:[n==="timeline"&&(0,e.jsx)(Us,{schedules:u,onScheduleClick:I,height:600}),n==="schedule"&&(0,e.jsx)(qs,{schedules:u,startDate:V[0],endDate:V[1]}),n==="dependencies"&&(0,e.jsx)(Ks,{schedules:u})]})]})]}),q&&(0,e.jsx)(Qs,{open:B,schedule:q,onClose:()=>F(!1),onEdit:c.canEdit?()=>{}:()=>{},onDelete:c.canDelete?()=>Te(q.id):()=>{},onStart:()=>p(q),onComplete:()=>O(q),onCancel:()=>M(q)}),c.canFilter&&(0,e.jsx)(Xs,{open:De,onClose:()=>ue(!1),filters:j,onApplyFilters:te,onResetFilters:ee}),(0,e.jsx)(Fs,{userRole:f,onAction:ze,permissions:{canCreate:c.canCreate,canExport:c.canExport,canFilter:c.canFilter}})]})}export{rn as default};
