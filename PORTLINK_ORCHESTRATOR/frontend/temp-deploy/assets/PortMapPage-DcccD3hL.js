import{r as F}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as et,T as nt,d as it,f as T,n as at,r as $,t as st,ut as rt}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import{$r as c,F as ot,Fr as ct,Gn as v,Hr as G,It as dt,P as lt,Ur as U,Vr as P,Wn as ht,Zr as V,ai as r,an as pt,cr as B,dr as E,fi as W,ft as ut,ir as xt,ri as N,rt as mt,si as L,vi as yt,yn as gt,zr as M}from"./vendor-mui-B1q6pdKu.js";var u=F(et()),t=F(yt()),St=({portLayout:d,showHeatmap:S=!1,onBerthClick:w,onShipClick:j,onCraneClick:I})=>{const g=(0,u.useRef)(null),h=(0,u.useRef)(null),[p,y]=(0,u.useState)({width:0,height:0}),[C,m]=(0,u.useState)(["berths","ships","cranes","zones"]),s=(0,u.useRef)(null),n=(0,u.useRef)(null),z={AVAILABLE:"#4caf50",OCCUPIED:"#2196f3",RESERVED:"#ff9800",MAINTENANCE:"#f44336"},R={AVAILABLE:"#4caf50",IN_USE:"#2196f3",MAINTENANCE:"#ff9800",OUT_OF_SERVICE:"#f44336"};(0,u.useEffect)(()=>{const o=()=>{if(h.current){const{width:l,height:i}=h.current.getBoundingClientRect();y({width:l,height:i})}};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),(0,u.useEffect)(()=>{if(!g.current||p.width===0)return;const o=T(g.current);o.selectAll("*").remove();const l=p.width/d.dimensions.width,i=p.height/d.dimensions.height,e=Math.min(l,i)*.9,a=o.append("g").attr("class","port-layout-group"),A=at().scaleExtent([.5,5]).on("zoom",tt=>{a.attr("transform",tt.transform.toString())});o.call(A),s.current=A;const H=$.translate((p.width-d.dimensions.width*e)/2,(p.height-d.dimensions.height*e)/2).scale(e);n.current=H,o.call(A.transform,H),a.append("rect").attr("x",0).attr("y",0).attr("width",d.dimensions.width).attr("height",d.dimensions.height).attr("fill","#b3d9ff").attr("opacity",.3),C.includes("zones")&&k(a,d.zones),S&&C.includes("zones")&&O(a,d.zones),x(a),C.includes("berths")&&b(a,d.berths),C.includes("ships")&&f(a,d.ships),C.includes("cranes")&&Z(a,d.cranes),X(a),o.node().__zoom=A},[d,p,S,C]);const k=(o,l)=>{const i=o.append("g").attr("class","zones");l.forEach(e=>{const a=i.append("g").attr("class",`zone zone-${e.id}`);a.append("rect").attr("x",e.bounds.x).attr("y",e.bounds.y).attr("width",e.bounds.width).attr("height",e.bounds.height).attr("fill","#e0e0e0").attr("opacity",.2).attr("stroke","#9e9e9e").attr("stroke-width",2).attr("stroke-dasharray","5,5"),a.append("text").attr("x",e.bounds.x+e.bounds.width/2).attr("y",e.bounds.y+20).attr("text-anchor","middle").attr("font-size",14).attr("font-weight","bold").attr("fill","#616161").text(e.name),a.append("text").attr("x",e.bounds.x+e.bounds.width/2).attr("y",e.bounds.y+40).attr("text-anchor","middle").attr("font-size",12).attr("fill","#757575").text(`${e.utilization}% s·ª≠ d·ª•ng`)})},O=(o,l)=>{const i=o.append("g").attr("class","heatmap"),e=nt().domain([0,50,100]).range(["#4caf50","#ff9800","#f44336"]);l.forEach(a=>{i.append("rect").attr("x",a.bounds.x).attr("y",a.bounds.y).attr("width",a.bounds.width).attr("height",a.bounds.height).attr("fill",e(a.utilization)).attr("opacity",.3)})},x=o=>{const l=o.append("g").attr("class","water-areas");d.waterAreas.forEach(i=>{const e=rt().x(a=>a.x).y(a=>a.y);l.append("path").attr("d",e(i.path)||"").attr("fill",i.type==="CHANNEL"?"none":"#1976d2").attr("stroke","#1976d2").attr("stroke-width",i.type==="CHANNEL"?4:2).attr("stroke-dasharray",i.type==="CHANNEL"?"10,5":"none").attr("opacity",.5)})},b=(o,l)=>{const i=o.append("g").attr("class","berths");l.forEach(e=>{const a=i.append("g").attr("class",`berth berth-${e.id}`);a.append("rect").attr("x",e.position.x).attr("y",e.position.y).attr("width",e.dimensions.width).attr("height",e.dimensions.height).attr("fill",z[e.status]).attr("opacity",.7).attr("stroke","#333").attr("stroke-width",2).attr("rx",5).style("cursor","pointer").on("click",()=>w?.(e)).on("mouseenter",function(){T(this).attr("opacity",1).attr("stroke-width",3),_(e,"berth")}).on("mouseleave",function(){T(this).attr("opacity",.7).attr("stroke-width",2),D()}),a.append("text").attr("x",e.position.x+e.dimensions.width/2).attr("y",e.position.y+e.dimensions.height/2-5).attr("text-anchor","middle").attr("font-size",14).attr("font-weight","bold").attr("fill","#fff").text(e.code),a.append("text").attr("x",e.position.x+e.dimensions.width/2).attr("y",e.position.y+e.dimensions.height/2+10).attr("text-anchor","middle").attr("font-size",10).attr("fill","#fff").text(e.name),e.utilization>0&&(a.append("rect").attr("x",e.position.x).attr("y",e.position.y+e.dimensions.height+5).attr("width",e.dimensions.width).attr("height",8).attr("fill","#e0e0e0").attr("rx",4),a.append("rect").attr("x",e.position.x).attr("y",e.position.y+e.dimensions.height+5).attr("width",e.dimensions.width*e.utilization/100).attr("height",8).attr("fill","#ffc107").attr("rx",4),a.append("text").attr("x",e.position.x+e.dimensions.width/2).attr("y",e.position.y+e.dimensions.height+22).attr("text-anchor","middle").attr("font-size",9).attr("fill","#333").text(`${e.utilization}%`))})},f=(o,l)=>{const i=o.append("g").attr("class","ships");l.forEach(e=>{const a=i.append("g").attr("class",`ship ship-${e.id}`),A=`
        M ${e.position.x-e.length/12} ${e.position.y}
        L ${e.position.x+e.length/12} ${e.position.y-e.width/4}
        L ${e.position.x+e.length/12} ${e.position.y+e.width/4}
        Z
      `;a.append("path").attr("d",A).attr("fill","#1a237e").attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer").on("click",()=>j?.(e)).on("mouseenter",function(){T(this).attr("fill","#283593"),_(e,"ship")}).on("mouseleave",function(){T(this).attr("fill","#1a237e"),D()}),a.append("text").attr("x",e.position.x).attr("y",e.position.y-e.width/2-5).attr("text-anchor","middle").attr("font-size",10).attr("font-weight","bold").attr("fill","#1a237e").attr("stroke","#fff").attr("stroke-width",.5).text(e.name)})},Z=(o,l)=>{const i=o.append("g").attr("class","cranes");l.forEach(e=>{const a=i.append("g").attr("class",`crane crane-${e.id}`);a.append("circle").attr("cx",e.position.x).attr("cy",e.position.y).attr("r",12).attr("fill",R[e.status]).attr("stroke","#333").attr("stroke-width",2).style("cursor","pointer").on("click",()=>I?.(e)).on("mouseenter",function(){T(this).attr("r",15),_(e,"crane")}).on("mouseleave",function(){T(this).attr("r",12),D()}),a.append("line").attr("x1",e.position.x).attr("y1",e.position.y).attr("x2",e.position.x).attr("y2",e.position.y-30).attr("stroke","#333").attr("stroke-width",3),a.append("text").attr("x",e.position.x).attr("y",e.position.y+25).attr("text-anchor","middle").attr("font-size",9).attr("font-weight","bold").attr("fill","#333").text(e.code)})},X=o=>{const l=o.append("g").attr("class","landmarks");d.landmarks.forEach(i=>{const e=l.append("g").attr("class",`landmark landmark-${i.id}`);i.dimensions&&(e.append("rect").attr("x",i.position.x).attr("y",i.position.y).attr("width",i.dimensions.width).attr("height",i.dimensions.height).attr("fill","#757575").attr("opacity",.5).attr("stroke","#424242").attr("stroke-width",1),e.append("text").attr("x",i.position.x+i.dimensions.width/2).attr("y",i.position.y+i.dimensions.height/2).attr("text-anchor","middle").attr("font-size",10).attr("fill","#fff").text(i.name))})},_=(o,l)=>{const i=T("body").append("div").attr("class","port-map-tooltip").style("position","absolute").style("background","#333").style("color","#fff").style("padding","8px 12px").style("border-radius","4px").style("font-size","12px").style("pointer-events","none").style("z-index",1e4);if(l==="berth"){const e=o;i.html(`
        <strong>${e.name}</strong><br/>
        M√£: ${e.code}<br/>
        Tr·∫°ng th√°i: ${e.status}<br/>
        ${e.currentShip?`T√†u: ${e.currentShip.name}`:"Tr·ªëng"}
      `)}else if(l==="ship"){const e=o;i.html(`
        <strong>${e.name}</strong><br/>
        Lo·∫°i: ${e.type}<br/>
        K√≠ch th∆∞·ªõc: ${e.length}m x ${e.width}m<br/>
        Tr·∫°ng th√°i: ${e.status}
      `)}else if(l==="crane"){const e=o;i.html(`
        <strong>${e.name}</strong><br/>
        M√£: ${e.code}<br/>
        Lo·∫°i: ${e.type}<br/>
        Tr·∫°ng th√°i: ${e.status}
      `)}T("body").on("mousemove",e=>{i.style("left",`${e.pageX+10}px`).style("top",`${e.pageY+10}px`)})},D=()=>{it(".port-map-tooltip").remove(),T("body").on("mousemove",null)},Y=()=>{g.current&&s.current&&T(g.current).transition().duration(300).call(s.current.scaleBy,1.3)},q=()=>{g.current&&s.current&&T(g.current).transition().duration(300).call(s.current.scaleBy,.7)},Q=()=>{if(g.current&&s.current){const o=T(g.current);if(!n.current){const l=p.width/d.dimensions.width,i=p.height/d.dimensions.height,e=Math.min(l,i)*.9;n.current=$.translate((p.width-d.dimensions.width*e)/2,(p.height-d.dimensions.height*e)/2).scale(e)}o.transition().duration(500).call(s.current.transform,n.current)}},J=(o,l)=>{m(l)};return(0,t.jsxs)(W,{sx:{position:"relative",height:"100%",overflow:"hidden"},children:[(0,t.jsx)(c,{sx:{position:"absolute",top:16,right:16,zIndex:1e3},children:(0,t.jsxs)(c,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,t.jsx)(E,{title:"Ph√≥ng to",children:(0,t.jsx)(L,{onClick:Y,sx:{bgcolor:"background.paper"},children:(0,t.jsx)(ot,{})})}),(0,t.jsx)(E,{title:"Thu nh·ªè",children:(0,t.jsx)(L,{onClick:q,sx:{bgcolor:"background.paper"},children:(0,t.jsx)(lt,{})})}),(0,t.jsx)(E,{title:"ƒê·∫∑t l·∫°i zoom",children:(0,t.jsx)(L,{onClick:Q,sx:{bgcolor:"background.paper"},children:(0,t.jsx)(gt,{})})})]})}),(0,t.jsx)(c,{sx:{position:"absolute",top:16,left:16,zIndex:1e3},children:(0,t.jsx)(W,{sx:{p:1},children:(0,t.jsxs)(ht,{value:C,onChange:J,"aria-label":"layer controls",size:"small",orientation:"vertical",children:[(0,t.jsx)(v,{value:"zones","aria-label":"zones",children:(0,t.jsx)(E,{title:"Hi·ªán khu v·ª±c",children:(0,t.jsx)(dt,{fontSize:"small"})})}),(0,t.jsx)(v,{value:"berths","aria-label":"berths",children:(0,t.jsx)(E,{title:"Hi·ªán b·∫øn t√†u",children:(0,t.jsx)(c,{sx:{fontSize:10,fontWeight:"bold"},children:"B"})})}),(0,t.jsx)(v,{value:"ships","aria-label":"ships",children:(0,t.jsx)(E,{title:"Hi·ªán t√†u",children:(0,t.jsx)(c,{sx:{fontSize:10,fontWeight:"bold"},children:"S"})})}),(0,t.jsx)(v,{value:"cranes","aria-label":"cranes",children:(0,t.jsx)(E,{title:"Hi·ªán c·∫©u",children:(0,t.jsx)(c,{sx:{fontSize:10,fontWeight:"bold"},children:"C"})})})]})})}),(0,t.jsx)(c,{ref:h,sx:{width:"100%",height:"100%"},children:(0,t.jsx)("svg",{ref:g,width:p.width,height:p.height,style:{display:"block"}})})]})},Ct=St;const K={id:"catlai-port",name:"C·∫£ng C√°t L√°i - TP.HCM",dimensions:{width:3e3,height:1600},berths:[{id:"berth-ct1",code:"CT1",name:"B·∫øn Container 1",position:{x:200,y:400},dimensions:{width:280,height:60},status:"OCCUPIED",type:"CONTAINER",maxDraft:14.5,maxLength:366,currentShip:{id:"ship-1",name:"COSCO SHIPPING VIRGO",arrivalTime:new Date("2025-11-03T06:00:00"),departureTime:new Date("2025-11-04T22:00:00")},utilization:90,zone:"zone-container-a"},{id:"berth-ct2",code:"CT2",name:"B·∫øn Container 2",position:{x:200,y:480},dimensions:{width:280,height:60},status:"OCCUPIED",type:"CONTAINER",maxDraft:14.5,maxLength:366,currentShip:{id:"ship-2",name:"MSC OSCAR",arrivalTime:new Date("2025-11-02T14:00:00"),departureTime:new Date("2025-11-05T08:00:00")},utilization:85,zone:"zone-container-a"},{id:"berth-ct3",code:"CT3",name:"B·∫øn Container 3",position:{x:200,y:560},dimensions:{width:280,height:60},status:"AVAILABLE",type:"CONTAINER",maxDraft:14.5,maxLength:366,utilization:0,zone:"zone-container-a"},{id:"berth-ct4",code:"CT4",name:"B·∫øn Container 4",position:{x:600,y:400},dimensions:{width:280,height:60},status:"OCCUPIED",type:"CONTAINER",maxDraft:14.5,maxLength:366,currentShip:{id:"ship-3",name:"EVER GOLDEN",arrivalTime:new Date("2025-11-03T10:00:00")},utilization:75,zone:"zone-container-b"},{id:"berth-ct5",code:"CT5",name:"B·∫øn Container 5",position:{x:600,y:480},dimensions:{width:280,height:60},status:"RESERVED",type:"CONTAINER",maxDraft:14.5,maxLength:366,utilization:0,zone:"zone-container-b"},{id:"berth-ct6",code:"CT6",name:"B·∫øn Container 6",position:{x:600,y:560},dimensions:{width:280,height:60},status:"OCCUPIED",type:"CONTAINER",maxDraft:14.5,maxLength:366,currentShip:{id:"ship-4",name:"MAERSK EINDHOVEN",arrivalTime:new Date("2025-11-01T08:00:00"),departureTime:new Date("2025-11-03T18:00:00")},utilization:95,zone:"zone-container-b"},{id:"berth-ct7",code:"CT7",name:"B·∫øn Container 7",position:{x:1e3,y:400},dimensions:{width:280,height:60},status:"AVAILABLE",type:"CONTAINER",maxDraft:14.5,maxLength:366,utilization:0,zone:"zone-container-c"},{id:"berth-ct8",code:"CT8",name:"B·∫øn Container 8",position:{x:1e3,y:480},dimensions:{width:280,height:60},status:"OCCUPIED",type:"CONTAINER",maxDraft:14.5,maxLength:366,currentShip:{id:"ship-5",name:"ONE COMMITMENT",arrivalTime:new Date("2025-11-03T12:00:00")},utilization:70,zone:"zone-container-c"},{id:"berth-ct9",code:"CT9",name:"B·∫øn Container 9",position:{x:1e3,y:560},dimensions:{width:280,height:60},status:"MAINTENANCE",type:"CONTAINER",maxDraft:14.5,maxLength:366,utilization:0,zone:"zone-container-c"},{id:"berth-barge1",code:"BG1",name:"B·∫øn S√† Lan",position:{x:1500,y:400},dimensions:{width:150,height:50},status:"OCCUPIED",type:"GENERAL",maxDraft:8,maxLength:120,currentShip:{id:"ship-barge1",name:"S√Ä LAN ƒê·ªíNG NAI 01",arrivalTime:new Date("2025-11-03T07:00:00")},utilization:60,zone:"zone-barge"}],cranes:[{id:"crane-ct1-1",code:"STS-01",name:"C·∫©u B·ªù CT1-1",position:{x:240,y:380},berthId:"berth-ct1",status:"IN_USE",type:"STS",capacity:65,currentTask:{id:"task-1",description:"D·ª° container COSCO SHIPPING VIRGO",startTime:new Date("2025-11-03T07:00:00")}},{id:"crane-ct1-2",code:"STS-02",name:"C·∫©u B·ªù CT1-2",position:{x:340,y:380},berthId:"berth-ct1",status:"IN_USE",type:"STS",capacity:65,currentTask:{id:"task-2",description:"D·ª° container COSCO SHIPPING VIRGO",startTime:new Date("2025-11-03T07:30:00")}},{id:"crane-ct1-3",code:"STS-03",name:"C·∫©u B·ªù CT1-3",position:{x:440,y:380},berthId:"berth-ct1",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct2-1",code:"STS-04",name:"C·∫©u B·ªù CT2-1",position:{x:240,y:460},berthId:"berth-ct2",status:"IN_USE",type:"STS",capacity:65,currentTask:{id:"task-3",description:"X·∫øp container MSC OSCAR",startTime:new Date("2025-11-03T08:00:00")}},{id:"crane-ct2-2",code:"STS-05",name:"C·∫©u B·ªù CT2-2",position:{x:340,y:460},berthId:"berth-ct2",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct2-3",code:"STS-06",name:"C·∫©u B·ªù CT2-3",position:{x:440,y:460},berthId:"berth-ct2",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct3-1",code:"STS-07",name:"C·∫©u B·ªù CT3-1",position:{x:240,y:540},berthId:"berth-ct3",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct3-2",code:"STS-08",name:"C·∫©u B·ªù CT3-2",position:{x:340,y:540},berthId:"berth-ct3",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct3-3",code:"STS-09",name:"C·∫©u B·ªù CT3-3",position:{x:440,y:540},berthId:"berth-ct3",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct4-1",code:"STS-10",name:"C·∫©u B·ªù CT4-1",position:{x:640,y:380},berthId:"berth-ct4",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct4-2",code:"STS-11",name:"C·∫©u B·ªù CT4-2",position:{x:740,y:380},berthId:"berth-ct4",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct4-3",code:"STS-12",name:"C·∫©u B·ªù CT4-3",position:{x:840,y:380},berthId:"berth-ct4",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct5-1",code:"STS-13",name:"C·∫©u B·ªù CT5-1",position:{x:640,y:460},berthId:"berth-ct5",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct5-2",code:"STS-14",name:"C·∫©u B·ªù CT5-2",position:{x:740,y:460},berthId:"berth-ct5",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct5-3",code:"STS-15",name:"C·∫©u B·ªù CT5-3",position:{x:840,y:460},berthId:"berth-ct5",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct6-1",code:"STS-16",name:"C·∫©u B·ªù CT6-1",position:{x:640,y:540},berthId:"berth-ct6",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct6-2",code:"STS-17",name:"C·∫©u B·ªù CT6-2",position:{x:740,y:540},berthId:"berth-ct6",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct6-3",code:"STS-18",name:"C·∫©u B·ªù CT6-3",position:{x:840,y:540},berthId:"berth-ct6",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct7-1",code:"STS-19",name:"C·∫©u B·ªù CT7-1",position:{x:1080,y:380},berthId:"berth-ct7",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct7-2",code:"STS-20",name:"C·∫©u B·ªù CT7-2",position:{x:1180,y:380},berthId:"berth-ct7",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct8-1",code:"STS-21",name:"C·∫©u B·ªù CT8-1",position:{x:1040,y:460},berthId:"berth-ct8",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct8-2",code:"STS-22",name:"C·∫©u B·ªù CT8-2",position:{x:1140,y:460},berthId:"berth-ct8",status:"IN_USE",type:"STS",capacity:65},{id:"crane-ct8-3",code:"STS-23",name:"C·∫©u B·ªù CT8-3",position:{x:1240,y:460},berthId:"berth-ct8",status:"AVAILABLE",type:"STS",capacity:65},{id:"crane-ct9-1",code:"STS-24",name:"C·∫©u B·ªù CT9-1",position:{x:1040,y:540},berthId:"berth-ct9",status:"MAINTENANCE",type:"STS",capacity:65},{id:"crane-ct9-2",code:"STS-25",name:"C·∫©u B·ªù CT9-2",position:{x:1140,y:540},berthId:"berth-ct9",status:"MAINTENANCE",type:"STS",capacity:65},{id:"crane-ct9-3",code:"STS-26",name:"C·∫©u B·ªù CT9-3",position:{x:1240,y:540},berthId:"berth-ct9",status:"MAINTENANCE",type:"STS",capacity:65}],ships:[{id:"ship-1",name:"COSCO SHIPPING VIRGO",type:"CONTAINER",position:{x:340,y:430},berthId:"berth-ct1",status:"IN_PROGRESS",length:366,width:51,draft:14,eta:new Date("2025-11-03T06:00:00"),etd:new Date("2025-11-04T22:00:00")},{id:"ship-2",name:"MSC OSCAR",type:"CONTAINER",position:{x:340,y:510},berthId:"berth-ct2",status:"IN_PROGRESS",length:366,width:51,draft:14,eta:new Date("2025-11-02T14:00:00"),etd:new Date("2025-11-05T08:00:00")},{id:"ship-3",name:"EVER GOLDEN",type:"CONTAINER",position:{x:740,y:430},berthId:"berth-ct4",status:"IN_PROGRESS",length:334,width:48,draft:13.5,eta:new Date("2025-11-03T10:00:00"),etd:new Date("2025-11-04T16:00:00")},{id:"ship-4",name:"MAERSK EINDHOVEN",type:"CONTAINER",position:{x:740,y:590},berthId:"berth-ct6",status:"IN_PROGRESS",length:347,width:48,draft:14,eta:new Date("2025-11-01T08:00:00"),etd:new Date("2025-11-03T18:00:00")},{id:"ship-5",name:"ONE COMMITMENT",type:"CONTAINER",position:{x:1140,y:510},berthId:"berth-ct8",status:"IN_PROGRESS",length:300,width:43,draft:13,eta:new Date("2025-11-03T12:00:00"),etd:new Date("2025-11-04T20:00:00")},{id:"ship-barge1",name:"S√Ä LAN ƒê·ªíNG NAI 01",type:"GENERAL_CARGO",position:{x:1575,y:425},berthId:"berth-barge1",status:"IN_PROGRESS",length:80,width:15,draft:5,eta:new Date("2025-11-03T07:00:00"),etd:new Date("2025-11-03T17:00:00")}],zones:[{id:"zone-container-a",name:"Khu Container Terminal A",type:"CONTAINER_TERMINAL",bounds:{x:150,y:350,width:380,height:300},utilization:85,capacity:5e4,currentLoad:42500},{id:"zone-container-b",name:"Khu Container Terminal B",type:"CONTAINER_TERMINAL",bounds:{x:550,y:350,width:380,height:300},utilization:78,capacity:5e4,currentLoad:39e3},{id:"zone-container-c",name:"Khu Container Terminal C",type:"CONTAINER_TERMINAL",bounds:{x:950,y:350,width:380,height:300},utilization:65,capacity:5e4,currentLoad:32500},{id:"zone-barge",name:"Khu B·∫øn S√† Lan",type:"CONTAINER_TERMINAL",bounds:{x:1450,y:350,width:250,height:150},utilization:60,capacity:5e3,currentLoad:3e3},{id:"zone-warehouse",name:"Khu Kho H√†ng",type:"WAREHOUSE",bounds:{x:150,y:700,width:600,height:200},utilization:70,capacity:1e5,currentLoad:7e4},{id:"zone-rice",name:"Khu G·∫°o",type:"WAREHOUSE",bounds:{x:800,y:700,width:400,height:200},utilization:55,capacity:5e4,currentLoad:27500},{id:"zone-customs",name:"Khu Ki·ªÉm Ho√°",type:"WAREHOUSE",bounds:{x:1250,y:700,width:350,height:200},utilization:40,capacity:2e4,currentLoad:8e3}],waterAreas:[{id:"channel-main",name:"Lu·ªìng H√†ng H·∫£i Ch√≠nh",type:"CHANNEL",path:[{x:0,y:1e3},{x:3e3,y:1e3}],depth:14.5},{id:"channel-approach",name:"Lu·ªìng Ti·∫øp C·∫≠n",type:"CHANNEL",path:[{x:0,y:850},{x:1500,y:850}],depth:12},{id:"anchorage-outer",name:"Khu Neo Ngo√†i",type:"ANCHORAGE",path:[{x:2e3,y:1100},{x:2800,y:1100},{x:2800,y:1500},{x:2e3,y:1500}],depth:18},{id:"basin-turning",name:"B·ªÉ Quay T√†u",type:"TURNING_BASIN",path:[{x:1400,y:900},{x:1700,y:900},{x:1700,y:1100},{x:1400,y:1100}],depth:15}],landmarks:[{id:"gate-main",name:"C·ªïng Ch√≠nh",type:"GATE",position:{x:100,y:200},dimensions:{width:50,height:40}},{id:"gate-container",name:"C·ªïng Container",type:"GATE",position:{x:500,y:200},dimensions:{width:40,height:30}},{id:"office-port-authority",name:"VƒÉn Ph√≤ng C·∫£ng V·ª•",type:"OFFICE",position:{x:200,y:150},dimensions:{width:100,height:80}},{id:"office-customs",name:"VƒÉn Ph√≤ng H·∫£i Quan",type:"OFFICE",position:{x:400,y:150},dimensions:{width:90,height:70}},{id:"warehouse-1",name:"Kho CFS 1",type:"WAREHOUSE",position:{x:200,y:750},dimensions:{width:150,height:100}},{id:"warehouse-2",name:"Kho CFS 2",type:"WAREHOUSE",position:{x:400,y:750},dimensions:{width:150,height:100}},{id:"fuel-station",name:"Tr·∫°m Nhi√™n Li·ªáu",type:"FUEL_STATION",position:{x:1650,y:250},dimensions:{width:60,height:50}}]},ft=(d={})=>{const S=(0,u.useRef)(null),{onBerthUpdate:w,onShipUpdate:j,onCraneUpdate:I,onConnect:g,onDisconnect:h,onError:p}=d;(0,u.useEffect)(()=>{const s=st("https://api.portlink.com/api/v1",{path:"/socket.io",transports:["websocket","polling"],auth:{token:localStorage.getItem("token")}});return S.current=s,s.on("connect",()=>{console.log("‚úÖ Port Map WebSocket connected"),s.emit("join-room","port-map"),g?.()}),s.on("disconnect",()=>{console.log("‚ùå Port Map WebSocket disconnected"),h?.()}),s.on("connect_error",n=>{console.error("WebSocket connection error:",n),p?.(n)}),s.on("berth:updated",n=>{console.log("üö¢ Berth updated:",n),w?.(n)}),s.on("berth:status-changed",n=>{console.log("üîÑ Berth status changed:",n),w?.(n)}),s.on("ship:moved",n=>{console.log("üö¢ Ship moved:",n),j?.(n)}),s.on("ship:arrived",n=>{console.log("‚öì Ship arrived:",n),j?.(n)}),s.on("ship:departed",n=>{console.log("üåä Ship departed:",n),j?.(n)}),s.on("crane:updated",n=>{console.log("üèóÔ∏è Crane updated:",n),I?.(n)}),s.on("crane:status-changed",n=>{console.log("üîß Crane status changed:",n),I?.(n)}),s.on("crane:task-assigned",n=>{console.log("üìã Crane task assigned:",n),I?.(n)}),()=>{s.emit("leave-room","port-map"),s.disconnect()}},[w,j,I,g,h,p]);const y=(s,n)=>{S.current?.emit("berth:update",{berthId:s,...n})},C=(s,n)=>{S.current?.emit("ship:update",{shipId:s,...n})},m=(s,n)=>{S.current?.emit("crane:update",{craneId:s,...n})};return{socket:S.current,emitBerthUpdate:y,emitShipUpdate:C,emitCraneUpdate:m,isConnected:S.current?.connected||!1}};var Tt=()=>{const[d,S]=(0,u.useState)(K),[w,j]=(0,u.useState)(!0),[I,g]=(0,u.useState)(!1),[h,p]=(0,u.useState)(null),[y,C]=(0,u.useState)(null),[m,s]=(0,u.useState)(null);ft({onBerthUpdate:(0,u.useCallback)(x=>{S(b=>({...b,berths:b.berths.map(f=>f.id===x.id?{...f,...x}:f)}))},[]),onShipUpdate:(0,u.useCallback)(x=>{S(b=>({...b,ships:b.ships.map(f=>f.id===x.id?{...f,...x}:f)}))},[]),onCraneUpdate:(0,u.useCallback)(x=>{S(b=>({...b,cranes:b.cranes.map(f=>f.id===x.id?{...f,...x}:f)}))},[]),onConnect:()=>g(!0),onDisconnect:()=>g(!1)});const n=x=>{p(x)},z=x=>{C(x)},R=x=>{s(x)},k=()=>{S(K)},O=()=>{console.log("Export port map")};return(0,t.jsxs)(c,{sx:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",p:3},children:[(0,t.jsxs)(c,{sx:{mb:2},children:[(0,t.jsxs)(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,t.jsxs)(r,{variant:"h4",fontWeight:"bold",children:["B·∫£n ƒê·ªì C·∫£ng - ",d.name]}),(0,t.jsxs)(B,{direction:"row",spacing:1,alignItems:"center",children:[(0,t.jsx)(N,{label:I?"K·∫øt n·ªëi":"M·∫•t k·∫øt n·ªëi",color:I?"success":"error",size:"small"}),(0,t.jsx)(E,{title:"L√†m m·ªõi",children:(0,t.jsx)(L,{onClick:k,children:(0,t.jsx)(ut,{})})}),(0,t.jsx)(E,{title:"Xu·∫•t b·∫£n ƒë·ªì",children:(0,t.jsx)(L,{onClick:O,children:(0,t.jsx)(pt,{})})}),(0,t.jsx)(E,{title:"C√†i ƒë·∫∑t",children:(0,t.jsx)(L,{children:(0,t.jsx)(mt,{})})})]})]}),(0,t.jsxs)(B,{direction:"row",spacing:2,alignItems:"center",children:[(0,t.jsx)(ct,{control:(0,t.jsx)(xt,{checked:w,onChange:x=>j(x.target.checked)}),label:"Hi·ªán b·∫£n ƒë·ªì nhi·ªát (Heatmap)"}),(0,t.jsx)(N,{label:`${d.berths.length} b·∫øn`,color:"primary",variant:"outlined",size:"small"}),(0,t.jsx)(N,{label:`${d.ships.length} t√†u`,color:"info",variant:"outlined",size:"small"}),(0,t.jsx)(N,{label:`${d.cranes.length} c·∫©u`,color:"warning",variant:"outlined",size:"small"})]})]}),(0,t.jsx)(c,{sx:{flexGrow:1,minHeight:0},children:(0,t.jsx)(Ct,{portLayout:d,showHeatmap:w,onBerthClick:n,onShipClick:z,onCraneClick:R})}),(0,t.jsx)(U,{open:!!h,onClose:()=>p(null),maxWidth:"sm",fullWidth:!0,children:h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(M,{children:["Chi Ti·∫øt B·∫øn ",h.code," - ",h.name]}),(0,t.jsx)(P,{dividers:!0,children:(0,t.jsxs)(B,{spacing:2,children:[(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Tr·∫°ng th√°i:"}),(0,t.jsx)(N,{label:h.status,color:h.status==="AVAILABLE"?"success":h.status==="OCCUPIED"?"primary":h.status==="RESERVED"?"warning":"error",size:"small"})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Lo·∫°i b·∫øn:"}),(0,t.jsx)(r,{children:h.type})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"ƒê·ªô s√¢u t·ªëi ƒëa:"}),(0,t.jsxs)(r,{children:[h.maxDraft,"m"]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Chi·ªÅu d√†i t·ªëi ƒëa:"}),(0,t.jsxs)(r,{children:[h.maxLength,"m"]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"ƒê·ªô s·ª≠ d·ª•ng:"}),(0,t.jsxs)(r,{children:[h.utilization,"%"]})]}),h.currentShip&&(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"T√†u hi·ªán t·∫°i:"}),(0,t.jsx)(r,{fontWeight:"bold",children:h.currentShip.name}),(0,t.jsxs)(r,{variant:"body2",color:"text.secondary",children:["ƒê·∫øn: ",new Date(h.currentShip.arrivalTime).toLocaleString("vi-VN")]}),h.currentShip.departureTime&&(0,t.jsxs)(r,{variant:"body2",color:"text.secondary",children:["R·ªùi: ",new Date(h.currentShip.departureTime).toLocaleString("vi-VN")]})]})]})}),(0,t.jsx)(G,{children:(0,t.jsx)(V,{onClick:()=>p(null),children:"ƒê√≥ng"})})]})}),(0,t.jsx)(U,{open:!!y,onClose:()=>C(null),maxWidth:"sm",fullWidth:!0,children:y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(M,{children:["Chi Ti·∫øt T√†u - ",y.name]}),(0,t.jsx)(P,{dividers:!0,children:(0,t.jsxs)(B,{spacing:2,children:[(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Lo·∫°i t√†u:"}),(0,t.jsx)(r,{children:y.type})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"K√≠ch th∆∞·ªõc:"}),(0,t.jsxs)(r,{children:[y.length,"m x ",y.width,"m"]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"M·ªõn n∆∞·ªõc:"}),(0,t.jsxs)(r,{children:[y.draft,"m"]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Tr·∫°ng th√°i:"}),(0,t.jsx)(N,{label:y.status,color:"primary",size:"small"})]}),y.eta&&(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"D·ª± ki·∫øn ƒë·∫øn:"}),(0,t.jsx)(r,{children:new Date(y.eta).toLocaleString("vi-VN")})]}),y.etd&&(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"D·ª± ki·∫øn r·ªùi:"}),(0,t.jsx)(r,{children:new Date(y.etd).toLocaleString("vi-VN")})]})]})}),(0,t.jsx)(G,{children:(0,t.jsx)(V,{onClick:()=>C(null),children:"ƒê√≥ng"})})]})}),(0,t.jsx)(U,{open:!!m,onClose:()=>s(null),maxWidth:"sm",fullWidth:!0,children:m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(M,{children:["Chi Ti·∫øt C·∫©u ",m.code," - ",m.name]}),(0,t.jsx)(P,{dividers:!0,children:(0,t.jsxs)(B,{spacing:2,children:[(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Lo·∫°i c·∫©u:"}),(0,t.jsx)(r,{children:m.type})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"S·ª©c n√¢ng:"}),(0,t.jsxs)(r,{children:[m.capacity," t·∫•n"]})]}),(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"Tr·∫°ng th√°i:"}),(0,t.jsx)(N,{label:m.status,color:m.status==="AVAILABLE"?"success":m.status==="IN_USE"?"primary":m.status==="MAINTENANCE"?"warning":"error",size:"small"})]}),m.currentTask&&(0,t.jsxs)(c,{children:[(0,t.jsx)(r,{variant:"subtitle2",color:"text.secondary",children:"C√¥ng vi·ªác hi·ªán t·∫°i:"}),(0,t.jsx)(r,{fontWeight:"bold",children:m.currentTask.description}),(0,t.jsxs)(r,{variant:"body2",color:"text.secondary",children:["B·∫Øt ƒë·∫ßu: ",new Date(m.currentTask.startTime).toLocaleString("vi-VN")]})]})]})}),(0,t.jsx)(G,{children:(0,t.jsx)(V,{onClick:()=>s(null),children:"ƒê√≥ng"})})]})})]})},jt=Tt;export{jt as default};
