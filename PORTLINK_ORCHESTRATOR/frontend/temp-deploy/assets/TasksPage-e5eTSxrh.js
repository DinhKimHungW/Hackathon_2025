import{r as N}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as Q}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import{c as X}from"./vendor-react-BH1SDbH3.js";import"./vendor-utils-BBFcn-gs.js";import{$n as Y,$r as _,Jn as Z,Jt as ee,Kr as O,Qn as te,U as se,Xn as ae,Yn as k,Zn as ne,ai as f,an as re,ci as ie,dr as j,er as d,f as v,fi as le,in as oe,ln as I,nr as ce,ri as A,si as p,ti as de,tr as ue,vi as xe,vt as he}from"./vendor-mui-B1q6pdKu.js";import{N as C,P as fe,n as E,t as ge}from"./index-Bv4sL6jZ.js";var g=N(Q()),e=N(xe()),je=[{id:"title",label:"Title",sortable:!0},{id:"type",label:"Type",sortable:!0},{id:"status",label:"Status",sortable:!0},{id:"priority",label:"Priority",sortable:!0},{id:"assigneeName",label:"Assignee",sortable:!0},{id:"dueDate",label:"Due Date",sortable:!0}],pe=a=>{switch(a){case"HIGH":return"error";case"MEDIUM":return"warning";case"LOW":return"success";default:return"default"}},me=a=>{switch(a){case"TODO":return"default";case"IN_PROGRESS":return"info";case"REVIEW":return"warning";case"DONE":return"success";default:return"default"}},ye=a=>{switch(a){case"LOADING":return"ðŸ“¦";case"UNLOADING":return"ðŸš›";case"INSPECTION":return"ðŸ”";case"MAINTENANCE":return"ðŸ”§";default:return"ðŸ“‹"}},P=a=>a?a.replace(/_/g," "):"N/A",be=({numSelected:a,order:u,orderBy:x,rowCount:r,onSelectAllClick:h,onRequestSort:T})=>(0,e.jsx)(te,{children:(0,e.jsxs)(k,{children:[(0,e.jsx)(d,{padding:"checkbox",children:(0,e.jsx)(O,{color:"primary",indeterminate:a>0&&a<r,checked:r>0&&a===r,onChange:h})}),je.map(o=>(0,e.jsx)(d,{sortDirection:x===o.id?u:!1,children:o.sortable?(0,e.jsx)(Z,{active:x===o.id,direction:x===o.id?u:"asc",onClick:()=>T(o.id),children:o.label}):o.label},o.id)),(0,e.jsx)(d,{children:"Actions"})]})}),Te=({numSelected:a,onDeleteSelected:u,onExport:x})=>(0,e.jsxs)(ne,{sx:{pl:{sm:2},pr:{xs:1,sm:1},...a>0&&{bgcolor:"primary.lighter"}},children:[a>0?(0,e.jsxs)(f,{sx:{flex:"1 1 100%"},color:"inherit",variant:"subtitle1",component:"div",children:[a," selected"]}):(0,e.jsx)(f,{sx:{flex:"1 1 100%"},variant:"h6",component:"div",children:"Tasks"}),a>0?(0,e.jsx)(j,{title:"Delete",children:(0,e.jsx)(p,{onClick:u,color:"error",children:(0,e.jsx)(I,{})})}):(0,e.jsx)(j,{title:"Export to CSV",children:(0,e.jsx)(p,{onClick:x,children:(0,e.jsx)(re,{})})})]});const we=({onEditTask:a,onViewTask:u,onAssignTask:x})=>{const r=ge(),{tasks:h,loading:T}=E(t=>t.tasks),{isAuthenticated:o}=E(t=>t.auth),[w,z]=(0,g.useState)("asc"),[m,M]=(0,g.useState)("dueDate"),[i,y]=(0,g.useState)([]),[D,S]=(0,g.useState)(0),[b,R]=(0,g.useState)(10);(0,g.useEffect)(()=>{o&&r(fe())},[r,o]);const L=t=>{z(m===t&&w==="asc"?"desc":"asc"),M(t)},V=t=>{if(t.target.checked){const n=h.map(s=>s.id);y(n);return}y([])},U=t=>{const n=i.indexOf(t);let s=[];n===-1?s=s.concat(i,t):n===0?s=s.concat(i.slice(1)):n===i.length-1?s=s.concat(i.slice(0,-1)):n>0&&(s=s.concat(i.slice(0,n),i.slice(n+1))),y(s)},H=(t,n)=>{S(n)},q=t=>{R(parseInt(t.target.value,10)),S(0)},B=async t=>{window.confirm("Are you sure you want to delete this task?")&&await r(C(t))},G=async()=>{if(window.confirm(`Are you sure you want to delete ${i.length} tasks?`)){for(const t of i)await r(C(t));y([])}},W=()=>{const t=[["Title","Type","Status","Priority","Assignee","Due Date","Estimated Hours"].join(","),...h.map(c=>[c.title,c.type,c.status,c.priority,c.assigneeName||"Unassigned",c.dueDate?v(new Date(c.dueDate),"yyyy-MM-dd"):"N/A",c.estimatedHours||"N/A"].join(","))].join(`
`),n=new Blob([t],{type:"text/csv"}),s=window.URL.createObjectURL(n),l=document.createElement("a");l.href=s,l.download=`tasks-${v(new Date,"yyyy-MM-dd")}.csv`,l.click()},$=t=>i.indexOf(t)!==-1,J=[...h].sort((t,n)=>{let s=t[m],l=n[m];return s==null?1:l==null?-1:(m==="dueDate"&&(s=new Date(s).getTime(),l=new Date(l).getTime()),w==="asc"?s>l?1:-1:s<l?1:-1)}).slice(D*b,D*b+b);return T?(0,e.jsx)(_,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:(0,e.jsx)(ie,{})}):(0,e.jsxs)(le,{sx:{width:"100%"},children:[(0,e.jsx)(Te,{numSelected:i.length,onDeleteSelected:G,onExport:W}),(0,e.jsx)(Y,{children:(0,e.jsxs)(ce,{children:[(0,e.jsx)(be,{numSelected:i.length,order:w,orderBy:m,onSelectAllClick:V,rowCount:h.length,onRequestSort:L}),(0,e.jsx)(ue,{children:J.map(t=>{const n=$(t.id),s=t.dueDate&&new Date(t.dueDate)<new Date&&t.status!=="DONE",l=P(t.type),c=t.status??"TODO",F=P(c),K=me(c);return(0,e.jsxs)(k,{hover:!0,role:"checkbox","aria-checked":n,tabIndex:-1,selected:n,sx:{cursor:"pointer"},children:[(0,e.jsx)(d,{padding:"checkbox",onClick:()=>U(t.id),children:(0,e.jsx)(O,{color:"primary",checked:n})}),(0,e.jsx)(d,{onClick:()=>u(t),children:(0,e.jsxs)(f,{variant:"body2",sx:{fontWeight:500},children:[ye(t.type)," ",t.title]})}),(0,e.jsx)(d,{children:l}),(0,e.jsx)(d,{children:(0,e.jsx)(A,{label:F,size:"small",color:K})}),(0,e.jsx)(d,{children:(0,e.jsx)(A,{label:t.priority,size:"small",icon:(0,e.jsx)(ee,{}),color:pe(t.priority)})}),(0,e.jsx)(d,{children:t.assigneeName?(0,e.jsxs)(_,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(de,{sx:{width:24,height:24,fontSize:"0.75rem"},children:t.assigneeName.charAt(0).toUpperCase()}),(0,e.jsx)(f,{variant:"body2",children:t.assigneeName})]}):(0,e.jsx)(f,{variant:"body2",color:"text.secondary",children:"Unassigned"})}),(0,e.jsx)(d,{children:t.dueDate?(0,e.jsxs)(f,{variant:"body2",sx:{color:s?"error.main":"text.primary",fontWeight:s?600:400},children:[v(new Date(t.dueDate),"MMM d, yyyy"),s&&" âš ï¸"]}):(0,e.jsx)(f,{variant:"body2",color:"text.secondary",children:"N/A"})}),(0,e.jsx)(d,{children:(0,e.jsxs)(_,{sx:{display:"flex",gap:.5},children:[(0,e.jsx)(j,{title:"View Details",children:(0,e.jsx)(p,{size:"small",onClick:()=>u(t),children:(0,e.jsx)(se,{fontSize:"small"})})}),(0,e.jsx)(j,{title:"Edit Task",children:(0,e.jsx)(p,{size:"small",onClick:()=>a(t),children:(0,e.jsx)(oe,{fontSize:"small"})})}),(0,e.jsx)(j,{title:"Assign Task",children:(0,e.jsx)(p,{size:"small",color:"primary",onClick:()=>x(t),children:(0,e.jsx)(he,{fontSize:"small"})})}),(0,e.jsx)(j,{title:"Delete Task",children:(0,e.jsx)(p,{size:"small",color:"error",onClick:()=>B(t.id),children:(0,e.jsx)(I,{fontSize:"small"})})})]})})]},t.id)})})]})}),(0,e.jsx)(ae,{rowsPerPageOptions:[5,10,25,50],component:"div",count:h.length,rowsPerPage:b,page:D,onPageChange:H,onRowsPerPageChange:q})]})};function Pe(){X();const a=r=>{console.log("Edit task:",r.id)},u=r=>{console.log("View task:",r.id)},x=r=>{console.log("Assign task:",r.id)};return(0,e.jsx)(we,{onEditTask:a,onViewTask:u,onAssignTask:x})}export{Pe as default};
