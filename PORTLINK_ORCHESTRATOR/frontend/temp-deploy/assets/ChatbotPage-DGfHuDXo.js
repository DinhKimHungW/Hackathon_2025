import{r as b}from"./rolldown-runtime-CjiBMUN4.js";import{Cn as k}from"./vendor-BM98ZQOm.js";import"./vendor-charts-C1uJw4t_.js";import"./vendor-utils-BBFcn-gs.js";import{$r as a,$t as I,Dr as T,Kn as A,Pt as P,Qt as M,Rr as y,Sr as R,V as D,ai as i,ci as u,dr as L,f as E,fi as f,it as W,jn as B,pi as K,ri as _,si as m,ti as j,tt as x,vi as V,wr as q,yt as F}from"./vendor-mui-B1q6pdKu.js";import{a as Q,c as H,i as U,l as $,n as p,o as G,s as O,t as J}from"./index-Bv4sL6jZ.js";var h=b(k()),e=b(V());function N({message:r}){const[n,o]=(0,h.useState)(!1),s=r.role==="user",l=()=>{switch(r.intent){case"what_if_scenario":return(0,e.jsx)(B,{fontSize:"small"});case"conflict_detection":return(0,e.jsx)(D,{fontSize:"small",color:"warning"});case"optimization_request":return(0,e.jsx)(P,{fontSize:"small",color:"primary"});default:return null}};return(0,e.jsxs)(a,{sx:{display:"flex",justifyContent:s?"flex-end":"flex-start",mb:2,gap:1},children:[!s&&(0,e.jsx)(j,{sx:{bgcolor:"primary.main",width:36,height:36},children:(0,e.jsx)(x,{fontSize:"small"})}),(0,e.jsxs)(a,{sx:{maxWidth:"70%"},children:[(0,e.jsxs)(f,{elevation:1,sx:{p:1.5,bgcolor:s?"primary.main":"background.paper",color:s?"primary.contrastText":"text.primary",borderRadius:2,...s&&{borderTopRightRadius:4},...!s&&{borderTopLeftRadius:4}},children:[(0,e.jsx)(i,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:r.content}),!s&&r.intent&&(0,e.jsx)(a,{sx:{mt:1,display:"flex",alignItems:"center",gap:.5},children:(0,e.jsx)(_,{size:"small",icon:l()||void 0,label:r.intent.replace(/_/g," "),variant:"outlined",sx:{fontSize:"0.7rem",height:20}})})]}),!s&&r.metadata?.suggestions&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(m,{size:"small",onClick:()=>o(!n),sx:{mt:.5},children:[n?(0,e.jsx)(I,{}):(0,e.jsx)(M,{}),(0,e.jsxs)(i,{variant:"caption",sx:{ml:.5},children:[r.metadata.suggestions.length," suggestions"]})]}),(0,e.jsx)(K,{in:n,children:(0,e.jsx)(T,{dense:!0,sx:{bgcolor:"action.hover",borderRadius:1,mt:1},children:r.metadata.suggestions.map((c,d)=>(0,e.jsx)(q,{children:(0,e.jsx)(R,{primary:c,primaryTypographyProps:{variant:"caption"}})},d))})})]}),(0,e.jsx)(i,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5,textAlign:s?"right":"left"},children:E(new Date(r.timestamp),"HH:mm")})]}),s&&(0,e.jsx)(j,{sx:{bgcolor:"secondary.main",width:36,height:36},children:(0,e.jsx)(F,{fontSize:"small"})})]})}function X(){const r=J(),n=p(G),o=p(H),s=p(O),[l,c]=(0,h.useState)(""),d=(0,h.useRef)(null),v=()=>{d.current?.scrollIntoView({behavior:"smooth"})};(0,h.useEffect)(()=>{v()},[n,o]);const g=async()=>{if(!l.trim())return;const t=l.trim();c(""),r(U(t)),await r($(t))},S=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),g())},w=["Show current schedule","Check for conflicts","What if MV Ocean Star delays 2 hours?","Show berth availability","Display KPIs"],C=t=>{c(t)};return(0,e.jsxs)(f,{elevation:3,sx:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,e.jsxs)(a,{sx:{p:2,bgcolor:"primary.main",color:"primary.contrastText",display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(x,{}),(0,e.jsxs)(a,{sx:{flex:1},children:[(0,e.jsx)(i,{variant:"h6",children:"PortLink AI Assistant"}),(0,e.jsx)(i,{variant:"caption",children:s?"Connected":"Disconnected"})]}),(0,e.jsx)(L,{title:"Clear chat",children:(0,e.jsx)(m,{size:"small",onClick:()=>r(Q()),sx:{color:"inherit"},children:(0,e.jsx)(i,{variant:"caption",children:"Clear"})})})]}),(0,e.jsx)(y,{}),n.length===0&&(0,e.jsxs)(a,{sx:{p:2,bgcolor:"background.default"},children:[(0,e.jsx)(i,{variant:"caption",color:"text.secondary",gutterBottom:!0,children:"Quick actions:"}),(0,e.jsx)(a,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:1},children:w.map((t,z)=>(0,e.jsx)(_,{label:t,size:"small",onClick:()=>C(t),sx:{fontSize:"0.7rem"}},z))})]}),(0,e.jsx)(a,{sx:{flex:1,overflow:"auto",p:2,bgcolor:"grey.50"},children:n.length===0?(0,e.jsx)(a,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center"},children:(0,e.jsxs)(a,{children:[(0,e.jsx)(x,{sx:{fontSize:64,color:"text.secondary",mb:2}}),(0,e.jsx)(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"Welcome to PortLink AI"}),(0,e.jsx)(i,{variant:"body2",color:"text.secondary",children:"Ask me anything about schedules, ships, berths, or run what-if scenarios!"})]})}):(0,e.jsxs)(e.Fragment,{children:[n.map(t=>(0,e.jsx)(N,{message:t},t.id)),o&&(0,e.jsxs)(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[(0,e.jsx)(j,{sx:{bgcolor:"primary.main",width:36,height:36},children:(0,e.jsx)(x,{fontSize:"small"})}),(0,e.jsx)(f,{elevation:1,sx:{p:1.5,borderRadius:2},children:(0,e.jsxs)(a,{sx:{display:"flex",gap:.5},children:[(0,e.jsx)(u,{size:8}),(0,e.jsx)(u,{size:8}),(0,e.jsx)(u,{size:8})]})})]}),(0,e.jsx)("div",{ref:d})]})}),(0,e.jsx)(y,{}),(0,e.jsx)(a,{sx:{p:2,bgcolor:"background.paper"},children:(0,e.jsxs)(a,{sx:{display:"flex",gap:1},children:[(0,e.jsx)(A,{fullWidth:!0,size:"small",placeholder:"Type your message... (Press Enter to send)",value:l,onChange:t=>c(t.target.value),onKeyPress:S,disabled:!s,multiline:!0,maxRows:3}),(0,e.jsx)(m,{color:"primary",onClick:g,disabled:!l.trim()||!s||o,children:(0,e.jsx)(W,{})})]})})]})}function re(){return(0,e.jsx)(X,{})}export{re as default};
